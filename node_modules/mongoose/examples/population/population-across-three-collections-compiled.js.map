{"version":3,"sources":["population-across-three-collections.js"],"names":[],"mappings":"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","file":"population-across-three-collections-compiled.js","sourcesContent":["\nvar assert = require('assert');\nvar mongoose = require('../../lib');\nvar Schema = mongoose.Schema;\nvar ObjectId = mongoose.Types.ObjectId;\n\n/**\n * Connect to the db\n */\n\nvar dbname = 'testing_populateAdInfinitum_' + require('../../lib/utils').random();\nmongoose.connect('localhost', dbname);\nmongoose.connection.on('error', function() {\n  console.error('connection error', arguments);\n});\n\n/**\n * Schemas\n */\n\nvar user = new Schema({\n  name: String,\n  friends: [{\n    type: Schema.ObjectId,\n    ref: 'User'\n  }]\n});\nvar User = mongoose.model('User', user);\n\nvar blogpost = Schema({\n  title: String,\n  tags: [String],\n  author: {\n    type: Schema.ObjectId,\n    ref: 'User'\n  }\n});\nvar BlogPost = mongoose.model('BlogPost', blogpost);\n\n/**\n * example\n */\n\nmongoose.connection.on('open', function() {\n  /**\n   * Generate data\n   */\n\n  var userIds = [new ObjectId, new ObjectId, new ObjectId, new ObjectId];\n  var users = [];\n\n  users.push({\n    _id: userIds[0],\n    name: 'mary',\n    friends: [userIds[1], userIds[2], userIds[3]]\n  });\n  users.push({\n    _id: userIds[1],\n    name: 'bob',\n    friends: [userIds[0], userIds[2], userIds[3]]\n  });\n  users.push({\n    _id: userIds[2],\n    name: 'joe',\n    friends: [userIds[0], userIds[1], userIds[3]]\n  });\n  users.push({\n    _id: userIds[3],\n    name: 'sally',\n    friends: [userIds[0], userIds[1], userIds[2]]\n  });\n\n  User.create(users, function(err) {\n    assert.ifError(err);\n\n    var blogposts = [];\n    blogposts.push({\n      title: 'blog 1',\n      tags: ['fun', 'cool'],\n      author: userIds[3]\n    });\n    blogposts.push({\n      title: 'blog 2',\n      tags: ['cool'],\n      author: userIds[1]\n    });\n    blogposts.push({\n      title: 'blog 3',\n      tags: ['fun', 'odd'],\n      author: userIds[2]\n    });\n\n    BlogPost.create(blogposts, function(err) {\n      assert.ifError(err);\n\n      /**\n       * Population\n       */\n\n      BlogPost\n      .find({tags: 'fun'})\n      .lean()\n      .populate('author')\n      .exec(function(err, docs) {\n        assert.ifError(err);\n\n        /**\n         * Populate the populated documents\n         */\n\n        var opts = {\n          path: 'author.friends',\n          select: 'name',\n          options: {limit: 2}\n        };\n\n        BlogPost.populate(docs, opts, function(err, docs) {\n          assert.ifError(err);\n          console.log('populated');\n          var s = require('util').inspect(docs, {depth: null, colors: true});\n          console.log(s);\n          done();\n        });\n      });\n    });\n  });\n});\n\nfunction done(err) {\n  if (err) console.error(err.stack);\n  mongoose.connection.db.dropDatabase(function() {\n    mongoose.connection.close();\n  });\n}\n"]}