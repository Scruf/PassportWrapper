{"version":3,"sources":["commands.js"],"names":[],"mappings":"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","file":"commands-compiled.js","sourcesContent":["\"use strict\";\n\nvar f = require('util').format\n  , Long = require('bson').Long\n  , setProperty = require('./utils').setProperty\n  , getProperty = require('./utils').getProperty\n  , getSingleProperty = require('./utils').getSingleProperty;\n\n// Incrementing request id\nvar _requestId = 0;\n\n// Wire command operation ids\nvar OP_QUERY = 2004;\nvar OP_GETMORE = 2005;\nvar OP_KILL_CURSORS = 2007;\n\n// Query flags\nvar OPTS_NONE = 0;\nvar OPTS_TAILABLE_CURSOR = 2;\nvar OPTS_SLAVE = 4;\nvar OPTS_OPLOG_REPLAY = 8;\nvar OPTS_NO_CURSOR_TIMEOUT = 16;\nvar OPTS_AWAIT_DATA = 32;\nvar OPTS_EXHAUST = 64;\nvar OPTS_PARTIAL = 128;\n\n// Request Id Max Value in JS\nvar JS_INT_MAX = 0x20000000000000;\n\n// Response flags\nvar CURSOR_NOT_FOUND = 1;\nvar QUERY_FAILURE = 2;\nvar SHARD_CONFIG_STALE = 4;\nvar AWAIT_CAPABLE = 8;\n\n/**************************************************************\n * QUERY\n **************************************************************/\nvar Query = function(bson, ns, query, options) {\n  var self = this;\n  // Basic options needed to be passed in\n  if(ns == null) throw new Error(\"ns must be specified for query\");\n  if(query == null) throw new Error(\"query must be specified for query\");\n\n  // Validate that we are not passing 0x00 in the colletion name\n  if(!!~ns.indexOf(\"\\x00\")) {\n    throw new Error(\"namespace cannot contain a null character\");\n  }\n\n  // Basic options\n  this.bson = bson;\n  this.ns = ns;\n  this.query = query;\n\n  // Ensure empty options\n  this.options = options || {};\n\n  // Additional options\n  this.numberToSkip = options.numberToSkip || 0;\n  this.numberToReturn = options.numberToReturn || 0;\n  this.returnFieldSelector = options.returnFieldSelector || null;\n  this.requestId = (_requestId++) % JS_INT_MAX;\n\n  // Serialization option\n  this.serializeFunctions = typeof options.serializeFunctions == 'boolean' ? options.serializeFunctions : false;\n  this.ignoreUndefined = typeof options.ignoreUndefined == 'boolean' ? options.ignoreUndefined : false;\n  this.maxBsonSize = options.maxBsonSize || 1024 * 1024 * 16;\n  this.checkKeys = typeof options.checkKeys == 'boolean' ? options.checkKeys : true;\n  this.batchSize = self.numberToReturn;\n\n  // Flags\n  this.tailable = false;\n  this.slaveOk = false;\n  this.oplogReplay = false;\n  this.noCursorTimeout = false;\n  this.awaitData = false;\n  this.exhaust = false;\n  this.partial = false;\n}\n\n//\n// Assign a new request Id\nQuery.prototype.incRequestId = function() {\n  this.requestId = (_requestId++) % JS_INT_MAX;\n}\n\n//\n// Assign a new request Id\nQuery.nextRequestId = function() {\n  return (_requestId + 1) % JS_INT_MAX;\n}\n\n//\n// Uses a single allocated buffer for the process, avoiding multiple memory allocations\nQuery.prototype.toBin = function() {\n  var self = this;\n  var buffers = [];\n  var projection = null;\n\n  // Set up the flags\n  var flags = 0;\n  if(this.tailable) {\n    flags |= OPTS_TAILABLE_CURSOR;\n  }\n\n  if(this.slaveOk) {\n    flags |= OPTS_SLAVE;\n  }\n\n  if(this.oplogReplay) {\n    flags |= OPTS_OPLOG_REPLAY;\n  }\n\n  if(this.noCursorTimeout) {\n    flags |= OPTS_NO_CURSOR_TIMEOUT;\n  }\n\n  if(this.awaitData) {\n    flags |= OPTS_AWAIT_DATA;\n  }\n\n  if(this.exhaust) {\n    flags |= OPTS_EXHAUST;\n  }\n\n  if(this.partial) {\n    flags |= OPTS_PARTIAL;\n  }\n\n  // If batchSize is different to self.numberToReturn\n  if(self.batchSize != self.numberToReturn) self.numberToReturn = self.batchSize;\n\n  // Allocate write protocol header buffer\n  var header = new Buffer(\n    4 * 4 // Header\n    + 4   // Flags\n    + Buffer.byteLength(self.ns) + 1 // namespace\n    + 4 // numberToSkip\n    + 4 // numberToReturn\n  );\n\n  // Add header to buffers\n  buffers.push(header);\n\n  // Serialize the query\n  var query = self.bson.serialize(this.query\n    , this.checkKeys\n    , true\n    , this.serializeFunctions\n    , 0, this.ignoreUndefined);\n\n  // Add query document\n  buffers.push(query);\n\n  if(self.returnFieldSelector && Object.keys(self.returnFieldSelector).length > 0) {\n    // Serialize the projection document\n    projection = self.bson.serialize(this.returnFieldSelector, this.checkKeys, true, this.serializeFunctions, this.ignoreUndefined);\n    // Add projection document\n    buffers.push(projection);\n  }\n\n  // Total message size\n  var totalLength = header.length + query.length + (projection ? projection.length : 0);\n\n  // Set up the index\n  var index = 4;\n\n  // Write total document length\n  header[3] = (totalLength >> 24) & 0xff;\n  header[2] = (totalLength >> 16) & 0xff;\n  header[1] = (totalLength >> 8) & 0xff;\n  header[0] = (totalLength) & 0xff;\n\n  // Write header information requestId\n  header[index + 3] = (this.requestId >> 24) & 0xff;\n  header[index + 2] = (this.requestId >> 16) & 0xff;\n  header[index + 1] = (this.requestId >> 8) & 0xff;\n  header[index] = (this.requestId) & 0xff;\n  index = index + 4;\n\n  // Write header information responseTo\n  header[index + 3] = (0 >> 24) & 0xff;\n  header[index + 2] = (0 >> 16) & 0xff;\n  header[index + 1] = (0 >> 8) & 0xff;\n  header[index] = (0) & 0xff;\n  index = index + 4;\n\n  // Write header information OP_QUERY\n  header[index + 3] = (OP_QUERY >> 24) & 0xff;\n  header[index + 2] = (OP_QUERY >> 16) & 0xff;\n  header[index + 1] = (OP_QUERY >> 8) & 0xff;\n  header[index] = (OP_QUERY) & 0xff;\n  index = index + 4;\n\n  // Write header information flags\n  header[index + 3] = (flags >> 24) & 0xff;\n  header[index + 2] = (flags >> 16) & 0xff;\n  header[index + 1] = (flags >> 8) & 0xff;\n  header[index] = (flags) & 0xff;\n  index = index + 4;\n\n  // Write collection name\n  index = index + header.write(this.ns, index, 'utf8') + 1;\n  header[index - 1] = 0;\n\n  // Write header information flags numberToSkip\n  header[index + 3] = (this.numberToSkip >> 24) & 0xff;\n  header[index + 2] = (this.numberToSkip >> 16) & 0xff;\n  header[index + 1] = (this.numberToSkip >> 8) & 0xff;\n  header[index] = (this.numberToSkip) & 0xff;\n  index = index + 4;\n\n  // Write header information flags numberToReturn\n  header[index + 3] = (this.numberToReturn >> 24) & 0xff;\n  header[index + 2] = (this.numberToReturn >> 16) & 0xff;\n  header[index + 1] = (this.numberToReturn >> 8) & 0xff;\n  header[index] = (this.numberToReturn) & 0xff;\n  index = index + 4;\n\n  // Return the buffers\n  return buffers;\n}\n\nQuery.getRequestId = function() {\n  return (++_requestId) % JS_INT_MAX;\n}\n\n/**************************************************************\n * GETMORE\n **************************************************************/\nvar GetMore = function(bson, ns, cursorId, opts) {\n  opts = opts || {};\n  this.numberToReturn = opts.numberToReturn || 0;\n  this.requestId = (_requestId++) % JS_INT_MAX;\n  this.bson = bson;\n  this.ns = ns;\n  this.cursorId = cursorId;\n}\n\n//\n// Uses a single allocated buffer for the process, avoiding multiple memory allocations\nGetMore.prototype.toBin = function() {\n  var length = 4 + Buffer.byteLength(this.ns) + 1 + 4 + 8 + (4 * 4);\n  // Create command buffer\n  var index = 0;\n  // Allocate buffer\n  var _buffer = new Buffer(length);\n\n  // Write header information\n  // index = write32bit(index, _buffer, length);\n  _buffer[index + 3] = (length >> 24) & 0xff;\n  _buffer[index + 2] = (length >> 16) & 0xff;\n  _buffer[index + 1] = (length >> 8) & 0xff;\n  _buffer[index] = (length) & 0xff;\n  index = index + 4;\n\n  // index = write32bit(index, _buffer, requestId);\n  _buffer[index + 3] = (this.requestId >> 24) & 0xff;\n  _buffer[index + 2] = (this.requestId >> 16) & 0xff;\n  _buffer[index + 1] = (this.requestId >> 8) & 0xff;\n  _buffer[index] = (this.requestId) & 0xff;\n  index = index + 4;\n\n  // index = write32bit(index, _buffer, 0);\n  _buffer[index + 3] = (0 >> 24) & 0xff;\n  _buffer[index + 2] = (0 >> 16) & 0xff;\n  _buffer[index + 1] = (0 >> 8) & 0xff;\n  _buffer[index] = (0) & 0xff;\n  index = index + 4;\n\n  // index = write32bit(index, _buffer, OP_GETMORE);\n  _buffer[index + 3] = (OP_GETMORE >> 24) & 0xff;\n  _buffer[index + 2] = (OP_GETMORE >> 16) & 0xff;\n  _buffer[index + 1] = (OP_GETMORE >> 8) & 0xff;\n  _buffer[index] = (OP_GETMORE) & 0xff;\n  index = index + 4;\n\n  // index = write32bit(index, _buffer, 0);\n  _buffer[index + 3] = (0 >> 24) & 0xff;\n  _buffer[index + 2] = (0 >> 16) & 0xff;\n  _buffer[index + 1] = (0 >> 8) & 0xff;\n  _buffer[index] = (0) & 0xff;\n  index = index + 4;\n\n  // Write collection name\n  index = index + _buffer.write(this.ns, index, 'utf8') + 1;\n  _buffer[index - 1] = 0;\n\n  // Write batch size\n  // index = write32bit(index, _buffer, numberToReturn);\n  _buffer[index + 3] = (this.numberToReturn >> 24) & 0xff;\n  _buffer[index + 2] = (this.numberToReturn >> 16) & 0xff;\n  _buffer[index + 1] = (this.numberToReturn >> 8) & 0xff;\n  _buffer[index] = (this.numberToReturn) & 0xff;\n  index = index + 4;\n\n  // Write cursor id\n  // index = write32bit(index, _buffer, cursorId.getLowBits());\n  _buffer[index + 3] = (this.cursorId.getLowBits() >> 24) & 0xff;\n  _buffer[index + 2] = (this.cursorId.getLowBits() >> 16) & 0xff;\n  _buffer[index + 1] = (this.cursorId.getLowBits() >> 8) & 0xff;\n  _buffer[index] = (this.cursorId.getLowBits()) & 0xff;\n  index = index + 4;\n\n  // index = write32bit(index, _buffer, cursorId.getHighBits());\n  _buffer[index + 3] = (this.cursorId.getHighBits() >> 24) & 0xff;\n  _buffer[index + 2] = (this.cursorId.getHighBits() >> 16) & 0xff;\n  _buffer[index + 1] = (this.cursorId.getHighBits() >> 8) & 0xff;\n  _buffer[index] = (this.cursorId.getHighBits()) & 0xff;\n  index = index + 4;\n\n  // Return buffer\n  return _buffer;\n}\n\n/**************************************************************\n * KILLCURSOR\n **************************************************************/\nvar KillCursor = function(bson, cursorIds) {\n  this.requestId = (_requestId++) % JS_INT_MAX;\n  this.cursorIds = cursorIds;\n}\n\n//\n// Uses a single allocated buffer for the process, avoiding multiple memory allocations\nKillCursor.prototype.toBin = function() {\n  var length = 4 + 4 + (4 * 4) + (this.cursorIds.length * 8);\n\n  // Create command buffer\n  var index = 0;\n  var _buffer = new Buffer(length);\n\n  // Write header information\n  // index = write32bit(index, _buffer, length);\n  _buffer[index + 3] = (length >> 24) & 0xff;\n  _buffer[index + 2] = (length >> 16) & 0xff;\n  _buffer[index + 1] = (length >> 8) & 0xff;\n  _buffer[index] = (length) & 0xff;\n  index = index + 4;\n\n  // index = write32bit(index, _buffer, requestId);\n  _buffer[index + 3] = (this.requestId >> 24) & 0xff;\n  _buffer[index + 2] = (this.requestId >> 16) & 0xff;\n  _buffer[index + 1] = (this.requestId >> 8) & 0xff;\n  _buffer[index] = (this.requestId) & 0xff;\n  index = index + 4;\n\n  // index = write32bit(index, _buffer, 0);\n  _buffer[index + 3] = (0 >> 24) & 0xff;\n  _buffer[index + 2] = (0 >> 16) & 0xff;\n  _buffer[index + 1] = (0 >> 8) & 0xff;\n  _buffer[index] = (0) & 0xff;\n  index = index + 4;\n\n  // index = write32bit(index, _buffer, OP_KILL_CURSORS);\n  _buffer[index + 3] = (OP_KILL_CURSORS >> 24) & 0xff;\n  _buffer[index + 2] = (OP_KILL_CURSORS >> 16) & 0xff;\n  _buffer[index + 1] = (OP_KILL_CURSORS >> 8) & 0xff;\n  _buffer[index] = (OP_KILL_CURSORS) & 0xff;\n  index = index + 4;\n\n  // index = write32bit(index, _buffer, 0);\n  _buffer[index + 3] = (0 >> 24) & 0xff;\n  _buffer[index + 2] = (0 >> 16) & 0xff;\n  _buffer[index + 1] = (0 >> 8) & 0xff;\n  _buffer[index] = (0) & 0xff;\n  index = index + 4;\n\n  // Write batch size\n  // index = write32bit(index, _buffer, this.cursorIds.length);\n  _buffer[index + 3] = (this.cursorIds.length >> 24) & 0xff;\n  _buffer[index + 2] = (this.cursorIds.length >> 16) & 0xff;\n  _buffer[index + 1] = (this.cursorIds.length >> 8) & 0xff;\n  _buffer[index] = (this.cursorIds.length) & 0xff;\n  index = index + 4;\n\n  // Write all the cursor ids into the array\n  for(var i = 0; i < this.cursorIds.length; i++) {\n    // Write cursor id\n    // index = write32bit(index, _buffer, cursorIds[i].getLowBits());\n    _buffer[index + 3] = (this.cursorIds[i].getLowBits() >> 24) & 0xff;\n    _buffer[index + 2] = (this.cursorIds[i].getLowBits() >> 16) & 0xff;\n    _buffer[index + 1] = (this.cursorIds[i].getLowBits() >> 8) & 0xff;\n    _buffer[index] = (this.cursorIds[i].getLowBits()) & 0xff;\n    index = index + 4;\n\n    // index = write32bit(index, _buffer, cursorIds[i].getHighBits());\n    _buffer[index + 3] = (this.cursorIds[i].getHighBits() >> 24) & 0xff;\n    _buffer[index + 2] = (this.cursorIds[i].getHighBits() >> 16) & 0xff;\n    _buffer[index + 1] = (this.cursorIds[i].getHighBits() >> 8) & 0xff;\n    _buffer[index] = (this.cursorIds[i].getHighBits()) & 0xff;\n    index = index + 4;\n  }\n\n  // Return buffer\n  return _buffer;\n}\n\nvar Response = function(connection, bson, data, opts) {\n  opts = opts || {promoteLongs: true};\n  this.parsed = false;\n  this.connection = connection;\n\n  //\n  // Parse Header\n  //\n  this.index = 0;\n  this.raw = data;\n  this.data = data;\n  this.bson = bson;\n  this.opts = opts;\n\n  // Read the message length\n  this.length = data[this.index] | data[this.index + 1] << 8 | data[this.index + 2] << 16 | data[this.index + 3] << 24;\n  this.index = this.index + 4;\n\n  // Fetch the request id for this reply\n  this.requestId = data[this.index] | data[this.index + 1] << 8 | data[this.index + 2] << 16 | data[this.index + 3] << 24;\n  this.index = this.index + 4;\n\n  // Fetch the id of the request that triggered the response\n  this.responseTo = data[this.index] | data[this.index + 1] << 8 | data[this.index + 2] << 16 | data[this.index + 3] << 24;\n  this.index = this.index + 4;\n\n  // Skip op-code field\n  this.index = this.index + 4;\n\n  // Unpack flags\n  this.responseFlags = data[this.index] | data[this.index + 1] << 8 | data[this.index + 2] << 16 | data[this.index + 3] << 24;\n  this.index = this.index + 4;\n\n  // Unpack the cursor\n  var lowBits = data[this.index] | data[this.index + 1] << 8 | data[this.index + 2] << 16 | data[this.index + 3] << 24;\n  this.index = this.index + 4;\n  var highBits = data[this.index] | data[this.index + 1] << 8 | data[this.index + 2] << 16 | data[this.index + 3] << 24;\n  this.index = this.index + 4;\n  // Create long object\n  this.cursorId = new Long(lowBits, highBits);\n\n  // Unpack the starting from\n  this.startingFrom = data[this.index] | data[this.index + 1] << 8 | data[this.index + 2] << 16 | data[this.index + 3] << 24;\n  this.index = this.index + 4;\n\n  // Unpack the number of objects returned\n  this.numberReturned = data[this.index] | data[this.index + 1] << 8 | data[this.index + 2] << 16 | data[this.index + 3] << 24;\n  this.index = this.index + 4;\n\n  // Preallocate document array\n  this.documents = new Array(this.numberReturned);\n\n  // Flag values\n  this.cursorNotFound = (this.responseFlags & CURSOR_NOT_FOUND) != 0;\n  this.queryFailure = (this.responseFlags & QUERY_FAILURE) != 0;\n  this.shardConfigStale = (this.responseFlags & SHARD_CONFIG_STALE) != 0;\n  this.awaitCapable = (this.responseFlags & AWAIT_CAPABLE) != 0;\n  this.promoteLongs = typeof opts.promoteLongs == 'boolean' ? opts.promoteLongs : true;\n}\n\nResponse.prototype.isParsed = function() {\n  return this.parsed;\n}\n\n// Validation buffers\nvar firstBatch = new Buffer('firstBatch', 'utf8');\nvar nextBatch = new Buffer('nextBatch', 'utf8');\nvar cursorId = new Buffer('id', 'utf8').toString('hex');\n\nvar documentBuffers = {\n  firstBatch: firstBatch.toString('hex'),\n  nextBatch: nextBatch.toString('hex')\n};\n\nResponse.prototype.parse = function(options) {\n  // Don't parse again if not needed\n  if(this.parsed) return;\n  options = options || {};\n\n  // Allow the return of raw documents instead of parsing\n  var raw = options.raw || false;\n  var documentsReturnedIn = options.documentsReturnedIn || null;\n\n  //\n  // Single document and documentsReturnedIn set\n  //\n  if(this.numberReturned == 1 && documentsReturnedIn != null && raw) {\n    // Calculate the bson size\n    var bsonSize = this.data[this.index] | this.data[this.index + 1] << 8 | this.data[this.index + 2] << 16 | this.data[this.index + 3] << 24;\n    // Slice out the buffer containing the command result document\n    var document = this.data.slice(this.index, this.index + bsonSize);\n    // Set up field we wish to keep as raw\n    var fieldsAsRaw = {}\n    fieldsAsRaw[documentsReturnedIn] = true;\n    // Set up the options\n    var _options = {promoteLongs: this.opts.promoteLongs, fieldsAsRaw: fieldsAsRaw};\n\n    // Do we have a promoteLongs value on the options\n    if(typeof options.promoteLongs == 'boolean') {\n      _options.promoteLongs = options.promoteLongs;\n    }\n\n    // Deserialize but keep the array of documents in non-parsed form\n    var doc = this.bson.deserialize(document, _options);\n\n    // Get the documents\n    this.documents = doc.cursor[documentsReturnedIn];\n    this.numberReturned = this.documents.length;\n    // Ensure we have a Long valie cursor id\n    this.cursorId = typeof doc.cursor.id == 'number'\n      ? Long.fromNumber(doc.cursor.id)\n      : doc.cursor.id;\n\n    // Adjust the index\n    this.index = this.index + bsonSize;\n\n    // Set as parsed\n    this.parsed = true\n    return;\n  }\n\n  //\n  // Parse Body\n  //\n  for(var i = 0; i < this.numberReturned; i++) {\n    var bsonSize = this.data[this.index] | this.data[this.index + 1] << 8 | this.data[this.index + 2] << 16 | this.data[this.index + 3] << 24;\n    // Parse options\n    var _options = {promoteLongs: this.opts.promoteLongs};\n\n    // Do we have a promoteLongs value on the options\n    if(typeof options.promoteLongs == 'boolean') {\n      _options.promoteLongs = options.promoteLongs;\n    }\n\n    // If we have raw results specified slice the return document\n    if(raw) {\n      this.documents[i] = this.data.slice(this.index, this.index + bsonSize);\n    } else {\n      this.documents[i] = this.bson.deserialize(this.data.slice(this.index, this.index + bsonSize), _options);\n    }\n\n    // Adjust the index\n    this.index = this.index + bsonSize;\n  }\n\n  // Set parsed\n  this.parsed = true;\n}\n\nmodule.exports = {\n    Query: Query\n  , GetMore: GetMore\n  , Response: Response\n  , KillCursor: KillCursor\n}\n"]}