{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"index-compiled.js","sourcesContent":["var path = require('path'),\n  fs = require('fs'),\n  f = require('util').format,\n  resolveFrom = require('resolve-from'),\n  semver = require('semver');\n\nvar exists = fs.existsSync || path.existsSync;\n\nvar find_package_json = function(location) {\n  var found = false;\n\n  while(!found) {\n    if (exists(location + '/package.json')) {\n      found = location;\n    } else if (location !== '/') {\n      location = path.dirname(location);\n    } else {\n      return false;\n    }\n  }\n\n  return location;\n}\n\nvar require_optional = function(name, options) {\n  options = options || {};\n  options.strict = typeof options.strict == 'boolean' ? options.strict : true;\n\n  // Current location\n  var location = __dirname;\n  // Check if we have a parent\n  if(module.parent) {\n    location = module.parent.filename;\n  }\n\n  // Locate this module's package.json file\n  var location = find_package_json(location);\n  if(!location) {\n    throw new Error('package.json can not be located');\n  }\n\n  // Read the package.json file\n  var object = JSON.parse(fs.readFileSync(f('%s/package.json', location)));\n  // Is the name defined by interal file references\n  var parts = name.split(/\\//);\n\n  // Optional dependencies exist\n  if(!object.peerOptionalDependencies) {\n    throw new Error(f('no optional dependency [%s] defined in peerOptionalDependencies in package.json', parts[0]));\n  } else if(object.peerOptionalDependencies && !object.peerOptionalDependencies[parts[0]]) {\n    throw new Error(f('no optional dependency [%s] defined in peerOptionalDependencies in package.json', parts[0]));\n  }\n\n  // Unpack the expected version\n  var expectedVersions = object.peerOptionalDependencies[parts[0]];\n  // The resolved package\n  var moduleEntry = undefined;\n  // Module file\n  var moduleEntryFile = name;\n\n  try {\n    // Validate if it's possible to read the module\n    moduleEntry = require(moduleEntryFile);\n  } catch(err) {\n    // Attempt to resolve in top level package\n    try {\n      // Get the module entry file\n      moduleEntryFile = resolveFrom(process.cwd(), name);\n      if(moduleEntryFile == null) return undefined;\n      // Attempt to resolve the module\n      moduleEntry = require(moduleEntryFile);\n    } catch(err) {\n      if(err.code === 'MODULE_NOT_FOUND') return undefined;\n    }\n  }\n\n  // Resolve the location of the module's package.json file\n  var location = find_package_json(require.resolve(moduleEntryFile));\n  if(!location) {\n    throw new Error('package.json can not be located');\n  }\n\n  // Read the module file\n  var dependentOnModule = JSON.parse(fs.readFileSync(f('%s/package.json', location)));\n  // Get the version\n  var version = dependentOnModule.version;\n  // Validate if the found module satisfies the version id\n  if(semver.satisfies(version, expectedVersions) == false\n    && options.strict) {\n      var error = new Error(f('optional dependency [%s] found but version [%s] did not satisfy constraint [%s]', parts[0], version, expectedVersions));\n      error.code = 'OPTIONAL_MODULE_NOT_FOUND';\n      throw error;\n  }\n\n  // Satifies the module requirement\n  return moduleEntry;\n}\n\nrequire_optional.exists = function(name) {\n  try {\n    var m = require_optional(name);\n    if(m === undefined) return false;\n    return true;\n  } catch(err) {\n    return false;\n  }\n}\n\nmodule.exports = require_optional;\n"]}