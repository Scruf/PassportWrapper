{"version":3,"sources":["pre.test.js"],"names":[],"mappings":"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","file":"pre.test-compiled.js","sourcesContent":["var assert = require('assert');\nvar Kareem = require('../');\n\ndescribe('execPre', function() {\n  var hooks;\n\n  beforeEach(function() {\n    hooks = new Kareem();\n  });\n\n  it('handles errors with multiple pres', function(done) {\n    var execed = {};\n\n    hooks.pre('cook', function(done) {\n      execed.first = true;\n      done();\n    });\n\n    hooks.pre('cook', function(done) {\n      execed.second = true;\n      done('error!');\n    });\n\n    hooks.pre('cook', function(done) {\n      execed.third = true;\n      done();\n    });\n\n    hooks.execPre('cook', null, function(err) {\n      assert.equal('error!', err);\n      assert.equal(2, Object.keys(execed).length);\n      assert.ok(execed.first);\n      assert.ok(execed.second);\n      done();\n    });\n  });\n\n  it('handles async errors', function(done) {\n    var execed = {};\n\n    hooks.pre('cook', true, function(next, done) {\n      execed.first = true;\n      setTimeout(\n        function() {\n          done('error!');\n        },\n        5);\n\n      next();\n    });\n\n    hooks.pre('cook', true, function(next, done) {\n      execed.second = true;\n      setTimeout(\n        function() {\n          done('other error!');\n        },\n        10);\n\n      next();\n    });\n\n    hooks.execPre('cook', null, function(err) {\n      assert.equal('error!', err);\n      assert.equal(2, Object.keys(execed).length);\n      assert.ok(execed.first);\n      assert.ok(execed.second);\n      done();\n    });\n  });\n\n  it('handles async errors in next()', function(done) {\n    var execed = {};\n\n    hooks.pre('cook', true, function(next, done) {\n      execed.first = true;\n      setTimeout(\n        function() {\n          done('other error!');\n        },\n        15);\n\n      next();\n    });\n\n    hooks.pre('cook', true, function(next, done) {\n      execed.second = true;\n      setTimeout(\n        function() {\n          next('error!');\n          done('another error!');\n        },\n        5);\n    });\n\n    hooks.execPre('cook', null, function(err) {\n      assert.equal('error!', err);\n      assert.equal(2, Object.keys(execed).length);\n      assert.ok(execed.first);\n      assert.ok(execed.second);\n      done();\n    });\n  });\n\n  it('handles async errors in next() when already done', function(done) {\n    var execed = {};\n\n    hooks.pre('cook', true, function(next, done) {\n      execed.first = true;\n      setTimeout(\n        function() {\n          done('other error!');\n        },\n        5);\n\n      next();\n    });\n\n    hooks.pre('cook', true, function(next, done) {\n      execed.second = true;\n      setTimeout(\n        function() {\n          next('error!');\n          done('another error!');\n        },\n        25);\n    });\n\n    hooks.execPre('cook', null, function(err) {\n      assert.equal('other error!', err);\n      assert.equal(2, Object.keys(execed).length);\n      assert.ok(execed.first);\n      assert.ok(execed.second);\n      done();\n    });\n  });\n\n  it('returns correct error when async pre errors', function(done) {\n    var execed = {};\n\n    hooks.pre('cook', true, function(next, done) {\n      execed.first = true;\n      setTimeout(\n        function() {\n          done('other error!');\n        },\n        5);\n\n      next();\n    });\n\n    hooks.pre('cook', function(next) {\n      execed.second = true;\n      setTimeout(\n        function() {\n          next('error!');\n        },\n        15);\n    });\n\n    hooks.execPre('cook', null, function(err) {\n      assert.equal('other error!', err);\n      assert.equal(2, Object.keys(execed).length);\n      assert.ok(execed.first);\n      assert.ok(execed.second);\n      done();\n    });\n  });\n\n  it('lets async pres run when fully sync pres are done', function(done) {\n    var execed = {};\n\n    hooks.pre('cook', true, function(next, done) {\n      execed.first = true;\n      setTimeout(\n        function() {\n          done();\n        },\n        5);\n\n      next();\n    });\n\n    hooks.pre('cook', function() {\n      execed.second = true;\n    });\n\n    hooks.execPre('cook', null, function(err) {\n      assert.ifError(err);\n      assert.equal(2, Object.keys(execed).length);\n      assert.ok(execed.first);\n      assert.ok(execed.second);\n      done();\n    });\n  });\n\n  it('allows passing arguments to the next pre', function(done) {\n    var execed = {};\n\n    hooks.pre('cook', function(next) {\n      execed.first = true;\n      next(null, 'test');\n    });\n\n    hooks.pre('cook', function(next, p) {\n      execed.second = true;\n      assert.equal(p, 'test');\n      next();\n    });\n\n    hooks.pre('cook', function(next, p) {\n      execed.third = true;\n      assert.ok(!p);\n      next();\n    });\n\n    hooks.execPre('cook', null, function(err) {\n      assert.ifError(err);\n      assert.equal(3, Object.keys(execed).length);\n      assert.ok(execed.first);\n      assert.ok(execed.second);\n      assert.ok(execed.third);\n      done();\n    });\n  });\n});\n"]}