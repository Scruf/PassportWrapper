{"version":3,"sources":["join.js"],"names":[],"mappings":"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","file":"join-compiled.js","sourcesContent":["\"use strict\";\nmodule.exports =\nfunction(Promise, PromiseArray, tryConvertToPromise, INTERNAL) {\nvar util = require(\"./util.js\");\nvar canEvaluate = util.canEvaluate;\nvar tryCatch = util.tryCatch;\nvar errorObj = util.errorObj;\nvar reject;\n\nif (!false) {\nif (canEvaluate) {\n    var thenCallback = function(i) {\n        return new Function(\"value\", \"holder\", \"                             \\n\\\n            'use strict';                                                    \\n\\\n            holder.pIndex = value;                                           \\n\\\n            holder.checkFulfillment(this);                                   \\n\\\n            \".replace(/Index/g, i));\n    };\n\n    var caller = function(count) {\n        var values = [];\n        for (var i = 1; i <= count; ++i) values.push(\"holder.p\" + i);\n        return new Function(\"holder\", \"                                      \\n\\\n            'use strict';                                                    \\n\\\n            var callback = holder.fn;                                        \\n\\\n            return callback(values);                                         \\n\\\n            \".replace(/values/g, values.join(\", \")));\n    };\n    var thenCallbacks = [];\n    var callers = [undefined];\n    for (var i = 1; i <= 5; ++i) {\n        thenCallbacks.push(thenCallback(i));\n        callers.push(caller(i));\n    }\n\n    var Holder = function(total, fn) {\n        this.p1 = this.p2 = this.p3 = this.p4 = this.p5 = null;\n        this.fn = fn;\n        this.total = total;\n        this.now = 0;\n    };\n\n    Holder.prototype.callers = callers;\n    Holder.prototype.checkFulfillment = function(promise) {\n        var now = this.now;\n        now++;\n        var total = this.total;\n        if (now >= total) {\n            var handler = this.callers[total];\n            promise._pushContext();\n            var ret = tryCatch(handler)(this);\n            promise._popContext();\n            if (ret === errorObj) {\n                promise._rejectCallback(ret.e, false, true);\n            } else {\n                promise._resolveCallback(ret);\n            }\n        } else {\n            this.now = now;\n        }\n    };\n\n    var reject = function (reason) {\n        this._reject(reason);\n    };\n}\n}\n\nPromise.join = function () {\n    var last = arguments.length - 1;\n    var fn;\n    if (last > 0 && typeof arguments[last] === \"function\") {\n        fn = arguments[last];\n        if (!false) {\n            if (last < 6 && canEvaluate) {\n                var ret = new Promise(INTERNAL);\n                ret._captureStackTrace();\n                var holder = new Holder(last, fn);\n                var callbacks = thenCallbacks;\n                for (var i = 0; i < last; ++i) {\n                    var maybePromise = tryConvertToPromise(arguments[i], ret);\n                    if (maybePromise instanceof Promise) {\n                        maybePromise = maybePromise._target();\n                        if (maybePromise._isPending()) {\n                            maybePromise._then(callbacks[i], reject,\n                                               undefined, ret, holder);\n                        } else if (maybePromise._isFulfilled()) {\n                            callbacks[i].call(ret,\n                                              maybePromise._value(), holder);\n                        } else {\n                            ret._reject(maybePromise._reason());\n                        }\n                    } else {\n                        callbacks[i].call(ret, maybePromise, holder);\n                    }\n                }\n                return ret;\n            }\n        }\n    }\n    var $_len = arguments.length;var args = new Array($_len); for(var $_i = 0; $_i < $_len; ++$_i) {args[$_i] = arguments[$_i];}\n    if (fn) args.pop();\n    var ret = new PromiseArray(args).promise();\n    return fn !== undefined ? ret.spread(fn) : ret;\n};\n\n};\n"]}