{"version":3,"sources":["promise_resolver.js"],"names":[],"mappings":"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","file":"promise_resolver-compiled.js","sourcesContent":["\"use strict\";\nvar util = require(\"./util.js\");\nvar maybeWrapAsError = util.maybeWrapAsError;\nvar errors = require(\"./errors.js\");\nvar TimeoutError = errors.TimeoutError;\nvar OperationalError = errors.OperationalError;\nvar haveGetters = util.haveGetters;\nvar es5 = require(\"./es5.js\");\n\nfunction isUntypedError(obj) {\n    return obj instanceof Error &&\n        es5.getPrototypeOf(obj) === Error.prototype;\n}\n\nvar rErrorKey = /^(?:name|message|stack|cause)$/;\nfunction wrapAsOperationalError(obj) {\n    var ret;\n    if (isUntypedError(obj)) {\n        ret = new OperationalError(obj);\n        ret.name = obj.name;\n        ret.message = obj.message;\n        ret.stack = obj.stack;\n        var keys = es5.keys(obj);\n        for (var i = 0; i < keys.length; ++i) {\n            var key = keys[i];\n            if (!rErrorKey.test(key)) {\n                ret[key] = obj[key];\n            }\n        }\n        return ret;\n    }\n    util.markAsOriginatingFromRejection(obj);\n    return obj;\n}\n\nfunction nodebackForPromise(promise) {\n    return function(err, value) {\n        if (promise === null) return;\n\n        if (err) {\n            var wrapped = wrapAsOperationalError(maybeWrapAsError(err));\n            promise._attachExtraTrace(wrapped);\n            promise._reject(wrapped);\n        } else if (arguments.length > 2) {\n            var $_len = arguments.length;var args = new Array($_len - 1); for(var $_i = 1; $_i < $_len; ++$_i) {args[$_i - 1] = arguments[$_i];}\n            promise._fulfill(args);\n        } else {\n            promise._fulfill(value);\n        }\n\n        promise = null;\n    };\n}\n\n\nvar PromiseResolver;\nif (!haveGetters) {\n    PromiseResolver = function (promise) {\n        this.promise = promise;\n        this.asCallback = nodebackForPromise(promise);\n        this.callback = this.asCallback;\n    };\n}\nelse {\n    PromiseResolver = function (promise) {\n        this.promise = promise;\n    };\n}\nif (haveGetters) {\n    var prop = {\n        get: function() {\n            return nodebackForPromise(this.promise);\n        }\n    };\n    es5.defineProperty(PromiseResolver.prototype, \"asCallback\", prop);\n    es5.defineProperty(PromiseResolver.prototype, \"callback\", prop);\n}\n\nPromiseResolver._nodebackForPromise = nodebackForPromise;\n\nPromiseResolver.prototype.toString = function () {\n    return \"[object PromiseResolver]\";\n};\n\nPromiseResolver.prototype.resolve =\nPromiseResolver.prototype.fulfill = function (value) {\n    if (!(this instanceof PromiseResolver)) {\n        throw new TypeError(\"Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\\u000a\\u000a    See http://goo.gl/sdkXL9\\u000a\");\n    }\n    this.promise._resolveCallback(value);\n};\n\nPromiseResolver.prototype.reject = function (reason) {\n    if (!(this instanceof PromiseResolver)) {\n        throw new TypeError(\"Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\\u000a\\u000a    See http://goo.gl/sdkXL9\\u000a\");\n    }\n    this.promise._rejectCallback(reason);\n};\n\nPromiseResolver.prototype.progress = function (value) {\n    if (!(this instanceof PromiseResolver)) {\n        throw new TypeError(\"Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\\u000a\\u000a    See http://goo.gl/sdkXL9\\u000a\");\n    }\n    this.promise._progress(value);\n};\n\nPromiseResolver.prototype.cancel = function (err) {\n    this.promise.cancel(err);\n};\n\nPromiseResolver.prototype.timeout = function () {\n    this.reject(new TimeoutError(\"timeout\"));\n};\n\nPromiseResolver.prototype.isResolved = function () {\n    return this.promise.isResolved();\n};\n\nPromiseResolver.prototype.toJSON = function () {\n    return this.promise.toJSON();\n};\n\nmodule.exports = PromiseResolver;\n"]}