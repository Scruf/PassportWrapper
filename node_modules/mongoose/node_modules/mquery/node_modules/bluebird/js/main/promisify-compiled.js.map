{"version":3,"sources":["promisify.js"],"names":[],"mappings":"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","file":"promisify-compiled.js","sourcesContent":["\"use strict\";\nmodule.exports = function(Promise, INTERNAL) {\nvar THIS = {};\nvar util = require(\"./util.js\");\nvar nodebackForPromise = require(\"./promise_resolver.js\")\n    ._nodebackForPromise;\nvar withAppended = util.withAppended;\nvar maybeWrapAsError = util.maybeWrapAsError;\nvar canEvaluate = util.canEvaluate;\nvar TypeError = require(\"./errors\").TypeError;\nvar defaultSuffix = \"Async\";\nvar defaultPromisified = {__isPromisified__: true};\nvar noCopyProps = [\n    \"arity\",    \"length\",\n    \"name\",\n    \"arguments\",\n    \"caller\",\n    \"callee\",\n    \"prototype\",\n    \"__isPromisified__\"\n];\nvar noCopyPropsPattern = new RegExp(\"^(?:\" + noCopyProps.join(\"|\") + \")$\");\n\nvar defaultFilter = function(name) {\n    return util.isIdentifier(name) &&\n        name.charAt(0) !== \"_\" &&\n        name !== \"constructor\";\n};\n\nfunction propsFilter(key) {\n    return !noCopyPropsPattern.test(key);\n}\n\nfunction isPromisified(fn) {\n    try {\n        return fn.__isPromisified__ === true;\n    }\n    catch (e) {\n        return false;\n    }\n}\n\nfunction hasPromisified(obj, key, suffix) {\n    var val = util.getDataPropertyOrDefault(obj, key + suffix,\n                                            defaultPromisified);\n    return val ? isPromisified(val) : false;\n}\nfunction checkValid(ret, suffix, suffixRegexp) {\n    for (var i = 0; i < ret.length; i += 2) {\n        var key = ret[i];\n        if (suffixRegexp.test(key)) {\n            var keyWithoutAsyncSuffix = key.replace(suffixRegexp, \"\");\n            for (var j = 0; j < ret.length; j += 2) {\n                if (ret[j] === keyWithoutAsyncSuffix) {\n                    throw new TypeError(\"Cannot promisify an API that has normal methods with '%s'-suffix\\u000a\\u000a    See http://goo.gl/iWrZbw\\u000a\"\n                        .replace(\"%s\", suffix));\n                }\n            }\n        }\n    }\n}\n\nfunction promisifiableMethods(obj, suffix, suffixRegexp, filter) {\n    var keys = util.inheritedDataKeys(obj);\n    var ret = [];\n    for (var i = 0; i < keys.length; ++i) {\n        var key = keys[i];\n        var value = obj[key];\n        var passesDefaultFilter = filter === defaultFilter\n            ? true : defaultFilter(key, value, obj);\n        if (typeof value === \"function\" &&\n            !isPromisified(value) &&\n            !hasPromisified(obj, key, suffix) &&\n            filter(key, value, obj, passesDefaultFilter)) {\n            ret.push(key, value);\n        }\n    }\n    checkValid(ret, suffix, suffixRegexp);\n    return ret;\n}\n\nvar escapeIdentRegex = function(str) {\n    return str.replace(/([$])/, \"\\\\$\");\n};\n\nvar makeNodePromisifiedEval;\nif (!false) {\nvar switchCaseArgumentOrder = function(likelyArgumentCount) {\n    var ret = [likelyArgumentCount];\n    var min = Math.max(0, likelyArgumentCount - 1 - 3);\n    for(var i = likelyArgumentCount - 1; i >= min; --i) {\n        ret.push(i);\n    }\n    for(var i = likelyArgumentCount + 1; i <= 3; ++i) {\n        ret.push(i);\n    }\n    return ret;\n};\n\nvar argumentSequence = function(argumentCount) {\n    return util.filledRange(argumentCount, \"_arg\", \"\");\n};\n\nvar parameterDeclaration = function(parameterCount) {\n    return util.filledRange(\n        Math.max(parameterCount, 3), \"_arg\", \"\");\n};\n\nvar parameterCount = function(fn) {\n    if (typeof fn.length === \"number\") {\n        return Math.max(Math.min(fn.length, 1023 + 1), 0);\n    }\n    return 0;\n};\n\nmakeNodePromisifiedEval =\nfunction(callback, receiver, originalName, fn) {\n    var newParameterCount = Math.max(0, parameterCount(fn) - 1);\n    var argumentOrder = switchCaseArgumentOrder(newParameterCount);\n    var shouldProxyThis = typeof callback === \"string\" || receiver === THIS;\n\n    function generateCallForArgumentCount(count) {\n        var args = argumentSequence(count).join(\", \");\n        var comma = count > 0 ? \", \" : \"\";\n        var ret;\n        if (shouldProxyThis) {\n            ret = \"ret = callback.call(this, {{args}}, nodeback); break;\\n\";\n        } else {\n            ret = receiver === undefined\n                ? \"ret = callback({{args}}, nodeback); break;\\n\"\n                : \"ret = callback.call(receiver, {{args}}, nodeback); break;\\n\";\n        }\n        return ret.replace(\"{{args}}\", args).replace(\", \", comma);\n    }\n\n    function generateArgumentSwitchCase() {\n        var ret = \"\";\n        for (var i = 0; i < argumentOrder.length; ++i) {\n            ret += \"case \" + argumentOrder[i] +\":\" +\n                generateCallForArgumentCount(argumentOrder[i]);\n        }\n\n        ret += \"                                                             \\n\\\n        default:                                                             \\n\\\n            var args = new Array(len + 1);                                   \\n\\\n            var i = 0;                                                       \\n\\\n            for (var i = 0; i < len; ++i) {                                  \\n\\\n               args[i] = arguments[i];                                       \\n\\\n            }                                                                \\n\\\n            args[i] = nodeback;                                              \\n\\\n            [CodeForCall]                                                    \\n\\\n            break;                                                           \\n\\\n        \".replace(\"[CodeForCall]\", (shouldProxyThis\n                                ? \"ret = callback.apply(this, args);\\n\"\n                                : \"ret = callback.apply(receiver, args);\\n\"));\n        return ret;\n    }\n\n    var getFunctionCode = typeof callback === \"string\"\n                                ? (\"this != null ? this['\"+callback+\"'] : fn\")\n                                : \"fn\";\n\n    return new Function(\"Promise\",\n                        \"fn\",\n                        \"receiver\",\n                        \"withAppended\",\n                        \"maybeWrapAsError\",\n                        \"nodebackForPromise\",\n                        \"tryCatch\",\n                        \"errorObj\",\n                        \"notEnumerableProp\",\n                        \"INTERNAL\",\"'use strict';                            \\n\\\n        var ret = function (Parameters) {                                    \\n\\\n            'use strict';                                                    \\n\\\n            var len = arguments.length;                                      \\n\\\n            var promise = new Promise(INTERNAL);                             \\n\\\n            promise._captureStackTrace();                                    \\n\\\n            var nodeback = nodebackForPromise(promise);                      \\n\\\n            var ret;                                                         \\n\\\n            var callback = tryCatch([GetFunctionCode]);                      \\n\\\n            switch(len) {                                                    \\n\\\n                [CodeForSwitchCase]                                          \\n\\\n            }                                                                \\n\\\n            if (ret === errorObj) {                                          \\n\\\n                promise._rejectCallback(maybeWrapAsError(ret.e), true, true);\\n\\\n            }                                                                \\n\\\n            return promise;                                                  \\n\\\n        };                                                                   \\n\\\n        notEnumerableProp(ret, '__isPromisified__', true);                   \\n\\\n        return ret;                                                          \\n\\\n        \"\n        .replace(\"Parameters\", parameterDeclaration(newParameterCount))\n        .replace(\"[CodeForSwitchCase]\", generateArgumentSwitchCase())\n        .replace(\"[GetFunctionCode]\", getFunctionCode))(\n            Promise,\n            fn,\n            receiver,\n            withAppended,\n            maybeWrapAsError,\n            nodebackForPromise,\n            util.tryCatch,\n            util.errorObj,\n            util.notEnumerableProp,\n            INTERNAL\n        );\n};\n}\n\nfunction makeNodePromisifiedClosure(callback, receiver, _, fn) {\n    var defaultThis = (function() {return this;})();\n    var method = callback;\n    if (typeof method === \"string\") {\n        callback = fn;\n    }\n    function promisified() {\n        var _receiver = receiver;\n        if (receiver === THIS) _receiver = this;\n        var promise = new Promise(INTERNAL);\n        promise._captureStackTrace();\n        var cb = typeof method === \"string\" && this !== defaultThis\n            ? this[method] : callback;\n        var fn = nodebackForPromise(promise);\n        try {\n            cb.apply(_receiver, withAppended(arguments, fn));\n        } catch(e) {\n            promise._rejectCallback(maybeWrapAsError(e), true, true);\n        }\n        return promise;\n    }\n    util.notEnumerableProp(promisified, \"__isPromisified__\", true);\n    return promisified;\n}\n\nvar makeNodePromisified = canEvaluate\n    ? makeNodePromisifiedEval\n    : makeNodePromisifiedClosure;\n\nfunction promisifyAll(obj, suffix, filter, promisifier) {\n    var suffixRegexp = new RegExp(escapeIdentRegex(suffix) + \"$\");\n    var methods =\n        promisifiableMethods(obj, suffix, suffixRegexp, filter);\n\n    for (var i = 0, len = methods.length; i < len; i+= 2) {\n        var key = methods[i];\n        var fn = methods[i+1];\n        var promisifiedKey = key + suffix;\n        if (promisifier === makeNodePromisified) {\n            obj[promisifiedKey] =\n                makeNodePromisified(key, THIS, key, fn, suffix);\n        } else {\n            var promisified = promisifier(fn, function() {\n                return makeNodePromisified(key, THIS, key, fn, suffix);\n            });\n            util.notEnumerableProp(promisified, \"__isPromisified__\", true);\n            obj[promisifiedKey] = promisified;\n        }\n    }\n    util.toFastProperties(obj);\n    return obj;\n}\n\nfunction promisify(callback, receiver) {\n    return makeNodePromisified(callback, receiver, undefined, callback);\n}\n\nPromise.promisify = function (fn, receiver) {\n    if (typeof fn !== \"function\") {\n        throw new TypeError(\"fn must be a function\\u000a\\u000a    See http://goo.gl/916lJJ\\u000a\");\n    }\n    if (isPromisified(fn)) {\n        return fn;\n    }\n    var ret = promisify(fn, arguments.length < 2 ? THIS : receiver);\n    util.copyDescriptors(fn, ret, propsFilter);\n    return ret;\n};\n\nPromise.promisifyAll = function (target, options) {\n    if (typeof target !== \"function\" && typeof target !== \"object\") {\n        throw new TypeError(\"the target of promisifyAll must be an object or a function\\u000a\\u000a    See http://goo.gl/9ITlV0\\u000a\");\n    }\n    options = Object(options);\n    var suffix = options.suffix;\n    if (typeof suffix !== \"string\") suffix = defaultSuffix;\n    var filter = options.filter;\n    if (typeof filter !== \"function\") filter = defaultFilter;\n    var promisifier = options.promisifier;\n    if (typeof promisifier !== \"function\") promisifier = makeNodePromisified;\n\n    if (!util.isIdentifier(suffix)) {\n        throw new RangeError(\"suffix must be a valid identifier\\u000a\\u000a    See http://goo.gl/8FZo5V\\u000a\");\n    }\n\n    var keys = util.inheritedDataKeys(target);\n    for (var i = 0; i < keys.length; ++i) {\n        var value = target[keys[i]];\n        if (keys[i] !== \"constructor\" &&\n            util.isClass(value)) {\n            promisifyAll(value.prototype, suffix, filter, promisifier);\n            promisifyAll(value, suffix, filter, promisifier);\n        }\n    }\n\n    return promisifyAll(target, suffix, filter, promisifier);\n};\n};\n\n"]}