{"version":3,"sources":["async.js"],"names":[],"mappings":"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","file":"async-compiled.js","sourcesContent":["\"use strict\";\nvar firstLineError;\ntry {throw new Error(); } catch (e) {firstLineError = e;}\nvar schedule = require(\"./schedule.js\");\nvar Queue = require(\"./queue.js\");\nvar util = require(\"./util.js\");\n\nfunction Async() {\n    this._isTickUsed = false;\n    this._lateQueue = new Queue(16);\n    this._normalQueue = new Queue(16);\n    this._trampolineEnabled = true;\n    var self = this;\n    this.drainQueues = function () {\n        self._drainQueues();\n    };\n    this._schedule =\n        schedule.isStatic ? schedule(this.drainQueues) : schedule;\n}\n\nAsync.prototype.disableTrampolineIfNecessary = function() {\n    if (util.hasDevTools) {\n        this._trampolineEnabled = false;\n    }\n};\n\nAsync.prototype.enableTrampoline = function() {\n    if (!this._trampolineEnabled) {\n        this._trampolineEnabled = true;\n        this._schedule = function(fn) {\n            setTimeout(fn, 0);\n        };\n    }\n};\n\nAsync.prototype.haveItemsQueued = function () {\n    return this._normalQueue.length() > 0;\n};\n\nAsync.prototype.throwLater = function(fn, arg) {\n    if (arguments.length === 1) {\n        arg = fn;\n        fn = function () { throw arg; };\n    }\n    if (typeof setTimeout !== \"undefined\") {\n        setTimeout(function() {\n            fn(arg);\n        }, 0);\n    } else try {\n        this._schedule(function() {\n            fn(arg);\n        });\n    } catch (e) {\n        throw new Error(\"No async scheduler available\\u000a\\u000a    See http://goo.gl/m3OTXk\\u000a\");\n    }\n};\n\nfunction AsyncInvokeLater(fn, receiver, arg) {\n    this._lateQueue.push(fn, receiver, arg);\n    this._queueTick();\n}\n\nfunction AsyncInvoke(fn, receiver, arg) {\n    this._normalQueue.push(fn, receiver, arg);\n    this._queueTick();\n}\n\nfunction AsyncSettlePromises(promise) {\n    this._normalQueue._pushOne(promise);\n    this._queueTick();\n}\n\nif (!util.hasDevTools) {\n    Async.prototype.invokeLater = AsyncInvokeLater;\n    Async.prototype.invoke = AsyncInvoke;\n    Async.prototype.settlePromises = AsyncSettlePromises;\n} else {\n    if (schedule.isStatic) {\n        schedule = function(fn) { setTimeout(fn, 0); };\n    }\n    Async.prototype.invokeLater = function (fn, receiver, arg) {\n        if (this._trampolineEnabled) {\n            AsyncInvokeLater.call(this, fn, receiver, arg);\n        } else {\n            this._schedule(function() {\n                setTimeout(function() {\n                    fn.call(receiver, arg);\n                }, 100);\n            });\n        }\n    };\n\n    Async.prototype.invoke = function (fn, receiver, arg) {\n        if (this._trampolineEnabled) {\n            AsyncInvoke.call(this, fn, receiver, arg);\n        } else {\n            this._schedule(function() {\n                fn.call(receiver, arg);\n            });\n        }\n    };\n\n    Async.prototype.settlePromises = function(promise) {\n        if (this._trampolineEnabled) {\n            AsyncSettlePromises.call(this, promise);\n        } else {\n            this._schedule(function() {\n                promise._settlePromises();\n            });\n        }\n    };\n}\n\nAsync.prototype.invokeFirst = function (fn, receiver, arg) {\n    this._normalQueue.unshift(fn, receiver, arg);\n    this._queueTick();\n};\n\nAsync.prototype._drainQueue = function(queue) {\n    while (queue.length() > 0) {\n        var fn = queue.shift();\n        if (typeof fn !== \"function\") {\n            fn._settlePromises();\n            continue;\n        }\n        var receiver = queue.shift();\n        var arg = queue.shift();\n        fn.call(receiver, arg);\n    }\n};\n\nAsync.prototype._drainQueues = function () {\n    this._drainQueue(this._normalQueue);\n    this._reset();\n    this._drainQueue(this._lateQueue);\n};\n\nAsync.prototype._queueTick = function () {\n    if (!this._isTickUsed) {\n        this._isTickUsed = true;\n        this._schedule(this.drainQueues);\n    }\n};\n\nAsync.prototype._reset = function () {\n    this._isTickUsed = false;\n};\n\nmodule.exports = new Async();\nmodule.exports.firstLineError = firstLineError;\n"]}