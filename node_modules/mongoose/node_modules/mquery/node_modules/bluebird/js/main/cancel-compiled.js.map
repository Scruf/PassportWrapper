{"version":3,"sources":["cancel.js"],"names":[],"mappings":"AAAA;;AACA,OAAO,OAAP,GAAiB,UAAS,OAAT,EAAkB;AACnC,QAAI,SAAS,QAAQ,aAAR,CAAT,CAD+B;AAEnC,QAAI,QAAQ,QAAQ,YAAR,CAAR,CAF+B;AAGnC,QAAI,oBAAoB,OAAO,iBAAP,CAHW;;AAKnC,YAAQ,SAAR,CAAkB,OAAlB,GAA4B,UAAU,MAAV,EAAkB;AAC1C,YAAI,CAAC,KAAK,aAAL,EAAD,EAAuB,OAAO,IAAP,CAA3B;AACA,YAAI,MAAJ,CAF0C;AAG1C,YAAI,kBAAkB,IAAlB,CAHsC;AAI1C,eAAO,CAAC,SAAS,gBAAgB,mBAAhB,CAAV,KAAmD,SAAnD,IACH,OAAO,aAAP,EADG,EACqB;AACxB,8BAAkB,MAAlB,CADwB;SAD5B;AAIA,aAAK,iBAAL,GAR0C;AAS1C,wBAAgB,OAAhB,GAA0B,eAA1B,CAA0C,MAA1C,EAAkD,KAAlD,EAAyD,IAAzD,EAT0C;KAAlB,CALO;;AAiBnC,YAAQ,SAAR,CAAkB,MAAlB,GAA2B,UAAU,MAAV,EAAkB;AACzC,YAAI,CAAC,KAAK,aAAL,EAAD,EAAuB,OAAO,IAAP,CAA3B;AACA,YAAI,WAAW,SAAX,EAAsB,SAAS,IAAI,iBAAJ,EAAT,CAA1B;AACA,cAAM,WAAN,CAAkB,KAAK,OAAL,EAAc,IAAhC,EAAsC,MAAtC,EAHyC;AAIzC,eAAO,IAAP,CAJyC;KAAlB,CAjBQ;;AAwBnC,YAAQ,SAAR,CAAkB,WAAlB,GAAgC,YAAY;AACxC,YAAI,KAAK,YAAL,EAAJ,EAAyB,OAAO,IAAP,CAAzB;AACA,cAAM,gBAAN,GAFwC;AAGxC,aAAK,eAAL,GAHwC;AAIxC,aAAK,mBAAL,GAA2B,SAA3B,CAJwC;AAKxC,eAAO,IAAP,CALwC;KAAZ,CAxBG;;AAgCnC,YAAQ,SAAR,CAAkB,aAAlB,GAAkC,YAAY;AAC1C,YAAI,MAAM,KAAK,IAAL,EAAN,CADsC;AAE1C,YAAI,iBAAJ,GAF0C;AAG1C,eAAO,GAAP,CAH0C;KAAZ,CAhCC;;AAsCnC,YAAQ,SAAR,CAAkB,IAAlB,GAAyB,UAAU,UAAV,EAAsB,SAAtB,EAAiC,WAAjC,EAA8C;AACnE,YAAI,MAAM,KAAK,KAAL,CAAW,UAAX,EAAuB,SAAvB,EAAkC,WAAlC,EACW,SADX,EACsB,SADtB,CAAN,CAD+D;;AAInE,YAAI,eAAJ,GAJmE;AAKnE,YAAI,mBAAJ,GAA0B,SAA1B,CALmE;AAMnE,eAAO,GAAP,CANmE;KAA9C,CAtCU;CAAlB","file":"cancel-compiled.js","sourcesContent":["\"use strict\";\nmodule.exports = function(Promise) {\nvar errors = require(\"./errors.js\");\nvar async = require(\"./async.js\");\nvar CancellationError = errors.CancellationError;\n\nPromise.prototype._cancel = function (reason) {\n    if (!this.isCancellable()) return this;\n    var parent;\n    var promiseToReject = this;\n    while ((parent = promiseToReject._cancellationParent) !== undefined &&\n        parent.isCancellable()) {\n        promiseToReject = parent;\n    }\n    this._unsetCancellable();\n    promiseToReject._target()._rejectCallback(reason, false, true);\n};\n\nPromise.prototype.cancel = function (reason) {\n    if (!this.isCancellable()) return this;\n    if (reason === undefined) reason = new CancellationError();\n    async.invokeLater(this._cancel, this, reason);\n    return this;\n};\n\nPromise.prototype.cancellable = function () {\n    if (this._cancellable()) return this;\n    async.enableTrampoline();\n    this._setCancellable();\n    this._cancellationParent = undefined;\n    return this;\n};\n\nPromise.prototype.uncancellable = function () {\n    var ret = this.then();\n    ret._unsetCancellable();\n    return ret;\n};\n\nPromise.prototype.fork = function (didFulfill, didReject, didProgress) {\n    var ret = this._then(didFulfill, didReject, didProgress,\n                         undefined, undefined);\n\n    ret._setCancellable();\n    ret._cancellationParent = undefined;\n    return ret;\n};\n};\n"]}