{"version":3,"sources":["utils.test.js"],"names":[],"mappings":"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","file":"utils.test-compiled.js","sourcesContent":["\nvar utils = require('../lib/utils');\nvar assert = require('assert');\n\nvar mongo;\ntry {\n  mongo = new require('mongodb');\n} catch (e) {}\n\ndescribe('lib/utils', function() {\n  describe('clone', function() {\n    it('clones constructors named ObjectId', function(done) {\n      function ObjectId (id) {\n        this.id = id;\n      }\n\n      var o1 = new ObjectId('1234');\n      var o2 = utils.clone(o1);\n      assert.ok(o2 instanceof ObjectId);\n\n      done();\n    });\n\n    it('clones constructors named ObjectID', function(done) {\n      function ObjectID (id) {\n        this.id = id;\n      }\n\n      var o1 = new ObjectID('1234');\n      var o2 = utils.clone(o1);\n\n      assert.ok(o2 instanceof ObjectID);\n      done();\n    });\n\n    it('does not clone constructors named ObjectIdd', function(done) {\n      function ObjectIdd (id) {\n        this.id = id;\n      }\n\n      var o1 = new ObjectIdd('1234');\n      var o2 = utils.clone(o1);\n      assert.ok(!(o2 instanceof ObjectIdd));\n\n      done();\n    });\n\n    it('optionally clones ObjectId constructors using its clone method', function(done) {\n      function ObjectID (id) {\n        this.id = id;\n        this.cloned = false;\n      }\n\n      ObjectID.prototype.clone = function () {\n        var ret = new ObjectID(this.id);\n        ret.cloned = true;\n        return ret;\n      }\n\n      var id = 1234;\n      var o1 = new ObjectID(id);\n      assert.equal(id, o1.id);\n      assert.equal(false, o1.cloned);\n\n      var o2 = utils.clone(o1);\n      assert.ok(o2 instanceof ObjectID);\n      assert.equal(id, o2.id);\n      assert.ok(o2.cloned);\n      done();\n    });\n\n    it('clones mongodb.ReadPreferences', function (done) {\n      if (!mongo) return done();\n\n      var tags = [\n        {dc: 'tag1'}\n      ];\n      var prefs = [\n        new mongo.ReadPreference(\"primary\"),\n        new mongo.ReadPreference(mongo.ReadPreference.PRIMARY_PREFERRED),\n        new mongo.ReadPreference(\"primary\", tags),\n        mongo.ReadPreference(\"primary\", tags)\n      ];\n\n      var prefsCloned = utils.clone(prefs);\n\n      for (var i = 0; i < prefsCloned.length; i++) {\n        assert.notEqual(prefs[i], prefsCloned[i]);\n        assert.ok(prefsCloned[i] instanceof mongo.ReadPreference);\n        assert.ok(prefsCloned[i].isValid());\n        if (prefs[i].tags) {\n          assert.ok(prefsCloned[i].tags);\n          assert.notEqual(prefs[i].tags, prefsCloned[i].tags);\n          assert.notEqual(prefs[i].tags[0], prefsCloned[i].tags[0]);\n        } else {\n          assert.equal(prefsCloned[i].tags, null);\n        }\n      }\n\n      done();\n    });\n\n    it('clones mongodb.Binary', function(done){\n      if (!mongo) return done();\n\n      var buf = new Buffer('hi');\n      var binary= new mongo.Binary(buf, 2);\n      var clone = utils.clone(binary);\n      assert.equal(binary.sub_type, clone.sub_type);\n      assert.equal(String(binary.buffer), String(buf));\n      assert.ok(binary !== clone);\n      done();\n    })\n\n    it('handles objects with no constructor', function(done) {\n      var name ='335';\n\n      var o = Object.create(null);\n      o.name = name;\n\n      var clone;\n      assert.doesNotThrow(function() {\n        clone = utils.clone(o);\n      });\n\n      assert.equal(name, clone.name);\n      assert.ok(o != clone);\n      done();\n    });\n\n    it('handles buffers', function(done){\n      var buff = new Buffer(10);\n      buff.fill(1);\n      var clone = utils.clone(buff);\n\n      for (var i = 0; i < buff.length; i++) {\n        assert.equal(buff[i], clone[i]);\n      }\n\n      done();\n    });\n  });\n});\n"]}