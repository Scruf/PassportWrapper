{"version":3,"sources":["utils.js"],"names":[],"mappings":"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","file":"utils-compiled.js","sourcesContent":["/*!\n * Module dependencies.\n */\n\nvar ObjectId = require('./types/objectid');\nvar cloneRegExp = require('regexp-clone');\nvar sliced = require('sliced');\nvar mpath = require('mpath');\nvar ms = require('ms');\nvar MongooseBuffer;\nvar MongooseArray;\nvar Document;\n\n/*!\n * Produces a collection name from model `name`.\n *\n * @param {String} name a model name\n * @return {String} a collection name\n * @api private\n */\n\nexports.toCollectionName = function(name, options) {\n  options = options || {};\n  if (name === 'system.profile') {\n    return name;\n  }\n  if (name === 'system.indexes') {\n    return name;\n  }\n  if (options.pluralization === false) {\n    return name;\n  }\n  return pluralize(name.toLowerCase());\n};\n\n/**\n * Pluralization rules.\n *\n * These rules are applied while processing the argument to `toCollectionName`.\n *\n * @deprecated remove in 4.x gh-1350\n */\n\nexports.pluralization = [\n  [/(m)an$/gi, '$1en'],\n  [/(pe)rson$/gi, '$1ople'],\n  [/(child)$/gi, '$1ren'],\n  [/^(ox)$/gi, '$1en'],\n  [/(ax|test)is$/gi, '$1es'],\n  [/(octop|vir)us$/gi, '$1i'],\n  [/(alias|status)$/gi, '$1es'],\n  [/(bu)s$/gi, '$1ses'],\n  [/(buffal|tomat|potat)o$/gi, '$1oes'],\n  [/([ti])um$/gi, '$1a'],\n  [/sis$/gi, 'ses'],\n  [/(?:([^f])fe|([lr])f)$/gi, '$1$2ves'],\n  [/(hive)$/gi, '$1s'],\n  [/([^aeiouy]|qu)y$/gi, '$1ies'],\n  [/(x|ch|ss|sh)$/gi, '$1es'],\n  [/(matr|vert|ind)ix|ex$/gi, '$1ices'],\n  [/([m|l])ouse$/gi, '$1ice'],\n  [/(kn|w|l)ife$/gi, '$1ives'],\n  [/(quiz)$/gi, '$1zes'],\n  [/s$/gi, 's'],\n  [/([^a-z])$/, '$1'],\n  [/$/gi, 's']\n];\nvar rules = exports.pluralization;\n\n/**\n * Uncountable words.\n *\n * These words are applied while processing the argument to `toCollectionName`.\n * @api public\n */\n\nexports.uncountables = [\n  'advice',\n  'energy',\n  'excretion',\n  'digestion',\n  'cooperation',\n  'health',\n  'justice',\n  'labour',\n  'machinery',\n  'equipment',\n  'information',\n  'pollution',\n  'sewage',\n  'paper',\n  'money',\n  'species',\n  'series',\n  'rain',\n  'rice',\n  'fish',\n  'sheep',\n  'moose',\n  'deer',\n  'news',\n  'expertise',\n  'status',\n  'media'\n];\nvar uncountables = exports.uncountables;\n\n/*!\n * Pluralize function.\n *\n * @author TJ Holowaychuk (extracted from _ext.js_)\n * @param {String} string to pluralize\n * @api private\n */\n\nfunction pluralize(str) {\n  var found;\n  if (!~uncountables.indexOf(str.toLowerCase())) {\n    found = rules.filter(function(rule) {\n      return str.match(rule[0]);\n    });\n    if (found[0]) {\n      return str.replace(found[0][0], found[0][1]);\n    }\n  }\n  return str;\n}\n\n/*!\n * Determines if `a` and `b` are deep equal.\n *\n * Modified from node/lib/assert.js\n *\n * @param {any} a a value to compare to `b`\n * @param {any} b a value to compare to `a`\n * @return {Boolean}\n * @api private\n */\n\nexports.deepEqual = function deepEqual(a, b) {\n  if (a === b) {\n    return true;\n  }\n\n  if (a instanceof Date && b instanceof Date) {\n    return a.getTime() === b.getTime();\n  }\n\n  if (a instanceof ObjectId && b instanceof ObjectId) {\n    return a.toString() === b.toString();\n  }\n\n  if (a instanceof RegExp && b instanceof RegExp) {\n    return a.source === b.source &&\n        a.ignoreCase === b.ignoreCase &&\n        a.multiline === b.multiline &&\n        a.global === b.global;\n  }\n\n  if (typeof a !== 'object' && typeof b !== 'object') {\n    return a == b;\n  }\n\n  if (a === null || b === null || a === undefined || b === undefined) {\n    return false;\n  }\n\n  if (a.prototype !== b.prototype) {\n    return false;\n  }\n\n  // Handle MongooseNumbers\n  if (a instanceof Number && b instanceof Number) {\n    return a.valueOf() === b.valueOf();\n  }\n\n  if (Buffer.isBuffer(a)) {\n    return exports.buffer.areEqual(a, b);\n  }\n\n  if (isMongooseObject(a)) {\n    a = a.toObject();\n  }\n  if (isMongooseObject(b)) {\n    b = b.toObject();\n  }\n\n  try {\n    var ka = Object.keys(a),\n        kb = Object.keys(b),\n        key, i;\n  } catch (e) {\n    // happens when one is a string literal and the other isn't\n    return false;\n  }\n\n  // having the same number of owned properties (keys incorporates\n  // hasOwnProperty)\n  if (ka.length !== kb.length) {\n    return false;\n  }\n\n  // the same set of keys (although not necessarily the same order),\n  ka.sort();\n  kb.sort();\n\n  // ~~~cheap key test\n  for (i = ka.length - 1; i >= 0; i--) {\n    if (ka[i] !== kb[i]) {\n      return false;\n    }\n  }\n\n  // equivalent values for every corresponding key, and\n  // ~~~possibly expensive deep test\n  for (i = ka.length - 1; i >= 0; i--) {\n    key = ka[i];\n    if (!deepEqual(a[key], b[key])) {\n      return false;\n    }\n  }\n\n  return true;\n};\n\n/*!\n * Object clone with Mongoose natives support.\n *\n * If options.minimize is true, creates a minimal data object. Empty objects and undefined values will not be cloned. This makes the data payload sent to MongoDB as small as possible.\n *\n * Functions are never cloned.\n *\n * @param {Object} obj the object to clone\n * @param {Object} options\n * @return {Object} the cloned object\n * @api private\n */\n\nexports.clone = function clone(obj, options) {\n  if (obj === undefined || obj === null) {\n    return obj;\n  }\n\n  if (Array.isArray(obj)) {\n    return cloneArray(obj, options);\n  }\n\n  if (isMongooseObject(obj)) {\n    if (options && options.json && typeof obj.toJSON === 'function') {\n      return obj.toJSON(options);\n    }\n    return obj.toObject(options);\n  }\n\n  if (obj.constructor) {\n    switch (exports.getFunctionName(obj.constructor)) {\n      case 'Object':\n        return cloneObject(obj, options);\n      case 'Date':\n        return new obj.constructor(+obj);\n      case 'RegExp':\n        return cloneRegExp(obj);\n      default:\n        // ignore\n        break;\n    }\n  }\n\n  if (obj instanceof ObjectId) {\n    return new ObjectId(obj.id);\n  }\n\n  if (!obj.constructor && exports.isObject(obj)) {\n    // object created with Object.create(null)\n    return cloneObject(obj, options);\n  }\n\n  if (obj.valueOf) {\n    return obj.valueOf();\n  }\n};\nvar clone = exports.clone;\n\n/*!\n * ignore\n */\n\nfunction cloneObject(obj, options) {\n  var retainKeyOrder = options && options.retainKeyOrder,\n      minimize = options && options.minimize,\n      ret = {},\n      hasKeys,\n      keys,\n      val,\n      k,\n      i;\n\n  if (retainKeyOrder) {\n    for (k in obj) {\n      val = clone(obj[k], options);\n\n      if (!minimize || (typeof val !== 'undefined')) {\n        hasKeys || (hasKeys = true);\n        ret[k] = val;\n      }\n    }\n  } else {\n    // faster\n\n    keys = Object.keys(obj);\n    i = keys.length;\n\n    while (i--) {\n      k = keys[i];\n      val = clone(obj[k], options);\n\n      if (!minimize || (typeof val !== 'undefined')) {\n        if (!hasKeys) {\n          hasKeys = true;\n        }\n        ret[k] = val;\n      }\n    }\n  }\n\n  return minimize\n      ? hasKeys && ret\n      : ret;\n}\n\nfunction cloneArray(arr, options) {\n  var ret = [];\n  for (var i = 0, l = arr.length; i < l; i++) {\n    ret.push(clone(arr[i], options));\n  }\n  return ret;\n}\n\n/*!\n * Shallow copies defaults into options.\n *\n * @param {Object} defaults\n * @param {Object} options\n * @return {Object} the merged object\n * @api private\n */\n\nexports.options = function(defaults, options) {\n  var keys = Object.keys(defaults),\n      i = keys.length,\n      k;\n\n  options = options || {};\n\n  while (i--) {\n    k = keys[i];\n    if (!(k in options)) {\n      options[k] = defaults[k];\n    }\n  }\n\n  return options;\n};\n\n/*!\n * Generates a random string\n *\n * @api private\n */\n\nexports.random = function() {\n  return Math.random().toString().substr(3);\n};\n\n/*!\n * Merges `from` into `to` without overwriting existing properties.\n *\n * @param {Object} to\n * @param {Object} from\n * @api private\n */\n\nexports.merge = function merge(to, from) {\n  var keys = Object.keys(from),\n      i = keys.length,\n      key;\n\n  while (i--) {\n    key = keys[i];\n    if (typeof to[key] === 'undefined') {\n      to[key] = from[key];\n    } else if (exports.isObject(from[key])) {\n      merge(to[key], from[key]);\n    }\n  }\n};\n\n/*!\n * toString helper\n */\n\nvar toString = Object.prototype.toString;\n\n/*!\n * Applies toObject recursively.\n *\n * @param {Document|Array|Object} obj\n * @return {Object}\n * @api private\n */\n\nexports.toObject = function toObject(obj) {\n  var ret;\n\n  if (exports.isNullOrUndefined(obj)) {\n    return obj;\n  }\n\n  if (obj instanceof Document) {\n    return obj.toObject();\n  }\n\n  if (Array.isArray(obj)) {\n    ret = [];\n\n    for (var i = 0, len = obj.length; i < len; ++i) {\n      ret.push(toObject(obj[i]));\n    }\n\n    return ret;\n  }\n\n  if ((obj.constructor && exports.getFunctionName(obj.constructor) === 'Object') ||\n      (!obj.constructor && exports.isObject(obj))) {\n    ret = {};\n\n    for (var k in obj) {\n      ret[k] = toObject(obj[k]);\n    }\n\n    return ret;\n  }\n\n  return obj;\n};\n\n/*!\n * Determines if `arg` is an object.\n *\n * @param {Object|Array|String|Function|RegExp|any} arg\n * @api private\n * @return {Boolean}\n */\n\nexports.isObject = function(arg) {\n  if (Buffer.isBuffer(arg)) {\n    return true;\n  }\n  return toString.call(arg) === '[object Object]';\n};\n\n/*!\n * A faster Array.prototype.slice.call(arguments) alternative\n * @api private\n */\n\nexports.args = sliced;\n\n/*!\n * process.nextTick helper.\n *\n * Wraps `callback` in a try/catch + nextTick.\n *\n * node-mongodb-native has a habit of state corruption when an error is immediately thrown from within a collection callback.\n *\n * @param {Function} callback\n * @api private\n */\n\nexports.tick = function tick(callback) {\n  if (typeof callback !== 'function') {\n    return;\n  }\n  return function() {\n    try {\n      callback.apply(this, arguments);\n    } catch (err) {\n      // only nextTick on err to get out of\n      // the event loop and avoid state corruption.\n      process.nextTick(function() {\n        throw err;\n      });\n    }\n  };\n};\n\n/*!\n * Returns if `v` is a mongoose object that has a `toObject()` method we can use.\n *\n * This is for compatibility with libs like Date.js which do foolish things to Natives.\n *\n * @param {any} v\n * @api private\n */\n\nexports.isMongooseObject = function(v) {\n  Document || (Document = require('./document'));\n  MongooseArray || (MongooseArray = require('./types').Array);\n  MongooseBuffer || (MongooseBuffer = require('./types').Buffer);\n\n  return v instanceof Document ||\n      (v && v.isMongooseArray) ||\n      (v && v.isMongooseBuffer);\n};\nvar isMongooseObject = exports.isMongooseObject;\n\n/*!\n * Converts `expires` options of index objects to `expiresAfterSeconds` options for MongoDB.\n *\n * @param {Object} object\n * @api private\n */\n\nexports.expires = function expires(object) {\n  if (!(object && object.constructor.name === 'Object')) {\n    return;\n  }\n  if (!('expires' in object)) {\n    return;\n  }\n\n  var when;\n  if (typeof object.expires !== 'string') {\n    when = object.expires;\n  } else {\n    when = Math.round(ms(object.expires) / 1000);\n  }\n  object.expireAfterSeconds = when;\n  delete object.expires;\n};\n\n/*!\n * Populate options constructor\n */\n\nfunction PopulateOptions(path, select, match, options, model, subPopulate) {\n  this.path = path;\n  this.match = match;\n  this.select = select;\n  this.options = options;\n  this.model = model;\n  if (typeof subPopulate === 'object') {\n    this.populate = subPopulate;\n  }\n  this._docs = {};\n}\n\n// make it compatible with utils.clone\nPopulateOptions.prototype.constructor = Object;\n\n// expose\nexports.PopulateOptions = PopulateOptions;\n\n/*!\n * populate helper\n */\n\nexports.populate = function populate(path, select, model, match, options, subPopulate) {\n  // The order of select/conditions args is opposite Model.find but\n  // necessary to keep backward compatibility (select could be\n  // an array, string, or object literal).\n\n  // might have passed an object specifying all arguments\n  if (arguments.length === 1) {\n    if (path instanceof PopulateOptions) {\n      return [path];\n    }\n\n    if (Array.isArray(path)) {\n      return path.map(function(o) {\n        return exports.populate(o)[0];\n      });\n    }\n\n    if (exports.isObject(path)) {\n      match = path.match;\n      options = path.options;\n      select = path.select;\n      model = path.model;\n      subPopulate = path.populate;\n      path = path.path;\n    }\n  } else if (typeof model !== 'string' && typeof model !== 'function') {\n    options = match;\n    match = model;\n    model = undefined;\n  }\n\n  if (typeof path !== 'string') {\n    throw new TypeError('utils.populate: invalid path. Expected string. Got typeof `' + typeof path + '`');\n  }\n\n  if (typeof subPopulate === 'object') {\n    subPopulate = exports.populate(subPopulate);\n  }\n\n  var ret = [];\n  var paths = path.split(' ');\n  options = exports.clone(options, { retainKeyOrder: true });\n  for (var i = 0; i < paths.length; ++i) {\n    ret.push(new PopulateOptions(paths[i], select, match, options, model, subPopulate));\n  }\n\n  return ret;\n};\n\n/*!\n * Return the value of `obj` at the given `path`.\n *\n * @param {String} path\n * @param {Object} obj\n */\n\nexports.getValue = function(path, obj, map) {\n  return mpath.get(path, obj, '_doc', map);\n};\n\n/*!\n * Sets the value of `obj` at the given `path`.\n *\n * @param {String} path\n * @param {Anything} val\n * @param {Object} obj\n */\n\nexports.setValue = function(path, val, obj, map) {\n  mpath.set(path, val, obj, '_doc', map);\n};\n\n/*!\n * Returns an array of values from object `o`.\n *\n * @param {Object} o\n * @return {Array}\n * @private\n */\n\nexports.object = {};\nexports.object.vals = function vals(o) {\n  var keys = Object.keys(o),\n      i = keys.length,\n      ret = [];\n\n  while (i--) {\n    ret.push(o[keys[i]]);\n  }\n\n  return ret;\n};\n\n/*!\n * @see exports.options\n */\n\nexports.object.shallowCopy = exports.options;\n\n/*!\n * Safer helper for hasOwnProperty checks\n *\n * @param {Object} obj\n * @param {String} prop\n */\n\nvar hop = Object.prototype.hasOwnProperty;\nexports.object.hasOwnProperty = function(obj, prop) {\n  return hop.call(obj, prop);\n};\n\n/*!\n * Determine if `val` is null or undefined\n *\n * @return {Boolean}\n */\n\nexports.isNullOrUndefined = function(val) {\n  return val === null || val === undefined;\n};\n\n/*!\n * ignore\n */\n\nexports.array = {};\n\n/*!\n * Flattens an array.\n *\n * [ 1, [ 2, 3, [4] ]] -> [1,2,3,4]\n *\n * @param {Array} arr\n * @param {Function} [filter] If passed, will be invoked with each item in the array. If `filter` returns a falsey value, the item will not be included in the results.\n * @return {Array}\n * @private\n */\n\nexports.array.flatten = function flatten(arr, filter, ret) {\n  ret || (ret = []);\n\n  arr.forEach(function(item) {\n    if (Array.isArray(item)) {\n      flatten(item, filter, ret);\n    } else {\n      if (!filter || filter(item)) {\n        ret.push(item);\n      }\n    }\n  });\n\n  return ret;\n};\n\n/*!\n * Removes duplicate values from an array\n *\n * [1, 2, 3, 3, 5] => [1, 2, 3, 5]\n * [ ObjectId(\"550988ba0c19d57f697dc45e\"), ObjectId(\"550988ba0c19d57f697dc45e\") ]\n *    => [ObjectId(\"550988ba0c19d57f697dc45e\")]\n *\n * @param {Array} arr\n * @return {Array}\n * @private\n */\n\nexports.array.unique = function(arr) {\n  var primitives = {};\n  var ids = {};\n  var ret = [];\n  var length = arr.length;\n  for (var i = 0; i < length; ++i) {\n    if (typeof arr[i] === 'number' || typeof arr[i] === 'string') {\n      if (primitives[arr[i]]) {\n        continue;\n      }\n      ret.push(arr[i]);\n      primitives[arr[i]] = true;\n    } else if (arr[i] instanceof ObjectId) {\n      if (ids[arr[i].toString()]) {\n        continue;\n      }\n      ret.push(arr[i]);\n      ids[arr[i].toString()] = true;\n    } else {\n      ret.push(arr[i]);\n    }\n  }\n\n  return ret;\n};\n\n/*!\n * Determines if two buffers are equal.\n *\n * @param {Buffer} a\n * @param {Object} b\n */\n\nexports.buffer = {};\nexports.buffer.areEqual = function(a, b) {\n  if (!Buffer.isBuffer(a)) {\n    return false;\n  }\n  if (!Buffer.isBuffer(b)) {\n    return false;\n  }\n  if (a.length !== b.length) {\n    return false;\n  }\n  for (var i = 0, len = a.length; i < len; ++i) {\n    if (a[i] !== b[i]) {\n      return false;\n    }\n  }\n  return true;\n};\n\nexports.getFunctionName = function(fn) {\n  if (fn.name) {\n    return fn.name;\n  }\n  return (fn.toString().trim().match(/^function\\s*([^\\s(]+)/) || [])[1];\n};\n\nexports.decorate = function(destination, source) {\n  for (var key in source) {\n    destination[key] = source[key];\n  }\n};\n\n/**\n * merges to with a copy of from\n *\n * @param {Object} to\n * @param {Object} fromObj\n * @api private\n */\n\nexports.mergeClone = function(to, fromObj) {\n  var keys = Object.keys(fromObj),\n      i = keys.length,\n      key;\n\n  while (i--) {\n    key = keys[i];\n    if (typeof to[key] === 'undefined') {\n      // make sure to retain key order here because of a bug handling the $each\n      // operator in mongodb 2.4.4\n      to[key] = exports.clone(fromObj[key], {retainKeyOrder: 1});\n    } else {\n      if (exports.isObject(fromObj[key])) {\n        var obj = fromObj[key];\n        if (isMongooseObject(fromObj[key]) && !fromObj[key].isMongooseBuffer) {\n          obj = obj.toObject({ virtuals: false });\n        }\n        exports.mergeClone(to[key], obj);\n      } else {\n        // make sure to retain key order here because of a bug handling the\n        // $each operator in mongodb 2.4.4\n        to[key] = exports.clone(fromObj[key], {retainKeyOrder: 1});\n      }\n    }\n  }\n};\n\n/**\n * Executes a function on each element of an array (like _.each)\n *\n * @param {Array} arr\n * @param {Function} fn\n * @api private\n */\n\nexports.each = function(arr, fn) {\n  for (var i = 0; i < arr.length; ++i) {\n    fn(arr[i]);\n  }\n};\n"]}