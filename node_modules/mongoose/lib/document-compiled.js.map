{"version":3,"sources":["document.js"],"names":[],"mappings":"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","file":"document-compiled.js","sourcesContent":["/*!\n * Module dependencies.\n */\n\nvar EventEmitter = require('events').EventEmitter,\n    MongooseError = require('./error'),\n    MixedSchema = require('./schema/mixed'),\n    Schema = require('./schema'),\n    ObjectExpectedError = require('./error/objectExpected'),\n    StrictModeError = require('./error/strict'),\n    ValidatorError = require('./schematype').ValidatorError,\n    utils = require('./utils'),\n    clone = utils.clone,\n    isMongooseObject = utils.isMongooseObject,\n    inspect = require('util').inspect,\n    ValidationError = MongooseError.ValidationError,\n    InternalCache = require('./internal'),\n    deepEqual = utils.deepEqual,\n    hooks = require('hooks-fixed'),\n    PromiseProvider = require('./promise_provider'),\n    DocumentArray,\n    MongooseArray,\n    Embedded;\n\n/**\n * Document constructor.\n *\n * @param {Object} obj the values to set\n * @param {Object} [fields] optional object containing the fields which were selected in the query returning this document and any populated paths data\n * @param {Boolean} [skipId] bool, should we auto create an ObjectId _id\n * @inherits NodeJS EventEmitter http://nodejs.org/api/events.html#events_class_events_eventemitter\n * @event `init`: Emitted on a document after it has was retreived from the db and fully hydrated by Mongoose.\n * @event `save`: Emitted when the document is successfully saved\n * @api private\n */\n\nfunction Document(obj, fields, skipId) {\n  this.$__ = new InternalCache;\n  this.$__.emitter = new EventEmitter();\n  this.isNew = true;\n  this.errors = undefined;\n\n  var schema = this.schema;\n\n  if (typeof fields === 'boolean') {\n    this.$__.strictMode = fields;\n    fields = undefined;\n  } else {\n    this.$__.strictMode = schema.options && schema.options.strict;\n    this.$__.selected = fields;\n  }\n\n  var required = schema.requiredPaths(true);\n  for (var i = 0; i < required.length; ++i) {\n    this.$__.activePaths.require(required[i]);\n  }\n\n  this.$__.emitter.setMaxListeners(0);\n  this._doc = this.$__buildDoc(obj, fields, skipId);\n\n  if (obj) {\n    if (obj instanceof Document) {\n      this.isNew = obj.isNew;\n    }\n    this.set(obj, undefined, true);\n  }\n\n  if (!schema.options.strict && obj) {\n    var _this = this,\n        keys = Object.keys(this._doc);\n\n    keys.forEach(function(key) {\n      if (!(key in schema.tree)) {\n        defineKey(key, null, _this);\n      }\n    });\n  }\n\n  this.$__registerHooksFromSchema();\n}\n\n/*!\n * Document exposes the NodeJS event emitter API, so you can use\n * `on`, `once`, etc.\n */\nutils.each(\n    ['on', 'once', 'emit', 'listeners', 'removeListener', 'setMaxListeners',\n      'removeAllListeners', 'addListener'],\n    function(emitterFn) {\n      Document.prototype[emitterFn] = function() {\n        return this.$__.emitter[emitterFn].apply(this.$__.emitter, arguments);\n      };\n    });\n\nDocument.prototype.constructor = Document;\n\n/**\n * The documents schema.\n *\n * @api public\n * @property schema\n */\n\nDocument.prototype.schema;\n\n/**\n * Boolean flag specifying if the document is new.\n *\n * @api public\n * @property isNew\n */\n\nDocument.prototype.isNew;\n\n/**\n * The string version of this documents _id.\n *\n * ####Note:\n *\n * This getter exists on all documents by default. The getter can be disabled by setting the `id` [option](/docs/guide.html#id) of its `Schema` to false at construction time.\n *\n *     new Schema({ name: String }, { id: false });\n *\n * @api public\n * @see Schema options /docs/guide.html#options\n * @property id\n */\n\nDocument.prototype.id;\n\n/**\n * Hash containing current validation errors.\n *\n * @api public\n * @property errors\n */\n\nDocument.prototype.errors;\n\n/**\n * Builds the default doc structure\n *\n * @param {Object} obj\n * @param {Object} [fields]\n * @param {Boolean} [skipId]\n * @return {Object}\n * @api private\n * @method $__buildDoc\n * @memberOf Document\n */\n\nDocument.prototype.$__buildDoc = function(obj, fields, skipId) {\n  var doc = {};\n  var exclude = null;\n  var keys;\n  var ki;\n  var _this = this;\n\n  // determine if this doc is a result of a query with\n  // excluded fields\n\n  if (fields && utils.getFunctionName(fields.constructor) === 'Object') {\n    keys = Object.keys(fields);\n    ki = keys.length;\n\n    if (ki === 1 && keys[0] === '_id') {\n      exclude = !!fields[keys[ki]];\n    } else {\n      while (ki--) {\n        if (keys[ki] !== '_id' &&\n            (!fields[keys[ki]] || typeof fields[keys[ki]] !== 'object')) {\n          exclude = !fields[keys[ki]];\n          break;\n        }\n      }\n    }\n  }\n\n  var paths = Object.keys(this.schema.paths),\n      plen = paths.length,\n      ii = 0;\n\n  for (; ii < plen; ++ii) {\n    var p = paths[ii];\n\n    if (p === '_id') {\n      if (skipId) {\n        continue;\n      }\n      if (obj && '_id' in obj) {\n        continue;\n      }\n    }\n\n    var type = this.schema.paths[p];\n    var path = p.split('.');\n    var len = path.length;\n    var last = len - 1;\n    var curPath = '';\n    var doc_ = doc;\n    var i = 0;\n    var included = false;\n\n    for (; i < len; ++i) {\n      var piece = path[i],\n          def;\n\n      curPath += piece;\n\n      // support excluding intermediary levels\n      if (exclude === true) {\n        if (curPath in fields) {\n          break;\n        }\n      } else if (fields && curPath in fields) {\n        included = true;\n      }\n\n      if (i === last) {\n        if (fields && exclude !== null) {\n          if (exclude === true) {\n            // apply defaults to all non-excluded fields\n            if (p in fields) {\n              continue;\n            }\n\n            def = type.getDefault(_this, true);\n            if (typeof def !== 'undefined') {\n              doc_[piece] = def;\n              _this.$__.activePaths.default(p);\n            }\n          } else if (included) {\n            // selected field\n            def = type.getDefault(_this, true);\n            if (typeof def !== 'undefined') {\n              doc_[piece] = def;\n              _this.$__.activePaths.default(p);\n            }\n          }\n        } else {\n          def = type.getDefault(_this, true);\n          if (typeof def !== 'undefined') {\n            doc_[piece] = def;\n            _this.$__.activePaths.default(p);\n          }\n        }\n      } else {\n        doc_ = doc_[piece] || (doc_[piece] = {});\n        curPath += '.';\n      }\n    }\n  }\n\n  return doc;\n};\n\n/**\n * Initializes the document without setters or marking anything modified.\n *\n * Called internally after a document is returned from mongodb.\n *\n * @param {Object} doc document returned by mongo\n * @param {Function} fn callback\n * @api public\n */\n\nDocument.prototype.init = function(doc, opts, fn) {\n  // do not prefix this method with $__ since its\n  // used by public hooks\n\n  if (typeof opts === 'function') {\n    fn = opts;\n    opts = null;\n  }\n\n  this.isNew = false;\n\n  // handle docs with populated paths\n  // If doc._id is not null or undefined\n  if (doc._id !== null && doc._id !== undefined &&\n    opts && opts.populated && opts.populated.length) {\n    var id = String(doc._id);\n    for (var i = 0; i < opts.populated.length; ++i) {\n      var item = opts.populated[i];\n      this.populated(item.path, item._docs[id], item);\n    }\n  }\n\n  init(this, doc, this._doc);\n  this.$__storeShard();\n\n  this.emit('init', this);\n  if (fn) {\n    fn(null);\n  }\n  return this;\n};\n\n/*!\n * Init helper.\n *\n * @param {Object} self document instance\n * @param {Object} obj raw mongodb doc\n * @param {Object} doc object we are initializing\n * @api private\n */\n\nfunction init(self, obj, doc, prefix) {\n  prefix = prefix || '';\n\n  var keys = Object.keys(obj),\n      len = keys.length,\n      schema,\n      path,\n      i;\n\n  while (len--) {\n    i = keys[len];\n    path = prefix + i;\n    schema = self.schema.path(path);\n\n    if (!schema && utils.isObject(obj[i]) &&\n        (!obj[i].constructor || utils.getFunctionName(obj[i].constructor) === 'Object')) {\n      // assume nested object\n      if (!doc[i]) {\n        doc[i] = {};\n      }\n      init(self, obj[i], doc[i], path + '.');\n    } else {\n      if (obj[i] === null) {\n        doc[i] = null;\n      } else if (obj[i] !== undefined) {\n        if (schema) {\n          try {\n            doc[i] = schema.cast(obj[i], self, true);\n          } catch (e) {\n            self.invalidate(e.path, new ValidatorError({\n              path: e.path,\n              message: e.message,\n              type: 'cast',\n              value: e.value\n            }));\n          }\n        } else {\n          doc[i] = obj[i];\n        }\n      }\n      // mark as hydrated\n      if (!self.isModified(path)) {\n        self.$__.activePaths.init(path);\n      }\n    }\n  }\n}\n\n/**\n * Stores the current values of the shard keys.\n *\n * ####Note:\n *\n * _Shard key values do not / are not allowed to change._\n *\n * @api private\n * @method $__storeShard\n * @memberOf Document\n */\n\nDocument.prototype.$__storeShard = function() {\n  // backwards compat\n  var key = this.schema.options.shardKey || this.schema.options.shardkey;\n  if (!(key && utils.getFunctionName(key.constructor) === 'Object')) {\n    return;\n  }\n\n  var orig = this.$__.shardval = {},\n      paths = Object.keys(key),\n      len = paths.length,\n      val;\n\n  for (var i = 0; i < len; ++i) {\n    val = this.getValue(paths[i]);\n    if (isMongooseObject(val)) {\n      orig[paths[i]] = val.toObject({depopulate: true});\n    } else if (val !== null && val !== undefined && val.valueOf &&\n          // Explicitly don't take value of dates\n        (!val.constructor || utils.getFunctionName(val.constructor) !== 'Date')) {\n      orig[paths[i]] = val.valueOf();\n    } else {\n      orig[paths[i]] = val;\n    }\n  }\n};\n\n/*!\n * Set up middleware support\n */\n\nfor (var k in hooks) {\n  if (k === 'pre' || k === 'post') {\n    Document.prototype['$' + k] = Document['$' + k] = hooks[k];\n  } else {\n    Document.prototype[k] = Document[k] = hooks[k];\n  }\n}\n\n/**\n * Sends an update command with this document `_id` as the query selector.\n *\n * ####Example:\n *\n *     weirdCar.update({$inc: {wheels:1}}, { w: 1 }, callback);\n *\n * ####Valid options:\n *\n *  - same as in [Model.update](#model_Model.update)\n *\n * @see Model.update #model_Model.update\n * @param {Object} doc\n * @param {Object} options\n * @param {Function} callback\n * @return {Query}\n * @api public\n */\n\nDocument.prototype.update = function update() {\n  var args = utils.args(arguments);\n  args.unshift({_id: this._id});\n  return this.constructor.update.apply(this.constructor, args);\n};\n\n/**\n * Sets the value of a path, or many paths.\n *\n * ####Example:\n *\n *     // path, value\n *     doc.set(path, value)\n *\n *     // object\n *     doc.set({\n *         path  : value\n *       , path2 : {\n *            path  : value\n *         }\n *     })\n *\n *     // on-the-fly cast to number\n *     doc.set(path, value, Number)\n *\n *     // on-the-fly cast to string\n *     doc.set(path, value, String)\n *\n *     // changing strict mode behavior\n *     doc.set(path, value, { strict: false });\n *\n * @param {String|Object} path path or object of key/vals to set\n * @param {Any} val the value to set\n * @param {Schema|String|Number|Buffer|*} [type] optionally specify a type for \"on-the-fly\" attributes\n * @param {Object} [options] optionally specify options that modify the behavior of the set\n * @api public\n */\n\nDocument.prototype.set = function(path, val, type, options) {\n  if (type && utils.getFunctionName(type.constructor) === 'Object') {\n    options = type;\n    type = undefined;\n  }\n\n  var merge = options && options.merge,\n      adhoc = type && type !== true,\n      constructing = type === true,\n      adhocs;\n\n  var strict = options && 'strict' in options\n      ? options.strict\n      : this.$__.strictMode;\n\n  if (adhoc) {\n    adhocs = this.$__.adhocPaths || (this.$__.adhocPaths = {});\n    adhocs[path] = Schema.interpretAsType(path, type, this.schema.options);\n  }\n\n  if (typeof path !== 'string') {\n    // new Document({ key: val })\n\n    if (path === null || path === void 0) {\n      var _ = path;\n      path = val;\n      val = _;\n    } else {\n      var prefix = val\n          ? val + '.'\n          : '';\n\n      if (path instanceof Document) {\n        if (path.$__isNested) {\n          path = path.toObject();\n        } else {\n          path = path._doc;\n        }\n      }\n\n      var keys = Object.keys(path),\n          i = keys.length,\n          pathtype,\n          key;\n\n      while (i--) {\n        key = keys[i];\n        var pathName = prefix + key;\n        pathtype = this.schema.pathType(pathName);\n\n        if (path[key] !== null\n            && path[key] !== void 0\n              // need to know if plain object - no Buffer, ObjectId, ref, etc\n            && utils.isObject(path[key])\n            && (!path[key].constructor || utils.getFunctionName(path[key].constructor) === 'Object')\n            && pathtype !== 'virtual'\n            && pathtype !== 'real'\n            && !(this.$__path(pathName) instanceof MixedSchema)\n            && !(this.schema.paths[pathName] &&\n            this.schema.paths[pathName].options &&\n            this.schema.paths[pathName].options.ref)) {\n          this.set(path[key], prefix + key, constructing);\n        } else if (strict) {\n          // Don't overwrite defaults with undefined keys (gh-3981)\n          if (constructing && path[key] === void 0 &&\n              this.get(key) !== void 0) {\n            continue;\n          }\n\n          if (pathtype === 'real' || pathtype === 'virtual') {\n            // Check for setting single embedded schema to document (gh-3535)\n            if (this.schema.paths[pathName] &&\n                this.schema.paths[pathName].$isSingleNested &&\n                path[key] instanceof Document) {\n              path[key] = path[key].toObject({virtuals: false});\n            }\n            this.set(prefix + key, path[key], constructing);\n          } else if (pathtype === 'nested' && path[key] instanceof Document) {\n            this.set(prefix + key,\n                path[key].toObject({virtuals: false}), constructing);\n          } else if (strict === 'throw') {\n            if (pathtype === 'nested') {\n              throw new ObjectExpectedError(key, path[key]);\n            } else {\n              throw new StrictModeError(key);\n            }\n          }\n        } else if (path[key] !== void 0) {\n          this.set(prefix + key, path[key], constructing);\n        }\n      }\n\n      return this;\n    }\n  }\n\n  // ensure _strict is honored for obj props\n  // docschema = new Schema({ path: { nest: 'string' }})\n  // doc.set('path', obj);\n  var pathType = this.schema.pathType(path);\n  if (pathType === 'nested' && val) {\n    if (utils.isObject(val) &&\n        (!val.constructor || utils.getFunctionName(val.constructor) === 'Object')) {\n      if (!merge) {\n        this.setValue(path, null);\n      }\n      this.set(val, path, constructing);\n      return this;\n    }\n    this.invalidate(path, new MongooseError.CastError('Object', val, path));\n    return this;\n  }\n\n  var schema;\n  var parts = path.split('.');\n\n  if (pathType === 'adhocOrUndefined' && strict) {\n    // check for roots that are Mixed types\n    var mixed;\n\n    for (i = 0; i < parts.length; ++i) {\n      var subpath = parts.slice(0, i + 1).join('.');\n      schema = this.schema.path(subpath);\n      if (schema instanceof MixedSchema) {\n        // allow changes to sub paths of mixed types\n        mixed = true;\n        break;\n      }\n    }\n\n    if (!mixed) {\n      if (strict === 'throw') {\n        throw new StrictModeError(path);\n      }\n      return this;\n    }\n  } else if (pathType === 'virtual') {\n    schema = this.schema.virtualpath(path);\n    schema.applySetters(val, this);\n    return this;\n  } else {\n    schema = this.$__path(path);\n  }\n\n  var pathToMark;\n\n  // When using the $set operator the path to the field must already exist.\n  // Else mongodb throws: \"LEFT_SUBFIELD only supports Object\"\n\n  if (parts.length <= 1) {\n    pathToMark = path;\n  } else {\n    for (i = 0; i < parts.length; ++i) {\n      subpath = parts.slice(0, i + 1).join('.');\n      if (this.isDirectModified(subpath) // earlier prefixes that are already\n            // marked as dirty have precedence\n          || this.get(subpath) === null) {\n        pathToMark = subpath;\n        break;\n      }\n    }\n\n    if (!pathToMark) {\n      pathToMark = path;\n    }\n  }\n\n  // if this doc is being constructed we should not trigger getters\n  var priorVal = constructing\n      ? undefined\n      : this.getValue(path);\n\n  if (!schema) {\n    this.$__set(pathToMark, path, constructing, parts, schema, val, priorVal);\n    return this;\n  }\n\n  var shouldSet = true;\n  try {\n    // If the user is trying to set a ref path to a document with\n    // the correct model name, treat it as populated\n    var didPopulate = false;\n    if (schema.options &&\n        schema.options.ref &&\n        val instanceof Document &&\n        schema.options.ref === val.constructor.modelName) {\n      if (this.ownerDocument) {\n        this.ownerDocument().populated(this.$__fullPath(path),\n          val._id, {model: val.constructor});\n      } else {\n        this.populated(path, val._id, {model: val.constructor});\n      }\n      didPopulate = true;\n    }\n\n    var popOpts;\n    if (schema.options &&\n        Array.isArray(schema.options.type) &&\n        schema.options.type.length &&\n        schema.options.type[0].ref &&\n        Array.isArray(val) &&\n        val.length > 0 &&\n        val[0] instanceof Document &&\n        val[0].constructor.modelName &&\n        schema.options.type[0].ref === val[0].constructor.modelName) {\n      if (this.ownerDocument) {\n        popOpts = { model: val[0].constructor };\n        this.ownerDocument().populated(this.$__fullPath(path),\n          val.map(function(v) { return v._id; }), popOpts);\n      } else {\n        popOpts = { model: val[0].constructor };\n        this.populated(path, val.map(function(v) { return v._id; }), popOpts);\n      }\n      didPopulate = true;\n    }\n    val = schema.applySetters(val, this, false, priorVal);\n\n    if (!didPopulate && this.$__.populated) {\n      delete this.$__.populated[path];\n    }\n\n    this.$markValid(path);\n  } catch (e) {\n    var reason;\n    if (!(e instanceof MongooseError.CastError)) {\n      reason = e;\n    }\n    this.invalidate(path,\n        new MongooseError.CastError(schema.instance, val, path, reason));\n    shouldSet = false;\n  }\n\n  if (shouldSet) {\n    this.$__set(pathToMark, path, constructing, parts, schema, val, priorVal);\n  }\n\n  return this;\n};\n\n/**\n * Determine if we should mark this change as modified.\n *\n * @return {Boolean}\n * @api private\n * @method $__shouldModify\n * @memberOf Document\n */\n\nDocument.prototype.$__shouldModify = function(pathToMark, path, constructing, parts, schema, val, priorVal) {\n  if (this.isNew) {\n    return true;\n  }\n\n  if (undefined === val && !this.isSelected(path)) {\n    // when a path is not selected in a query, its initial\n    // value will be undefined.\n    return true;\n  }\n\n  if (undefined === val && path in this.$__.activePaths.states.default) {\n    // we're just unsetting the default value which was never saved\n    return false;\n  }\n\n  // gh-3992: if setting a populated field to a doc, don't mark modified\n  // if they have the same _id\n  if (this.populated(path) &&\n      val instanceof Document &&\n      deepEqual(val._id, priorVal)) {\n    return false;\n  }\n\n  if (!deepEqual(val, priorVal || this.get(path))) {\n    return true;\n  }\n\n  if (!constructing &&\n      val !== null &&\n      val !== undefined &&\n      path in this.$__.activePaths.states.default &&\n      deepEqual(val, schema.getDefault(this, constructing))) {\n    // a path with a default was $unset on the server\n    // and the user is setting it to the same value again\n    return true;\n  }\n  return false;\n};\n\n/**\n * Handles the actual setting of the value and marking the path modified if appropriate.\n *\n * @api private\n * @method $__set\n * @memberOf Document\n */\n\nDocument.prototype.$__set = function(pathToMark, path, constructing, parts, schema, val, priorVal) {\n  Embedded = Embedded || require('./types/embedded');\n\n  var shouldModify = this.$__shouldModify(pathToMark, path, constructing, parts,\n    schema, val, priorVal);\n  var _this = this;\n\n  if (shouldModify) {\n    this.markModified(pathToMark, val);\n\n    // handle directly setting arrays (gh-1126)\n    MongooseArray || (MongooseArray = require('./types/array'));\n    if (val && val.isMongooseArray) {\n      val._registerAtomic('$set', val);\n\n      // Small hack for gh-1638: if we're overwriting the entire array, ignore\n      // paths that were modified before the array overwrite\n      this.$__.activePaths.forEach(function(modifiedPath) {\n        if (modifiedPath.indexOf(path + '.') === 0) {\n          _this.$__.activePaths.ignore(modifiedPath);\n        }\n      });\n    }\n  }\n\n  var obj = this._doc,\n      i = 0,\n      l = parts.length;\n\n  for (; i < l; i++) {\n    var next = i + 1,\n        last = next === l;\n\n    if (last) {\n      obj[parts[i]] = val;\n    } else {\n      if (obj[parts[i]] && utils.getFunctionName(obj[parts[i]].constructor) === 'Object') {\n        obj = obj[parts[i]];\n      } else if (obj[parts[i]] && obj[parts[i]] instanceof Embedded) {\n        obj = obj[parts[i]];\n      } else if (obj[parts[i]] && obj[parts[i]].$isSingleNested) {\n        obj = obj[parts[i]];\n      } else if (obj[parts[i]] && Array.isArray(obj[parts[i]])) {\n        obj = obj[parts[i]];\n      } else {\n        obj = obj[parts[i]] = {};\n      }\n    }\n  }\n};\n\n/**\n * Gets a raw value from a path (no getters)\n *\n * @param {String} path\n * @api private\n */\n\nDocument.prototype.getValue = function(path) {\n  return utils.getValue(path, this._doc);\n};\n\n/**\n * Sets a raw value for a path (no casting, setters, transformations)\n *\n * @param {String} path\n * @param {Object} value\n * @api private\n */\n\nDocument.prototype.setValue = function(path, val) {\n  utils.setValue(path, val, this._doc);\n  return this;\n};\n\n/**\n * Returns the value of a path.\n *\n * ####Example\n *\n *     // path\n *     doc.get('age') // 47\n *\n *     // dynamic casting to a string\n *     doc.get('age', String) // \"47\"\n *\n * @param {String} path\n * @param {Schema|String|Number|Buffer|*} [type] optionally specify a type for on-the-fly attributes\n * @api public\n */\n\nDocument.prototype.get = function(path, type) {\n  var adhoc;\n  if (type) {\n    adhoc = Schema.interpretAsType(path, type, this.schema.options);\n  }\n\n  var schema = this.$__path(path) || this.schema.virtualpath(path),\n      pieces = path.split('.'),\n      obj = this._doc;\n\n  for (var i = 0, l = pieces.length; i < l; i++) {\n    obj = obj === null || obj === void 0\n        ? undefined\n        : obj[pieces[i]];\n  }\n\n  if (adhoc) {\n    obj = adhoc.cast(obj);\n  }\n\n  // Check if this path is populated - don't apply getters if it is,\n  // because otherwise its a nested object. See gh-3357\n  if (schema && !this.populated(path)) {\n    obj = schema.applyGetters(obj, this);\n  }\n\n  return obj;\n};\n\n/**\n * Returns the schematype for the given `path`.\n *\n * @param {String} path\n * @api private\n * @method $__path\n * @memberOf Document\n */\n\nDocument.prototype.$__path = function(path) {\n  var adhocs = this.$__.adhocPaths,\n      adhocType = adhocs && adhocs[path];\n\n  if (adhocType) {\n    return adhocType;\n  }\n  return this.schema.path(path);\n};\n\n/**\n * Marks the path as having pending changes to write to the db.\n *\n * _Very helpful when using [Mixed](./schematypes.html#mixed) types._\n *\n * ####Example:\n *\n *     doc.mixed.type = 'changed';\n *     doc.markModified('mixed.type');\n *     doc.save() // changes to mixed.type are now persisted\n *\n * @param {String} path the path to mark modified\n * @api public\n */\n\nDocument.prototype.markModified = function(path) {\n  this.$__.activePaths.modify(path);\n};\n\n/**\n * Returns the list of paths that have been modified.\n *\n * @return {Array}\n * @api public\n */\n\nDocument.prototype.modifiedPaths = function() {\n  var directModifiedPaths = Object.keys(this.$__.activePaths.states.modify);\n\n  return directModifiedPaths.reduce(function(list, path) {\n    var parts = path.split('.');\n    return list.concat(parts.reduce(function(chains, part, i) {\n      return chains.concat(parts.slice(0, i).concat(part).join('.'));\n    }, []));\n  }, []);\n};\n\n/**\n * Returns true if this document was modified, else false.\n *\n * If `path` is given, checks if a path or any full path containing `path` as part of its path chain has been modified.\n *\n * ####Example\n *\n *     doc.set('documents.0.title', 'changed');\n *     doc.isModified()                    // true\n *     doc.isModified('documents')         // true\n *     doc.isModified('documents.0.title') // true\n *     doc.isDirectModified('documents')   // false\n *\n * @param {String} [path] optional\n * @return {Boolean}\n * @api public\n */\n\nDocument.prototype.isModified = function(path) {\n  return path\n      ? !!~this.modifiedPaths().indexOf(path)\n      : this.$__.activePaths.some('modify');\n};\n\n/**\n * Checks if a path is set to its default.\n *\n * ####Example\n *\n *     MyModel = mongoose.model('test', { name: { type: String, default: 'Val '} });\n *     var m = new MyModel();\n *     m.$isDefault('name');               // true\n *\n * @param {String} [path]\n * @return {Boolean}\n * @method $isDefault\n * @api public\n */\n\nDocument.prototype.$isDefault = function(path) {\n  return (path in this.$__.activePaths.states.default);\n};\n\n/**\n * Returns true if `path` was directly set and modified, else false.\n *\n * ####Example\n *\n *     doc.set('documents.0.title', 'changed');\n *     doc.isDirectModified('documents.0.title') // true\n *     doc.isDirectModified('documents') // false\n *\n * @param {String} path\n * @return {Boolean}\n * @api public\n */\n\nDocument.prototype.isDirectModified = function(path) {\n  return (path in this.$__.activePaths.states.modify);\n};\n\n/**\n * Checks if `path` was initialized.\n *\n * @param {String} path\n * @return {Boolean}\n * @api public\n */\n\nDocument.prototype.isInit = function(path) {\n  return (path in this.$__.activePaths.states.init);\n};\n\n/**\n * Checks if `path` was selected in the source query which initialized this document.\n *\n * ####Example\n *\n *     Thing.findOne().select('name').exec(function (err, doc) {\n *        doc.isSelected('name') // true\n *        doc.isSelected('age')  // false\n *     })\n *\n * @param {String} path\n * @return {Boolean}\n * @api public\n */\n\nDocument.prototype.isSelected = function isSelected(path) {\n  if (this.$__.selected) {\n    if (path === '_id') {\n      return this.$__.selected._id !== 0;\n    }\n\n    var paths = Object.keys(this.$__.selected),\n        i = paths.length,\n        inclusive = false,\n        cur;\n\n    if (i === 1 && paths[0] === '_id') {\n      // only _id was selected.\n      return this.$__.selected._id === 0;\n    }\n\n    while (i--) {\n      cur = paths[i];\n      if (cur === '_id') {\n        continue;\n      }\n      inclusive = !!this.$__.selected[cur];\n      break;\n    }\n\n    if (path in this.$__.selected) {\n      return inclusive;\n    }\n\n    i = paths.length;\n    var pathDot = path + '.';\n\n    while (i--) {\n      cur = paths[i];\n      if (cur === '_id') {\n        continue;\n      }\n\n      if (cur.indexOf(pathDot) === 0) {\n        return inclusive;\n      }\n\n      if (pathDot.indexOf(cur + '.') === 0) {\n        return inclusive;\n      }\n    }\n\n    return !inclusive;\n  }\n\n  return true;\n};\n\n/**\n * Executes registered validation rules for this document.\n *\n * ####Note:\n *\n * This method is called `pre` save and if a validation rule is violated, [save](#model_Model-save) is aborted and the error is returned to your `callback`.\n *\n * ####Example:\n *\n *     doc.validate(function (err) {\n *       if (err) handleError(err);\n *       else // validation passed\n *     });\n *\n * @param {Object} optional options internal options\n * @param {Function} optional callback called after validation completes, passing an error if one occurred\n * @return {Promise} Promise\n * @api public\n */\n\nDocument.prototype.validate = function(options, callback) {\n  var _this = this;\n  var Promise = PromiseProvider.get();\n  if (typeof options === 'function') {\n    callback = options;\n    options = null;\n  }\n\n  if (options && options.__noPromise) {\n    this.$__validate(callback);\n    return;\n  }\n\n  return new Promise.ES6(function(resolve, reject) {\n    _this.$__validate(function(error) {\n      callback && callback(error);\n      if (error) {\n        reject(error);\n        return;\n      }\n      resolve();\n    });\n  });\n};\n\n/*!\n * ignore\n */\n\nDocument.prototype.$__validate = function(callback) {\n  var _this = this;\n  var _complete = function() {\n    var err = _this.$__.validationError;\n    _this.$__.validationError = undefined;\n    _this.emit('validate', _this);\n    if (err) {\n      for (var key in err.errors) {\n        // Make sure cast errors persist\n        if (!_this.__parent && err.errors[key] instanceof MongooseError.CastError) {\n          _this.invalidate(key, err.errors[key]);\n        }\n      }\n\n      return err;\n    }\n  };\n\n  // only validate required fields when necessary\n  var paths = Object.keys(this.$__.activePaths.states.require).filter(function(path) {\n    if (!_this.isSelected(path) && !_this.isModified(path)) {\n      return false;\n    }\n    return true;\n  });\n\n  paths = paths.concat(Object.keys(this.$__.activePaths.states.init));\n  paths = paths.concat(Object.keys(this.$__.activePaths.states.modify));\n  paths = paths.concat(Object.keys(this.$__.activePaths.states.default));\n\n  if (paths.length === 0) {\n    process.nextTick(function() {\n      var err = _complete();\n      if (err) {\n        callback(err);\n        return;\n      }\n      callback();\n    });\n  }\n\n  var validating = {},\n      total = 0;\n\n  // gh-661: if a whole array is modified, make sure to run validation on all\n  // the children as well\n  for (var i = 0; i < paths.length; ++i) {\n    var path = paths[i];\n    var val = _this.getValue(path);\n    if (val && val.isMongooseArray && !Buffer.isBuffer(val) && !val.isMongooseDocumentArray) {\n      var numElements = val.length;\n      for (var j = 0; j < numElements; ++j) {\n        paths.push(path + '.' + j);\n      }\n    }\n  }\n\n  var complete = function() {\n    var err = _complete();\n    if (err) {\n      callback(err);\n      return;\n    }\n    callback();\n  };\n\n  var validatePath = function(path) {\n    if (validating[path]) {\n      return;\n    }\n\n    validating[path] = true;\n    total++;\n\n    process.nextTick(function() {\n      var p = _this.schema.path(path);\n      if (!p) {\n        return --total || complete();\n      }\n\n      // If user marked as invalid or there was a cast error, don't validate\n      if (!_this.$isValid(path)) {\n        --total || complete();\n        return;\n      }\n\n      var val = _this.getValue(path);\n      p.doValidate(val, function(err) {\n        if (err) {\n          _this.invalidate(path, err, undefined, true);\n        }\n        --total || complete();\n      }, _this);\n    });\n  };\n\n  paths.forEach(validatePath);\n};\n\n/**\n * Executes registered validation rules (skipping asynchronous validators) for this document.\n *\n * ####Note:\n *\n * This method is useful if you need synchronous validation.\n *\n * ####Example:\n *\n *     var err = doc.validateSync();\n *     if ( err ){\n *       handleError( err );\n *     } else {\n *       // validation passed\n *     }\n *\n * @param {Array|string} pathsToValidate only validate the given paths\n * @return {MongooseError|undefined} MongooseError if there are errors during validation, or undefined if there is no error.\n * @api public\n */\n\nDocument.prototype.validateSync = function(pathsToValidate) {\n  var _this = this;\n\n  if (typeof pathsToValidate === 'string') {\n    pathsToValidate = pathsToValidate.split(' ');\n  }\n\n  // only validate required fields when necessary\n  var paths = Object.keys(this.$__.activePaths.states.require).filter(function(path) {\n    if (!_this.isSelected(path) && !_this.isModified(path)) {\n      return false;\n    }\n    return true;\n  });\n\n  paths = paths.concat(Object.keys(this.$__.activePaths.states.init));\n  paths = paths.concat(Object.keys(this.$__.activePaths.states.modify));\n  paths = paths.concat(Object.keys(this.$__.activePaths.states.default));\n\n  if (pathsToValidate && pathsToValidate.length) {\n    var tmp = [];\n    for (var i = 0; i < paths.length; ++i) {\n      if (pathsToValidate.indexOf(paths[i]) !== -1) {\n        tmp.push(paths[i]);\n      }\n    }\n    paths = tmp;\n  }\n\n  var validating = {};\n\n  paths.forEach(function(path) {\n    if (validating[path]) {\n      return;\n    }\n\n    validating[path] = true;\n\n    var p = _this.schema.path(path);\n    if (!p) {\n      return;\n    }\n    if (!_this.$isValid(path)) {\n      return;\n    }\n\n    var val = _this.getValue(path);\n    var err = p.doValidateSync(val, _this);\n    if (err) {\n      _this.invalidate(path, err, undefined, true);\n    }\n  });\n\n  var err = _this.$__.validationError;\n  _this.$__.validationError = undefined;\n  _this.emit('validate', _this);\n\n  if (err) {\n    for (var key in err.errors) {\n      // Make sure cast errors persist\n      if (err.errors[key] instanceof MongooseError.CastError) {\n        _this.invalidate(key, err.errors[key]);\n      }\n    }\n  }\n\n  return err;\n};\n\n/**\n * Marks a path as invalid, causing validation to fail.\n *\n * The `errorMsg` argument will become the message of the `ValidationError`.\n *\n * The `value` argument (if passed) will be available through the `ValidationError.value` property.\n *\n *     doc.invalidate('size', 'must be less than 20', 14);\n\n *     doc.validate(function (err) {\n *       console.log(err)\n *       // prints\n *       { message: 'Validation failed',\n *         name: 'ValidationError',\n *         errors:\n *          { size:\n *             { message: 'must be less than 20',\n *               name: 'ValidatorError',\n *               path: 'size',\n *               type: 'user defined',\n *               value: 14 } } }\n *     })\n *\n * @param {String} path the field to invalidate\n * @param {String|Error} errorMsg the error which states the reason `path` was invalid\n * @param {Object|String|Number|any} value optional invalid value\n * @param {String} [kind] optional `kind` property for the error\n * @return {ValidationError} the current ValidationError, with all currently invalidated paths\n * @api public\n */\n\nDocument.prototype.invalidate = function(path, err, val, kind) {\n  if (!this.$__.validationError) {\n    this.$__.validationError = new ValidationError(this);\n  }\n\n  if (this.$__.validationError.errors[path]) {\n    return;\n  }\n\n  if (!err || typeof err === 'string') {\n    err = new ValidatorError({\n      path: path,\n      message: err,\n      type: kind || 'user defined',\n      value: val\n    });\n  }\n\n  if (this.$__.validationError === err) {\n    return this.$__.validationError;\n  }\n\n  this.$__.validationError.errors[path] = err;\n  return this.$__.validationError;\n};\n\n/**\n * Marks a path as valid, removing existing validation errors.\n *\n * @param {String} path the field to mark as valid\n * @api private\n * @method $markValid\n * @receiver Document\n */\n\nDocument.prototype.$markValid = function(path) {\n  if (!this.$__.validationError || !this.$__.validationError.errors[path]) {\n    return;\n  }\n\n  delete this.$__.validationError.errors[path];\n  if (Object.keys(this.$__.validationError.errors).length === 0) {\n    this.$__.validationError = null;\n  }\n};\n\n/**\n * Checks if a path is invalid\n *\n * @param {String} path the field to check\n * @method $isValid\n * @api private\n * @receiver Document\n */\n\nDocument.prototype.$isValid = function(path) {\n  return !this.$__.validationError || !this.$__.validationError.errors[path];\n};\n\n/**\n * Resets the internal modified state of this document.\n *\n * @api private\n * @return {Document}\n * @method $__reset\n * @memberOf Document\n */\n\nDocument.prototype.$__reset = function reset() {\n  var _this = this;\n  DocumentArray || (DocumentArray = require('./types/documentarray'));\n\n  this.$__.activePaths\n  .map('init', 'modify', function(i) {\n    return _this.getValue(i);\n  })\n  .filter(function(val) {\n    return val && val instanceof Array && val.isMongooseDocumentArray && val.length;\n  })\n  .forEach(function(array) {\n    var i = array.length;\n    while (i--) {\n      var doc = array[i];\n      if (!doc) {\n        continue;\n      }\n      doc.$__reset();\n    }\n  });\n\n  // clear atomics\n  this.$__dirty().forEach(function(dirt) {\n    var type = dirt.value;\n    if (type && type._atomics) {\n      type._atomics = {};\n    }\n  });\n\n  // Clear 'dirty' cache\n  this.$__.activePaths.clear('modify');\n  this.$__.activePaths.clear('default');\n  this.$__.validationError = undefined;\n  this.errors = undefined;\n  _this = this;\n  this.schema.requiredPaths().forEach(function(path) {\n    _this.$__.activePaths.require(path);\n  });\n\n  return this;\n};\n\n/**\n * Returns this documents dirty paths / vals.\n *\n * @api private\n * @method $__dirty\n * @memberOf Document\n */\n\nDocument.prototype.$__dirty = function() {\n  var _this = this;\n\n  var all = this.$__.activePaths.map('modify', function(path) {\n    return {\n      path: path,\n      value: _this.getValue(path),\n      schema: _this.$__path(path)\n    };\n  });\n\n  // gh-2558: if we had to set a default and the value is not undefined,\n  // we have to save as well\n  all = all.concat(this.$__.activePaths.map('default', function(path) {\n    if (path === '_id' || !_this.getValue(path)) {\n      return;\n    }\n    return {\n      path: path,\n      value: _this.getValue(path),\n      schema: _this.$__path(path)\n    };\n  }));\n\n  // Sort dirty paths in a flat hierarchy.\n  all.sort(function(a, b) {\n    return (a.path < b.path ? -1 : (a.path > b.path ? 1 : 0));\n  });\n\n  // Ignore \"foo.a\" if \"foo\" is dirty already.\n  var minimal = [],\n      lastPath,\n      top;\n\n  all.forEach(function(item) {\n    if (!item) {\n      return;\n    }\n    if (item.path.indexOf(lastPath) !== 0) {\n      lastPath = item.path + '.';\n      minimal.push(item);\n      top = item;\n    } else {\n      // special case for top level MongooseArrays\n      if (top.value && top.value._atomics && top.value.hasAtomics()) {\n        // the `top` array itself and a sub path of `top` are being modified.\n        // the only way to honor all of both modifications is through a $set\n        // of entire array.\n        top.value._atomics = {};\n        top.value._atomics.$set = top.value;\n      }\n    }\n  });\n\n  top = lastPath = null;\n  return minimal;\n};\n\n/*!\n * Compiles schemas.\n */\n\nfunction compile(tree, proto, prefix, options) {\n  var keys = Object.keys(tree),\n      i = keys.length,\n      limb,\n      key;\n\n  while (i--) {\n    key = keys[i];\n    limb = tree[key];\n\n    defineKey(key,\n        ((utils.getFunctionName(limb.constructor) === 'Object'\n        && Object.keys(limb).length)\n        && (!limb[options.typeKey] || (options.typeKey === 'type' && limb.type.type))\n            ? limb\n            : null)\n        , proto\n        , prefix\n        , keys\n        , options);\n  }\n}\n\n// gets descriptors for all properties of `object`\n// makes all properties non-enumerable to match previous behavior to #2211\nfunction getOwnPropertyDescriptors(object) {\n  var result = {};\n\n  Object.getOwnPropertyNames(object).forEach(function(key) {\n    result[key] = Object.getOwnPropertyDescriptor(object, key);\n    result[key].enumerable = true;\n  });\n\n  return result;\n}\n\n/*!\n * Defines the accessor named prop on the incoming prototype.\n */\n\nfunction defineKey(prop, subprops, prototype, prefix, keys, options) {\n  var path = (prefix ? prefix + '.' : '') + prop;\n  prefix = prefix || '';\n\n  if (subprops) {\n    Object.defineProperty(prototype, prop, {\n      enumerable: true,\n      configurable: true,\n      get: function() {\n        var _this = this;\n        if (!this.$__.getters) {\n          this.$__.getters = {};\n        }\n\n        if (!this.$__.getters[path]) {\n          var nested = Object.create(Object.getPrototypeOf(this), getOwnPropertyDescriptors(this));\n\n          // save scope for nested getters/setters\n          if (!prefix) {\n            nested.$__.scope = this;\n          }\n\n          // shadow inherited getters from sub-objects so\n          // thing.nested.nested.nested... doesn't occur (gh-366)\n          var i = 0,\n              len = keys.length;\n\n          for (; i < len; ++i) {\n            // over-write the parents getter without triggering it\n            Object.defineProperty(nested, keys[i], {\n              enumerable: false,    // It doesn't show up.\n              writable: true,       // We can set it later.\n              configurable: true,   // We can Object.defineProperty again.\n              value: undefined      // It shadows its parent.\n            });\n          }\n\n          Object.defineProperty(nested, 'toObject', {\n            enumerable: true,\n            configurable: true,\n            writable: false,\n            value: function() {\n              return _this.get(path);\n            }\n          });\n\n          Object.defineProperty(nested, 'toJSON', {\n            enumerable: true,\n            configurable: true,\n            writable: false,\n            value: function() {\n              return _this.get(path);\n            }\n          });\n\n          Object.defineProperty(nested, '$__isNested', {\n            enumerable: true,\n            configurable: true,\n            writable: false,\n            value: true\n          });\n\n          compile(subprops, nested, path, options);\n          this.$__.getters[path] = nested;\n        }\n\n        return this.$__.getters[path];\n      },\n      set: function(v) {\n        if (v instanceof Document) {\n          v = v.toObject();\n        }\n        return (this.$__.scope || this).set(path, v);\n      }\n    });\n  } else {\n    Object.defineProperty(prototype, prop, {\n      enumerable: true,\n      configurable: true,\n      get: function() {\n        return this.get.call(this.$__.scope || this, path);\n      },\n      set: function(v) {\n        return this.set.call(this.$__.scope || this, path, v);\n      }\n    });\n  }\n}\n\n/**\n * Assigns/compiles `schema` into this documents prototype.\n *\n * @param {Schema} schema\n * @api private\n * @method $__setSchema\n * @memberOf Document\n */\n\nDocument.prototype.$__setSchema = function(schema) {\n  compile(schema.tree, this, undefined, schema.options);\n  this.schema = schema;\n};\n\n\n/**\n * Get active path that were changed and are arrays\n *\n * @api private\n * @method $__getArrayPathsToValidate\n * @memberOf Document\n */\n\nDocument.prototype.$__getArrayPathsToValidate = function() {\n  DocumentArray || (DocumentArray = require('./types/documentarray'));\n\n  // validate all document arrays.\n  return this.$__.activePaths\n  .map('init', 'modify', function(i) {\n    return this.getValue(i);\n  }.bind(this))\n  .filter(function(val) {\n    return val && val instanceof Array && val.isMongooseDocumentArray && val.length;\n  }).reduce(function(seed, array) {\n    return seed.concat(array);\n  }, [])\n  .filter(function(doc) {\n    return doc;\n  });\n};\n\n\n/**\n * Get all subdocs (by bfs)\n *\n * @api private\n * @method $__getAllSubdocs\n * @memberOf Document\n */\n\nDocument.prototype.$__getAllSubdocs = function() {\n  DocumentArray || (DocumentArray = require('./types/documentarray'));\n  Embedded = Embedded || require('./types/embedded');\n\n  function docReducer(seed, path) {\n    var val = this[path];\n\n    if (val instanceof Embedded) {\n      seed.push(val);\n    }\n    if (val && val.$isSingleNested) {\n      seed = Object.keys(val._doc).reduce(docReducer.bind(val._doc), seed);\n      seed.push(val);\n    }\n    if (val && val.isMongooseDocumentArray) {\n      val.forEach(function _docReduce(doc) {\n        if (!doc || !doc._doc) {\n          return;\n        }\n        if (doc instanceof Embedded) {\n          seed.push(doc);\n        }\n        seed = Object.keys(doc._doc).reduce(docReducer.bind(doc._doc), seed);\n      });\n    } else if (val instanceof Document && val.$__isNested) {\n      val = val.toObject();\n      if (val) {\n        seed = Object.keys(val).reduce(docReducer.bind(val), seed);\n      }\n    }\n    return seed;\n  }\n\n  var subDocs = Object.keys(this._doc).reduce(docReducer.bind(this), []);\n\n  return subDocs;\n};\n\n/**\n * Executes methods queued from the Schema definition\n *\n * @api private\n * @method $__registerHooksFromSchema\n * @memberOf Document\n */\n\nDocument.prototype.$__registerHooksFromSchema = function() {\n  Embedded = Embedded || require('./types/embedded');\n  var Promise = PromiseProvider.get();\n\n  var _this = this;\n  var q = _this.schema && _this.schema.callQueue;\n  if (!q.length) {\n    return _this;\n  }\n\n  // we are only interested in 'pre' hooks, and group by point-cut\n  var toWrap = q.reduce(function(seed, pair) {\n    if (pair[0] !== 'pre' && pair[0] !== 'post' && pair[0] !== 'on') {\n      _this[pair[0]].apply(_this, pair[1]);\n      return seed;\n    }\n    var args = [].slice.call(pair[1]);\n    var pointCut = pair[0] === 'on' ? 'post' : args[0];\n    if (!(pointCut in seed)) {\n      seed[pointCut] = {post: [], pre: []};\n    }\n    if (pair[0] === 'post') {\n      seed[pointCut].post.push(args);\n    } else if (pair[0] === 'on') {\n      seed[pointCut].push(args);\n    } else {\n      seed[pointCut].pre.push(args);\n    }\n    return seed;\n  }, {post: []});\n\n  // 'post' hooks are simpler\n  toWrap.post.forEach(function(args) {\n    _this.on.apply(_this, args);\n  });\n  delete toWrap.post;\n\n  // 'init' should be synchronous on subdocuments\n  if (toWrap.init && _this instanceof Embedded) {\n    if (toWrap.init.pre) {\n      toWrap.init.pre.forEach(function(args) {\n        _this.$pre.apply(_this, args);\n      });\n    }\n    if (toWrap.init.post) {\n      toWrap.init.post.forEach(function(args) {\n        _this.$post.apply(_this, args);\n      });\n    }\n    delete toWrap.init;\n  } else if (toWrap.set) {\n    // Set hooks also need to be sync re: gh-3479\n    if (toWrap.set.pre) {\n      toWrap.set.pre.forEach(function(args) {\n        _this.$pre.apply(_this, args);\n      });\n    }\n    if (toWrap.set.post) {\n      toWrap.set.post.forEach(function(args) {\n        _this.$post.apply(_this, args);\n      });\n    }\n    delete toWrap.set;\n  }\n\n  Object.keys(toWrap).forEach(function(pointCut) {\n    // this is so we can wrap everything into a promise;\n    var newName = ('$__original_' + pointCut);\n    if (!_this[pointCut]) {\n      return;\n    }\n    _this[newName] = _this[pointCut];\n    _this[pointCut] = function wrappedPointCut() {\n      var args = [].slice.call(arguments);\n      var lastArg = args.pop();\n      var fn;\n\n      return new Promise.ES6(function(resolve, reject) {\n        if (lastArg && typeof lastArg !== 'function') {\n          args.push(lastArg);\n        } else {\n          fn = lastArg;\n        }\n        args.push(function(error, result) {\n          if (error) {\n            _this.$__handleReject(error);\n            fn && fn(error);\n            reject(error);\n            return;\n          }\n\n          fn && fn.apply(null, [null].concat(Array.prototype.slice.call(arguments, 1)));\n          resolve(result);\n        });\n\n        _this[newName].apply(_this, args);\n      });\n    };\n\n    toWrap[pointCut].pre.forEach(function(args) {\n      args[0] = newName;\n      _this.$pre.apply(_this, args);\n    });\n    toWrap[pointCut].post.forEach(function(args) {\n      args[0] = newName;\n      _this.$post.apply(_this, args);\n    });\n  });\n  return _this;\n};\n\nDocument.prototype.$__handleReject = function handleReject(err) {\n  // emit on the Model if listening\n  if (this.listeners('error').length) {\n    this.emit('error', err);\n  } else if (this.constructor.listeners && this.constructor.listeners('error').length) {\n    this.constructor.emit('error', err);\n  } else if (this.listeners && this.listeners('error').length) {\n    this.emit('error', err);\n  }\n};\n\n/**\n * Internal helper for toObject() and toJSON() that doesn't manipulate options\n *\n * @api private\n * @method $toObject\n * @memberOf Document\n */\n\nDocument.prototype.$toObject = function(options, json) {\n  var defaultOptions = {transform: true, json: json};\n\n  if (options && options.depopulate && !options._skipDepopulateTopLevel && this.$__.wasPopulated) {\n    // populated paths that we set to a document\n    return clone(this._id, options);\n  }\n\n  // If we're calling toObject on a populated doc, we may want to skip\n  // depopulated on the top level\n  if (options && options._skipDepopulateTopLevel) {\n    options._skipDepopulateTopLevel = false;\n  }\n\n  // When internally saving this document we always pass options,\n  // bypassing the custom schema options.\n  if (!(options && utils.getFunctionName(options.constructor) === 'Object') ||\n      (options && options._useSchemaOptions)) {\n    if (json) {\n      options = this.schema.options.toJSON ?\n        clone(this.schema.options.toJSON) :\n        {};\n      options.json = true;\n      options._useSchemaOptions = true;\n    } else {\n      options = this.schema.options.toObject ?\n        clone(this.schema.options.toObject) :\n        {};\n      options.json = false;\n      options._useSchemaOptions = true;\n    }\n  }\n\n  for (var key in defaultOptions) {\n    if (options[key] === undefined) {\n      options[key] = defaultOptions[key];\n    }\n  }\n\n  ('minimize' in options) || (options.minimize = this.schema.options.minimize);\n\n  // remember the root transform function\n  // to save it from being overwritten by sub-transform functions\n  var originalTransform = options.transform;\n\n  var ret = clone(this._doc, options) || {};\n\n  if (options.getters) {\n    applyGetters(this, ret, 'paths', options);\n    // applyGetters for paths will add nested empty objects;\n    // if minimize is set, we need to remove them.\n    if (options.minimize) {\n      ret = minimize(ret) || {};\n    }\n  }\n\n  if (options.virtuals || options.getters && options.virtuals !== false) {\n    applyGetters(this, ret, 'virtuals', options);\n  }\n\n  if (options.versionKey === false && this.schema.options.versionKey) {\n    delete ret[this.schema.options.versionKey];\n  }\n\n  var transform = options.transform;\n\n  // In the case where a subdocument has its own transform function, we need to\n  // check and see if the parent has a transform (options.transform) and if the\n  // child schema has a transform (this.schema.options.toObject) In this case,\n  // we need to adjust options.transform to be the child schema's transform and\n  // not the parent schema's\n  if (transform === true ||\n      (this.schema.options.toObject && transform)) {\n    var opts = options.json ? this.schema.options.toJSON : this.schema.options.toObject;\n\n    if (opts) {\n      transform = (typeof options.transform === 'function' ? options.transform : opts.transform);\n    }\n  } else {\n    options.transform = originalTransform;\n  }\n\n  if (typeof transform === 'function') {\n    var xformed = transform(this, ret, options);\n    if (typeof xformed !== 'undefined') {\n      ret = xformed;\n    }\n  }\n\n  return ret;\n};\n\n/**\n * Converts this document into a plain javascript object, ready for storage in MongoDB.\n *\n * Buffers are converted to instances of [mongodb.Binary](http://mongodb.github.com/node-mongodb-native/api-bson-generated/binary.html) for proper storage.\n *\n * ####Options:\n *\n * - `getters` apply all getters (path and virtual getters)\n * - `virtuals` apply virtual getters (can override `getters` option)\n * - `minimize` remove empty objects (defaults to true)\n * - `transform` a transform function to apply to the resulting document before returning\n * - `depopulate` depopulate any populated paths, replacing them with their original refs (defaults to false)\n * - `versionKey` whether to include the version key (defaults to true)\n * - `retainKeyOrder` keep the order of object keys. If this is set to true, `Object.keys(new Doc({ a: 1, b: 2}).toObject())` will always produce `['a', 'b']` (defaults to false)\n *\n * ####Getters/Virtuals\n *\n * Example of only applying path getters\n *\n *     doc.toObject({ getters: true, virtuals: false })\n *\n * Example of only applying virtual getters\n *\n *     doc.toObject({ virtuals: true })\n *\n * Example of applying both path and virtual getters\n *\n *     doc.toObject({ getters: true })\n *\n * To apply these options to every document of your schema by default, set your [schemas](#schema_Schema) `toObject` option to the same argument.\n *\n *     schema.set('toObject', { virtuals: true })\n *\n * ####Transform\n *\n * We may need to perform a transformation of the resulting object based on some criteria, say to remove some sensitive information or return a custom object. In this case we set the optional `transform` function.\n *\n * Transform functions receive three arguments\n *\n *     function (doc, ret, options) {}\n *\n * - `doc` The mongoose document which is being converted\n * - `ret` The plain object representation which has been converted\n * - `options` The options in use (either schema options or the options passed inline)\n *\n * ####Example\n *\n *     // specify the transform schema option\n *     if (!schema.options.toObject) schema.options.toObject = {};\n *     schema.options.toObject.transform = function (doc, ret, options) {\n *       // remove the _id of every document before returning the result\n *       delete ret._id;\n *     }\n *\n *     // without the transformation in the schema\n *     doc.toObject(); // { _id: 'anId', name: 'Wreck-it Ralph' }\n *\n *     // with the transformation\n *     doc.toObject(); // { name: 'Wreck-it Ralph' }\n *\n * With transformations we can do a lot more than remove properties. We can even return completely new customized objects:\n *\n *     if (!schema.options.toObject) schema.options.toObject = {};\n *     schema.options.toObject.transform = function (doc, ret, options) {\n *       return { movie: ret.name }\n *     }\n *\n *     // without the transformation in the schema\n *     doc.toObject(); // { _id: 'anId', name: 'Wreck-it Ralph' }\n *\n *     // with the transformation\n *     doc.toObject(); // { movie: 'Wreck-it Ralph' }\n *\n * _Note: if a transform function returns `undefined`, the return value will be ignored._\n *\n * Transformations may also be applied inline, overridding any transform set in the options:\n *\n *     function xform (doc, ret, options) {\n *       return { inline: ret.name, custom: true }\n *     }\n *\n *     // pass the transform as an inline option\n *     doc.toObject({ transform: xform }); // { inline: 'Wreck-it Ralph', custom: true }\n *\n * _Note: if you call `toObject` and pass any options, the transform declared in your schema options will __not__ be applied. To force its application pass `transform: true`_\n *\n *     if (!schema.options.toObject) schema.options.toObject = {};\n *     schema.options.toObject.hide = '_id';\n *     schema.options.toObject.transform = function (doc, ret, options) {\n *       if (options.hide) {\n *         options.hide.split(' ').forEach(function (prop) {\n *           delete ret[prop];\n *         });\n *       }\n *     }\n *\n *     var doc = new Doc({ _id: 'anId', secret: 47, name: 'Wreck-it Ralph' });\n *     doc.toObject();                                        // { secret: 47, name: 'Wreck-it Ralph' }\n *     doc.toObject({ hide: 'secret _id' });                  // { _id: 'anId', secret: 47, name: 'Wreck-it Ralph' }\n *     doc.toObject({ hide: 'secret _id', transform: true }); // { name: 'Wreck-it Ralph' }\n *\n * Transforms are applied _only to the document and are not applied to sub-documents_.\n *\n * Transforms, like all of these options, are also available for `toJSON`.\n *\n * See [schema options](/docs/guide.html#toObject) for some more details.\n *\n * _During save, no custom options are applied to the document before being sent to the database._\n *\n * @param {Object} [options]\n * @return {Object} js object\n * @see mongodb.Binary http://mongodb.github.com/node-mongodb-native/api-bson-generated/binary.html\n * @api public\n */\n\nDocument.prototype.toObject = function(options) {\n  return this.$toObject(options);\n};\n\n/*!\n * Minimizes an object, removing undefined values and empty objects\n *\n * @param {Object} object to minimize\n * @return {Object}\n */\n\nfunction minimize(obj) {\n  var keys = Object.keys(obj),\n      i = keys.length,\n      hasKeys,\n      key,\n      val;\n\n  while (i--) {\n    key = keys[i];\n    val = obj[key];\n\n    if (utils.isObject(val)) {\n      obj[key] = minimize(val);\n    }\n\n    if (undefined === obj[key]) {\n      delete obj[key];\n      continue;\n    }\n\n    hasKeys = true;\n  }\n\n  return hasKeys\n      ? obj\n      : undefined;\n}\n\n/*!\n * Applies virtuals properties to `json`.\n *\n * @param {Document} self\n * @param {Object} json\n * @param {String} type either `virtuals` or `paths`\n * @return {Object} `json`\n */\n\nfunction applyGetters(self, json, type, options) {\n  var schema = self.schema,\n      paths = Object.keys(schema[type]),\n      i = paths.length,\n      path;\n\n  while (i--) {\n    path = paths[i];\n\n    var parts = path.split('.'),\n        plen = parts.length,\n        last = plen - 1,\n        branch = json,\n        part;\n\n    for (var ii = 0; ii < plen; ++ii) {\n      part = parts[ii];\n      if (ii === last) {\n        branch[part] = clone(self.get(path), options);\n      } else {\n        branch = branch[part] || (branch[part] = {});\n      }\n    }\n  }\n\n  return json;\n}\n\n/**\n * The return value of this method is used in calls to JSON.stringify(doc).\n *\n * This method accepts the same options as [Document#toObject](#document_Document-toObject). To apply the options to every document of your schema by default, set your [schemas](#schema_Schema) `toJSON` option to the same argument.\n *\n *     schema.set('toJSON', { virtuals: true })\n *\n * See [schema options](/docs/guide.html#toJSON) for details.\n *\n * @param {Object} options\n * @return {Object}\n * @see Document#toObject #document_Document-toObject\n * @api public\n */\n\nDocument.prototype.toJSON = function(options) {\n  return this.$toObject(options, true);\n};\n\n/**\n * Helper for console.log\n *\n * @api public\n */\n\nDocument.prototype.inspect = function(options) {\n  var isPOJO = options &&\n    utils.getFunctionName(options.constructor) === 'Object';\n  var opts;\n  if (isPOJO) {\n    opts = options;\n  } else if (this.schema.options.toObject) {\n    opts = clone(this.schema.options.toObject);\n  } else {\n    opts = {};\n  }\n  opts.minimize = false;\n  opts.retainKeyOrder = true;\n  return this.toObject(opts);\n};\n\n/**\n * Helper for console.log\n *\n * @api public\n * @method toString\n */\n\nDocument.prototype.toString = function() {\n  return inspect(this.inspect());\n};\n\n/**\n * Returns true if the Document stores the same data as doc.\n *\n * Documents are considered equal when they have matching `_id`s, unless neither\n * document has an `_id`, in which case this function falls back to using\n * `deepEqual()`.\n *\n * @param {Document} doc a document to compare\n * @return {Boolean}\n * @api public\n */\n\nDocument.prototype.equals = function(doc) {\n  var tid = this.get('_id');\n  var docid = doc.get ? doc.get('_id') : doc;\n  if (!tid && !docid) {\n    return deepEqual(this, doc);\n  }\n  return tid && tid.equals\n      ? tid.equals(docid)\n      : tid === docid;\n};\n\n/**\n * Populates document references, executing the `callback` when complete.\n * If you want to use promises instead, use this function with\n * [`execPopulate()`](#document_Document-execPopulate)\n *\n * ####Example:\n *\n *     doc\n *     .populate('company')\n *     .populate({\n *       path: 'notes',\n *       match: /airline/,\n *       select: 'text',\n *       model: 'modelName'\n *       options: opts\n *     }, function (err, user) {\n *       assert(doc._id === user._id) // the document itself is passed\n *     })\n *\n *     // summary\n *     doc.populate(path)                   // not executed\n *     doc.populate(options);               // not executed\n *     doc.populate(path, callback)         // executed\n *     doc.populate(options, callback);     // executed\n *     doc.populate(callback);              // executed\n *     doc.populate(options).execPopulate() // executed, returns promise\n *\n *\n * ####NOTE:\n *\n * Population does not occur unless a `callback` is passed *or* you explicitly\n * call `execPopulate()`.\n * Passing the same path a second time will overwrite the previous path options.\n * See [Model.populate()](#model_Model.populate) for explaination of options.\n *\n * @see Model.populate #model_Model.populate\n * @see Document.execPopulate #document_Document-execPopulate\n * @param {String|Object} [path] The path to populate or an options object\n * @param {Function} [callback] When passed, population is invoked\n * @api public\n * @return {Document} this\n */\n\nDocument.prototype.populate = function populate() {\n  if (arguments.length === 0) {\n    return this;\n  }\n\n  var pop = this.$__.populate || (this.$__.populate = {});\n  var args = utils.args(arguments);\n  var fn;\n\n  if (typeof args[args.length - 1] === 'function') {\n    fn = args.pop();\n  }\n\n  // allow `doc.populate(callback)`\n  if (args.length) {\n    // use hash to remove duplicate paths\n    var res = utils.populate.apply(null, args);\n    for (var i = 0; i < res.length; ++i) {\n      pop[res[i].path] = res[i];\n    }\n  }\n\n  if (fn) {\n    var paths = utils.object.vals(pop);\n    this.$__.populate = undefined;\n    paths.__noPromise = true;\n    this.constructor.populate(this, paths, fn);\n  }\n\n  return this;\n};\n\n/**\n * Explicitly executes population and returns a promise. Useful for ES2015\n * integration.\n *\n * ####Example:\n *\n *     var promise = doc.\n *       populate('company').\n *       populate({\n *         path: 'notes',\n *         match: /airline/,\n *         select: 'text',\n *         model: 'modelName'\n *         options: opts\n *       }).\n *       execPopulate();\n *\n *     // summary\n *     doc.execPopulate().then(resolve, reject);\n *\n *\n * @see Document.populate #Document_model.populate\n * @api public\n * @return {Promise} promise that resolves to the document when population is done\n */\n\nDocument.prototype.execPopulate = function() {\n  var Promise = PromiseProvider.get();\n  var _this = this;\n  return new Promise.ES6(function(resolve, reject) {\n    _this.populate(function(error, res) {\n      if (error) {\n        reject(error);\n      } else {\n        resolve(res);\n      }\n    });\n  });\n};\n\n/**\n * Gets _id(s) used during population of the given `path`.\n *\n * ####Example:\n *\n *     Model.findOne().populate('author').exec(function (err, doc) {\n *       console.log(doc.author.name)         // Dr.Seuss\n *       console.log(doc.populated('author')) // '5144cf8050f071d979c118a7'\n *     })\n *\n * If the path was not populated, undefined is returned.\n *\n * @param {String} path\n * @return {Array|ObjectId|Number|Buffer|String|undefined}\n * @api public\n */\n\nDocument.prototype.populated = function(path, val, options) {\n  // val and options are internal\n\n  if (val === null || val === void 0) {\n    if (!this.$__.populated) {\n      return undefined;\n    }\n    var v = this.$__.populated[path];\n    if (v) {\n      return v.value;\n    }\n    return undefined;\n  }\n\n  // internal\n\n  if (val === true) {\n    if (!this.$__.populated) {\n      return undefined;\n    }\n    return this.$__.populated[path];\n  }\n\n  this.$__.populated || (this.$__.populated = {});\n  this.$__.populated[path] = {value: val, options: options};\n  return val;\n};\n\n/**\n * Takes a populated field and returns it to its unpopulated state.\n *\n * ####Example:\n *\n *     Model.findOne().populate('author').exec(function (err, doc) {\n *       console.log(doc.author.name); // Dr.Seuss\n *       console.log(doc.depopulate('author'));\n *       console.log(doc.author); // '5144cf8050f071d979c118a7'\n *     })\n *\n * If the path was not populated, this is a no-op.\n *\n * @param {String} path\n * @api public\n */\n\nDocument.prototype.depopulate = function(path) {\n  var populatedIds = this.populated(path);\n  if (!populatedIds) {\n    return;\n  }\n  delete this.$__.populated[path];\n  this.set(path, populatedIds);\n};\n\n\n/**\n * Returns the full path to this document.\n *\n * @param {String} [path]\n * @return {String}\n * @api private\n * @method $__fullPath\n * @memberOf Document\n */\n\nDocument.prototype.$__fullPath = function(path) {\n  // overridden in SubDocuments\n  return path || '';\n};\n\n/*!\n * Module exports.\n */\n\nDocument.ValidationError = ValidationError;\nmodule.exports = exports = Document;\n"]}