{"version":3,"sources":["parse.js"],"names":[],"mappings":";;AAEA,IAAI,QAAQ,QAAQ,SAAR,CAAR;;;;AAKJ,IAAI,YAAY;AACZ,eAAW,GAAX;AACA,WAAO,CAAP;AACA,gBAAY,EAAZ;AACA,oBAAgB,IAAhB;AACA,wBAAoB,KAApB;AACA,kBAAc,KAAd;AACA,qBAAiB,KAAjB;CAPA;;AAWJ,UAAU,WAAV,GAAwB,UAAU,GAAV,EAAe,OAAf,EAAwB;;AAE5C,QAAI,MAAM,EAAN,CAFwC;AAG5C,QAAI,QAAQ,IAAI,KAAJ,CAAU,QAAQ,SAAR,EAAmB,QAAQ,cAAR,KAA2B,QAA3B,GAAsC,SAAtC,GAAkD,QAAQ,cAAR,CAAvF,CAHwC;;AAK5C,SAAK,IAAI,IAAI,CAAJ,EAAO,KAAK,MAAM,MAAN,EAAc,IAAI,EAAJ,EAAQ,EAAE,CAAF,EAAK;AAC5C,YAAI,OAAO,MAAM,CAAN,CAAP,CADwC;AAE5C,YAAI,MAAM,KAAK,OAAL,CAAa,IAAb,MAAuB,CAAC,CAAD,GAAK,KAAK,OAAL,CAAa,GAAb,CAA5B,GAAgD,KAAK,OAAL,CAAa,IAAb,IAAqB,CAArB,CAFd;;AAI5C,YAAI,QAAQ,CAAC,CAAD,EAAI;AACZ,gBAAI,MAAM,MAAN,CAAa,IAAb,CAAJ,IAA0B,EAA1B,CADY;;AAGZ,gBAAI,QAAQ,kBAAR,EAA4B;AAC5B,oBAAI,MAAM,MAAN,CAAa,IAAb,CAAJ,IAA0B,IAA1B,CAD4B;aAAhC;SAHJ,MAOK;AACD,gBAAI,MAAM,MAAM,MAAN,CAAa,KAAK,KAAL,CAAW,CAAX,EAAc,GAAd,CAAb,CAAN,CADH;AAED,gBAAI,MAAM,MAAM,MAAN,CAAa,KAAK,KAAL,CAAW,MAAM,CAAN,CAAxB,CAAN,CAFH;;AAID,gBAAI,CAAC,OAAO,SAAP,CAAiB,cAAjB,CAAgC,IAAhC,CAAqC,GAArC,EAA0C,GAA1C,CAAD,EAAiD;AACjD,oBAAI,GAAJ,IAAW,GAAX,CADiD;aAArD,MAGK;AACD,oBAAI,GAAJ,IAAW,GAAG,MAAH,CAAU,IAAI,GAAJ,CAAV,EAAoB,MAApB,CAA2B,GAA3B,CAAX,CADC;aAHL;SAXJ;KAJJ;;AAwBA,WAAO,GAAP,CA7B4C;CAAxB;;AAiCxB,UAAU,WAAV,GAAwB,UAAU,KAAV,EAAiB,GAAjB,EAAsB,OAAtB,EAA+B;;AAEnD,QAAI,CAAC,MAAM,MAAN,EAAc;AACf,eAAO,GAAP,CADe;KAAnB;;AAIA,QAAI,OAAO,MAAM,KAAN,EAAP,CAN+C;;AAQnD,QAAI,GAAJ,CARmD;AASnD,QAAI,SAAS,IAAT,EAAe;AACf,cAAM,EAAN,CADe;AAEf,cAAM,IAAI,MAAJ,CAAW,UAAU,WAAV,CAAsB,KAAtB,EAA6B,GAA7B,EAAkC,OAAlC,CAAX,CAAN,CAFe;KAAnB,MAIK;AACD,cAAM,QAAQ,YAAR,GAAuB,OAAO,MAAP,CAAc,IAAd,CAAvB,GAA6C,EAA7C,CADL;AAED,YAAI,YAAY,KAAK,CAAL,MAAY,GAAZ,IAAmB,KAAK,KAAK,MAAL,GAAc,CAAd,CAAL,KAA0B,GAA1B,GAAgC,KAAK,KAAL,CAAW,CAAX,EAAc,KAAK,MAAL,GAAc,CAAd,CAAjE,GAAoF,IAApF,CAFf;AAGD,YAAI,QAAQ,SAAS,SAAT,EAAoB,EAApB,CAAR,CAHH;AAID,YAAI,cAAc,KAAK,KAAL,CAJjB;AAKD,YAAI,CAAC,MAAM,KAAN,CAAD,IACA,SAAS,SAAT,IACA,gBAAgB,SAAhB,IACA,SAAS,CAAT,IACC,QAAQ,WAAR,IACA,SAAS,QAAQ,UAAR,EAAqB;;AAE/B,kBAAM,EAAN,CAF+B;AAG/B,gBAAI,KAAJ,IAAa,UAAU,WAAV,CAAsB,KAAtB,EAA6B,GAA7B,EAAkC,OAAlC,CAAb,CAH+B;SALnC,MAUK;AACD,gBAAI,SAAJ,IAAiB,UAAU,WAAV,CAAsB,KAAtB,EAA6B,GAA7B,EAAkC,OAAlC,CAAjB,CADC;SAVL;KATJ;;AAwBA,WAAO,GAAP,CAjCmD;CAA/B;;AAqCxB,UAAU,SAAV,GAAsB,UAAU,GAAV,EAAe,GAAf,EAAoB,OAApB,EAA6B;;AAE/C,QAAI,CAAC,GAAD,EAAM;AACN,eADM;KAAV;;;;AAF+C,QAQ3C,QAAQ,SAAR,EAAmB;AACnB,cAAM,IAAI,OAAJ,CAAY,eAAZ,EAA6B,MAA7B,CAAN,CADmB;KAAvB;;;;AAR+C,QAc3C,SAAS,aAAT,CAd2C;AAe/C,QAAI,QAAQ,iBAAR;;;;AAf2C,QAmB3C,UAAU,OAAO,IAAP,CAAY,GAAZ,CAAV;;;;AAnB2C,QAuB3C,OAAO,EAAP,CAvB2C;AAwB/C,QAAI,QAAQ,CAAR,CAAJ,EAAgB;;;AAGZ,YAAI,CAAC,QAAQ,YAAR,IACD,OAAO,SAAP,CAAiB,cAAjB,CAAgC,QAAQ,CAAR,CAAhC,CADA,EAC6C;;AAE7C,gBAAI,CAAC,QAAQ,eAAR,EAAyB;AAC1B,uBAD0B;aAA9B;SAHJ;;AAQA,aAAK,IAAL,CAAU,QAAQ,CAAR,CAAV,EAXY;KAAhB;;;;AAxB+C,QAwC3C,IAAI,CAAJ,CAxC2C;AAyC/C,WAAO,CAAC,UAAU,MAAM,IAAN,CAAW,GAAX,CAAV,CAAD,KAAgC,IAAhC,IAAwC,IAAI,QAAQ,KAAR,EAAe;;AAE9D,UAAE,CAAF,CAF8D;AAG9D,YAAI,CAAC,QAAQ,YAAR,IACD,OAAO,SAAP,CAAiB,cAAjB,CAAgC,QAAQ,CAAR,EAAW,OAAX,CAAmB,QAAnB,EAA6B,EAA7B,CAAhC,CADA,EACmE;;AAEnE,gBAAI,CAAC,QAAQ,eAAR,EAAyB;AAC1B,yBAD0B;aAA9B;SAHJ;AAOA,aAAK,IAAL,CAAU,QAAQ,CAAR,CAAV,EAV8D;KAAlE;;;;AAzC+C,QAwD3C,OAAJ,EAAa;AACT,aAAK,IAAL,CAAU,MAAM,IAAI,KAAJ,CAAU,QAAQ,KAAR,CAAhB,GAAiC,GAAjC,CAAV,CADS;KAAb;;AAIA,WAAO,UAAU,WAAV,CAAsB,IAAtB,EAA4B,GAA5B,EAAiC,OAAjC,CAAP,CA5D+C;CAA7B;;AAgEtB,OAAO,OAAP,GAAiB,UAAU,GAAV,EAAe,OAAf,EAAwB;;AAErC,cAAU,WAAW,EAAX,CAF2B;AAGrC,YAAQ,SAAR,GAAoB,OAAO,QAAQ,SAAR,KAAsB,QAA7B,IAAyC,MAAM,QAAN,CAAe,QAAQ,SAAR,CAAxD,GAA6E,QAAQ,SAAR,GAAoB,UAAU,SAAV,CAHhF;AAIrC,YAAQ,KAAR,GAAgB,OAAO,QAAQ,KAAR,KAAkB,QAAzB,GAAoC,QAAQ,KAAR,GAAgB,UAAU,KAAV,CAJ/B;AAKrC,YAAQ,UAAR,GAAqB,OAAO,QAAQ,UAAR,KAAuB,QAA9B,GAAyC,QAAQ,UAAR,GAAqB,UAAU,UAAV,CAL9C;AAMrC,YAAQ,WAAR,GAAsB,QAAQ,WAAR,KAAwB,KAAxB,CANe;AAOrC,YAAQ,SAAR,GAAoB,QAAQ,SAAR,KAAsB,KAAtB,CAPiB;AAQrC,YAAQ,YAAR,GAAuB,OAAO,QAAQ,YAAR,KAAyB,SAAhC,GAA4C,QAAQ,YAAR,GAAuB,UAAU,YAAV,CARrD;AASrC,YAAQ,eAAR,GAA0B,OAAO,QAAQ,eAAR,KAA4B,SAAnC,GAA+C,QAAQ,eAAR,GAA0B,UAAU,eAAV,CAT9D;AAUrC,YAAQ,cAAR,GAAyB,OAAO,QAAQ,cAAR,KAA2B,QAAlC,GAA6C,QAAQ,cAAR,GAAyB,UAAU,cAAV,CAV1D;AAWrC,YAAQ,kBAAR,GAA6B,OAAO,QAAQ,kBAAR,KAA+B,SAAtC,GAAkD,QAAQ,kBAAR,GAA6B,UAAU,kBAAV,CAXvE;;AAarC,QAAI,QAAQ,EAAR,IACA,QAAQ,IAAR,IACA,OAAO,GAAP,KAAe,WAAf,EAA4B;;AAE5B,eAAO,QAAQ,YAAR,GAAuB,OAAO,MAAP,CAAc,IAAd,CAAvB,GAA6C,EAA7C,CAFqB;KAFhC;;AAOA,QAAI,UAAU,OAAO,GAAP,KAAe,QAAf,GAA0B,UAAU,WAAV,CAAsB,GAAtB,EAA2B,OAA3B,CAA1B,GAAgE,GAAhE,CApBuB;AAqBrC,QAAI,MAAM,QAAQ,YAAR,GAAuB,OAAO,MAAP,CAAc,IAAd,CAAvB,GAA6C,EAA7C;;;;AArB2B,QAyBjC,OAAO,OAAO,IAAP,CAAY,OAAZ,CAAP,CAzBiC;AA0BrC,SAAK,IAAI,IAAI,CAAJ,EAAO,KAAK,KAAK,MAAL,EAAa,IAAI,EAAJ,EAAQ,EAAE,CAAF,EAAK;AAC3C,YAAI,MAAM,KAAK,CAAL,CAAN,CADuC;AAE3C,YAAI,SAAS,UAAU,SAAV,CAAoB,GAApB,EAAyB,QAAQ,GAAR,CAAzB,EAAuC,OAAvC,CAAT,CAFuC;AAG3C,cAAM,MAAM,KAAN,CAAY,GAAZ,EAAiB,MAAjB,EAAyB,OAAzB,CAAN,CAH2C;KAA/C;;AAMA,WAAO,MAAM,OAAN,CAAc,GAAd,CAAP,CAhCqC;CAAxB","file":"parse-compiled.js","sourcesContent":["// Load modules\n\nvar Utils = require('./utils');\n\n\n// Declare internals\n\nvar internals = {\n    delimiter: '&',\n    depth: 5,\n    arrayLimit: 20,\n    parameterLimit: 1000,\n    strictNullHandling: false,\n    plainObjects: false,\n    allowPrototypes: false\n};\n\n\ninternals.parseValues = function (str, options) {\n\n    var obj = {};\n    var parts = str.split(options.delimiter, options.parameterLimit === Infinity ? undefined : options.parameterLimit);\n\n    for (var i = 0, il = parts.length; i < il; ++i) {\n        var part = parts[i];\n        var pos = part.indexOf(']=') === -1 ? part.indexOf('=') : part.indexOf(']=') + 1;\n\n        if (pos === -1) {\n            obj[Utils.decode(part)] = '';\n\n            if (options.strictNullHandling) {\n                obj[Utils.decode(part)] = null;\n            }\n        }\n        else {\n            var key = Utils.decode(part.slice(0, pos));\n            var val = Utils.decode(part.slice(pos + 1));\n\n            if (!Object.prototype.hasOwnProperty.call(obj, key)) {\n                obj[key] = val;\n            }\n            else {\n                obj[key] = [].concat(obj[key]).concat(val);\n            }\n        }\n    }\n\n    return obj;\n};\n\n\ninternals.parseObject = function (chain, val, options) {\n\n    if (!chain.length) {\n        return val;\n    }\n\n    var root = chain.shift();\n\n    var obj;\n    if (root === '[]') {\n        obj = [];\n        obj = obj.concat(internals.parseObject(chain, val, options));\n    }\n    else {\n        obj = options.plainObjects ? Object.create(null) : {};\n        var cleanRoot = root[0] === '[' && root[root.length - 1] === ']' ? root.slice(1, root.length - 1) : root;\n        var index = parseInt(cleanRoot, 10);\n        var indexString = '' + index;\n        if (!isNaN(index) &&\n            root !== cleanRoot &&\n            indexString === cleanRoot &&\n            index >= 0 &&\n            (options.parseArrays &&\n             index <= options.arrayLimit)) {\n\n            obj = [];\n            obj[index] = internals.parseObject(chain, val, options);\n        }\n        else {\n            obj[cleanRoot] = internals.parseObject(chain, val, options);\n        }\n    }\n\n    return obj;\n};\n\n\ninternals.parseKeys = function (key, val, options) {\n\n    if (!key) {\n        return;\n    }\n\n    // Transform dot notation to bracket notation\n\n    if (options.allowDots) {\n        key = key.replace(/\\.([^\\.\\[]+)/g, '[$1]');\n    }\n\n    // The regex chunks\n\n    var parent = /^([^\\[\\]]*)/;\n    var child = /(\\[[^\\[\\]]*\\])/g;\n\n    // Get the parent\n\n    var segment = parent.exec(key);\n\n    // Stash the parent if it exists\n\n    var keys = [];\n    if (segment[1]) {\n        // If we aren't using plain objects, optionally prefix keys\n        // that would overwrite object prototype properties\n        if (!options.plainObjects &&\n            Object.prototype.hasOwnProperty(segment[1])) {\n\n            if (!options.allowPrototypes) {\n                return;\n            }\n        }\n\n        keys.push(segment[1]);\n    }\n\n    // Loop through children appending to the array until we hit depth\n\n    var i = 0;\n    while ((segment = child.exec(key)) !== null && i < options.depth) {\n\n        ++i;\n        if (!options.plainObjects &&\n            Object.prototype.hasOwnProperty(segment[1].replace(/\\[|\\]/g, ''))) {\n\n            if (!options.allowPrototypes) {\n                continue;\n            }\n        }\n        keys.push(segment[1]);\n    }\n\n    // If there's a remainder, just add whatever is left\n\n    if (segment) {\n        keys.push('[' + key.slice(segment.index) + ']');\n    }\n\n    return internals.parseObject(keys, val, options);\n};\n\n\nmodule.exports = function (str, options) {\n\n    options = options || {};\n    options.delimiter = typeof options.delimiter === 'string' || Utils.isRegExp(options.delimiter) ? options.delimiter : internals.delimiter;\n    options.depth = typeof options.depth === 'number' ? options.depth : internals.depth;\n    options.arrayLimit = typeof options.arrayLimit === 'number' ? options.arrayLimit : internals.arrayLimit;\n    options.parseArrays = options.parseArrays !== false;\n    options.allowDots = options.allowDots !== false;\n    options.plainObjects = typeof options.plainObjects === 'boolean' ? options.plainObjects : internals.plainObjects;\n    options.allowPrototypes = typeof options.allowPrototypes === 'boolean' ? options.allowPrototypes : internals.allowPrototypes;\n    options.parameterLimit = typeof options.parameterLimit === 'number' ? options.parameterLimit : internals.parameterLimit;\n    options.strictNullHandling = typeof options.strictNullHandling === 'boolean' ? options.strictNullHandling : internals.strictNullHandling;\n\n    if (str === '' ||\n        str === null ||\n        typeof str === 'undefined') {\n\n        return options.plainObjects ? Object.create(null) : {};\n    }\n\n    var tempObj = typeof str === 'string' ? internals.parseValues(str, options) : str;\n    var obj = options.plainObjects ? Object.create(null) : {};\n\n    // Iterate over the keys and setup the new object\n\n    var keys = Object.keys(tempObj);\n    for (var i = 0, il = keys.length; i < il; ++i) {\n        var key = keys[i];\n        var newObj = internals.parseKeys(key, tempObj[key], options);\n        obj = Utils.merge(obj, newObj, options);\n    }\n\n    return Utils.compact(obj);\n};\n"]}