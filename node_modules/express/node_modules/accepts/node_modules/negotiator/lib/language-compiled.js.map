{"version":3,"sources":["language.js"],"names":[],"mappings":"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","file":"language-compiled.js","sourcesContent":["module.exports = preferredLanguages;\npreferredLanguages.preferredLanguages = preferredLanguages;\n\nfunction parseAcceptLanguage(accept) {\n  var accepts = accept.split(',');\n\n  for (var i = 0, j = 0; i < accepts.length; i++) {\n    var langauge = parseLanguage(accepts[i].trim(), i);\n\n    if (langauge) {\n      accepts[j++] = langauge;\n    }\n  }\n\n  // trim accepts\n  accepts.length = j;\n\n  return accepts;\n}\n\nfunction parseLanguage(s, i) {\n  var match = s.match(/^\\s*(\\S+?)(?:-(\\S+?))?\\s*(?:;(.*))?$/);\n  if (!match) return null;\n\n  var prefix = match[1],\n      suffix = match[2],\n      full = prefix;\n\n  if (suffix) full += \"-\" + suffix;\n\n  var q = 1;\n  if (match[3]) {\n    var params = match[3].split(';')\n    for (var i = 0; i < params.length; i ++) {\n      var p = params[i].split('=');\n      if (p[0] === 'q') q = parseFloat(p[1]);\n    }\n  }\n\n  return {\n    prefix: prefix,\n    suffix: suffix,\n    q: q,\n    i: i,\n    full: full\n  };\n}\n\nfunction getLanguagePriority(language, accepted, index) {\n  var priority = {o: -1, q: 0, s: 0};\n\n  for (var i = 0; i < accepted.length; i++) {\n    var spec = specify(language, accepted[i], index);\n\n    if (spec && (priority.s - spec.s || priority.q - spec.q || priority.o - spec.o) < 0) {\n      priority = spec;\n    }\n  }\n\n  return priority;\n}\n\nfunction specify(language, spec, index) {\n  var p = parseLanguage(language)\n  if (!p) return null;\n  var s = 0;\n  if(spec.full.toLowerCase() === p.full.toLowerCase()){\n    s |= 4;\n  } else if (spec.prefix.toLowerCase() === p.full.toLowerCase()) {\n    s |= 2;\n  } else if (spec.full.toLowerCase() === p.prefix.toLowerCase()) {\n    s |= 1;\n  } else if (spec.full !== '*' ) {\n    return null\n  }\n\n  return {\n    i: index,\n    o: spec.i,\n    q: spec.q,\n    s: s\n  }\n};\n\nfunction preferredLanguages(accept, provided) {\n  // RFC 2616 sec 14.4: no header = *\n  var accepts = parseAcceptLanguage(accept === undefined ? '*' : accept || '');\n\n  if (!provided) {\n    // sorted list of all languages\n    return accepts.filter(isQuality).sort(compareSpecs).map(function getLanguage(spec) {\n      return spec.full;\n    });\n  }\n\n  var priorities = provided.map(function getPriority(type, index) {\n    return getLanguagePriority(type, accepts, index);\n  });\n\n  // sorted list of accepted languages\n  return priorities.filter(isQuality).sort(compareSpecs).map(function getLanguage(priority) {\n    return provided[priorities.indexOf(priority)];\n  });\n}\n\nfunction compareSpecs(a, b) {\n  return (b.q - a.q) || (b.s - a.s) || (a.o - b.o) || (a.i - b.i) || 0;\n}\n\nfunction isQuality(spec) {\n  return spec.q > 0;\n}\n"]}