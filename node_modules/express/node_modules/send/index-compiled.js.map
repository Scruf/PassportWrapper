{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"index-compiled.js","sourcesContent":["/*!\n * send\n * Copyright(c) 2012 TJ Holowaychuk\n * Copyright(c) 2014-2015 Douglas Christopher Wilson\n * MIT Licensed\n */\n\n'use strict'\n\n/**\n * Module dependencies.\n * @private\n */\n\nvar createError = require('http-errors')\nvar debug = require('debug')('send')\nvar deprecate = require('depd')('send')\nvar destroy = require('destroy')\nvar escapeHtml = require('escape-html')\n  , parseRange = require('range-parser')\n  , Stream = require('stream')\n  , mime = require('mime')\n  , fresh = require('fresh')\n  , path = require('path')\n  , fs = require('fs')\n  , normalize = path.normalize\n  , join = path.join\nvar etag = require('etag')\nvar EventEmitter = require('events').EventEmitter;\nvar ms = require('ms');\nvar onFinished = require('on-finished')\nvar statuses = require('statuses')\n\n/**\n * Variables.\n */\nvar extname = path.extname\nvar maxMaxAge = 60 * 60 * 24 * 365 * 1000; // 1 year\nvar resolve = path.resolve\nvar sep = path.sep\nvar toString = Object.prototype.toString\nvar upPathRegexp = /(?:^|[\\\\\\/])\\.\\.(?:[\\\\\\/]|$)/\n\n/**\n * Module exports.\n * @public\n */\n\nmodule.exports = send\nmodule.exports.mime = mime\n\n/**\n * Shim EventEmitter.listenerCount for node.js < 0.10\n */\n\n/* istanbul ignore next */\nvar listenerCount = EventEmitter.listenerCount\n  || function(emitter, type){ return emitter.listeners(type).length; };\n\n/**\n * Return a `SendStream` for `req` and `path`.\n *\n * @param {object} req\n * @param {string} path\n * @param {object} [options]\n * @return {SendStream}\n * @public\n */\n\nfunction send(req, path, options) {\n  return new SendStream(req, path, options);\n}\n\n/**\n * Initialize a `SendStream` with the given `path`.\n *\n * @param {Request} req\n * @param {String} path\n * @param {object} [options]\n * @private\n */\n\nfunction SendStream(req, path, options) {\n  var opts = options || {}\n\n  this.options = opts\n  this.path = path\n  this.req = req\n\n  this._etag = opts.etag !== undefined\n    ? Boolean(opts.etag)\n    : true\n\n  this._dotfiles = opts.dotfiles !== undefined\n    ? opts.dotfiles\n    : 'ignore'\n\n  if (this._dotfiles !== 'ignore' && this._dotfiles !== 'allow' && this._dotfiles !== 'deny') {\n    throw new TypeError('dotfiles option must be \"allow\", \"deny\", or \"ignore\"')\n  }\n\n  this._hidden = Boolean(opts.hidden)\n\n  if (opts.hidden !== undefined) {\n    deprecate('hidden: use dotfiles: \\'' + (this._hidden ? 'allow' : 'ignore') + '\\' instead')\n  }\n\n  // legacy support\n  if (opts.dotfiles === undefined) {\n    this._dotfiles = undefined\n  }\n\n  this._extensions = opts.extensions !== undefined\n    ? normalizeList(opts.extensions, 'extensions option')\n    : []\n\n  this._index = opts.index !== undefined\n    ? normalizeList(opts.index, 'index option')\n    : ['index.html']\n\n  this._lastModified = opts.lastModified !== undefined\n    ? Boolean(opts.lastModified)\n    : true\n\n  this._maxage = opts.maxAge || opts.maxage\n  this._maxage = typeof this._maxage === 'string'\n    ? ms(this._maxage)\n    : Number(this._maxage)\n  this._maxage = !isNaN(this._maxage)\n    ? Math.min(Math.max(0, this._maxage), maxMaxAge)\n    : 0\n\n  this._root = opts.root\n    ? resolve(opts.root)\n    : null\n\n  if (!this._root && opts.from) {\n    this.from(opts.from)\n  }\n}\n\n/**\n * Inherits from `Stream.prototype`.\n */\n\nSendStream.prototype.__proto__ = Stream.prototype;\n\n/**\n * Enable or disable etag generation.\n *\n * @param {Boolean} val\n * @return {SendStream}\n * @api public\n */\n\nSendStream.prototype.etag = deprecate.function(function etag(val) {\n  val = Boolean(val);\n  debug('etag %s', val);\n  this._etag = val;\n  return this;\n}, 'send.etag: pass etag as option');\n\n/**\n * Enable or disable \"hidden\" (dot) files.\n *\n * @param {Boolean} path\n * @return {SendStream}\n * @api public\n */\n\nSendStream.prototype.hidden = deprecate.function(function hidden(val) {\n  val = Boolean(val);\n  debug('hidden %s', val);\n  this._hidden = val;\n  this._dotfiles = undefined\n  return this;\n}, 'send.hidden: use dotfiles option');\n\n/**\n * Set index `paths`, set to a falsy\n * value to disable index support.\n *\n * @param {String|Boolean|Array} paths\n * @return {SendStream}\n * @api public\n */\n\nSendStream.prototype.index = deprecate.function(function index(paths) {\n  var index = !paths ? [] : normalizeList(paths, 'paths argument');\n  debug('index %o', paths);\n  this._index = index;\n  return this;\n}, 'send.index: pass index as option');\n\n/**\n * Set root `path`.\n *\n * @param {String} path\n * @return {SendStream}\n * @api public\n */\n\nSendStream.prototype.root = function(path){\n  path = String(path);\n  this._root = resolve(path)\n  return this;\n};\n\nSendStream.prototype.from = deprecate.function(SendStream.prototype.root,\n  'send.from: pass root as option');\n\nSendStream.prototype.root = deprecate.function(SendStream.prototype.root,\n  'send.root: pass root as option');\n\n/**\n * Set max-age to `maxAge`.\n *\n * @param {Number} maxAge\n * @return {SendStream}\n * @api public\n */\n\nSendStream.prototype.maxage = deprecate.function(function maxage(maxAge) {\n  maxAge = typeof maxAge === 'string'\n    ? ms(maxAge)\n    : Number(maxAge);\n  if (isNaN(maxAge)) maxAge = 0;\n  if (Infinity == maxAge) maxAge = 60 * 60 * 24 * 365 * 1000;\n  debug('max-age %d', maxAge);\n  this._maxage = maxAge;\n  return this;\n}, 'send.maxage: pass maxAge as option');\n\n/**\n * Emit error with `status`.\n *\n * @param {number} status\n * @param {Error} [error]\n * @private\n */\n\nSendStream.prototype.error = function error(status, error) {\n  // emit if listeners instead of responding\n  if (listenerCount(this, 'error') !== 0) {\n    return this.emit('error', createError(error, status, {\n      expose: false\n    }))\n  }\n\n  var res = this.res\n  var msg = statuses[status]\n\n  // wipe all existing headers\n  res._headers = null\n\n  // send basic response\n  res.statusCode = status\n  res.setHeader('Content-Type', 'text/plain; charset=UTF-8')\n  res.setHeader('Content-Length', Buffer.byteLength(msg))\n  res.setHeader('X-Content-Type-Options', 'nosniff')\n  res.end(msg)\n}\n\n/**\n * Check if the pathname ends with \"/\".\n *\n * @return {Boolean}\n * @api private\n */\n\nSendStream.prototype.hasTrailingSlash = function(){\n  return '/' == this.path[this.path.length - 1];\n};\n\n/**\n * Check if this is a conditional GET request.\n *\n * @return {Boolean}\n * @api private\n */\n\nSendStream.prototype.isConditionalGET = function(){\n  return this.req.headers['if-none-match']\n    || this.req.headers['if-modified-since'];\n};\n\n/**\n * Strip content-* header fields.\n *\n * @private\n */\n\nSendStream.prototype.removeContentHeaderFields = function removeContentHeaderFields() {\n  var res = this.res\n  var headers = Object.keys(res._headers || {})\n\n  for (var i = 0; i < headers.length; i++) {\n    var header = headers[i]\n    if (header.substr(0, 8) === 'content-' && header !== 'content-location') {\n      res.removeHeader(header)\n    }\n  }\n}\n\n/**\n * Respond with 304 not modified.\n *\n * @api private\n */\n\nSendStream.prototype.notModified = function(){\n  var res = this.res;\n  debug('not modified');\n  this.removeContentHeaderFields();\n  res.statusCode = 304;\n  res.end();\n};\n\n/**\n * Raise error that headers already sent.\n *\n * @api private\n */\n\nSendStream.prototype.headersAlreadySent = function headersAlreadySent(){\n  var err = new Error('Can\\'t set headers after they are sent.');\n  debug('headers already sent');\n  this.error(500, err);\n};\n\n/**\n * Check if the request is cacheable, aka\n * responded with 2xx or 304 (see RFC 2616 section 14.2{5,6}).\n *\n * @return {Boolean}\n * @api private\n */\n\nSendStream.prototype.isCachable = function(){\n  var res = this.res;\n  return (res.statusCode >= 200 && res.statusCode < 300) || 304 == res.statusCode;\n};\n\n/**\n * Handle stat() error.\n *\n * @param {Error} error\n * @private\n */\n\nSendStream.prototype.onStatError = function onStatError(error) {\n  switch (error.code) {\n    case 'ENAMETOOLONG':\n    case 'ENOENT':\n    case 'ENOTDIR':\n      this.error(404, error)\n      break\n    default:\n      this.error(500, error)\n      break\n  }\n}\n\n/**\n * Check if the cache is fresh.\n *\n * @return {Boolean}\n * @api private\n */\n\nSendStream.prototype.isFresh = function(){\n  return fresh(this.req.headers, this.res._headers);\n};\n\n/**\n * Check if the range is fresh.\n *\n * @return {Boolean}\n * @api private\n */\n\nSendStream.prototype.isRangeFresh = function isRangeFresh(){\n  var ifRange = this.req.headers['if-range'];\n\n  if (!ifRange) return true;\n\n  return ~ifRange.indexOf('\"')\n    ? ~ifRange.indexOf(this.res._headers['etag'])\n    : Date.parse(this.res._headers['last-modified']) <= Date.parse(ifRange);\n};\n\n/**\n * Redirect to path.\n *\n * @param {string} path\n * @private\n */\n\nSendStream.prototype.redirect = function redirect(path) {\n  if (listenerCount(this, 'directory') !== 0) {\n    this.emit('directory')\n    return\n  }\n\n  if (this.hasTrailingSlash()) {\n    this.error(403)\n    return\n  }\n\n  var loc = path + '/'\n  var msg = 'Redirecting to <a href=\"' + escapeHtml(loc) + '\">' + escapeHtml(loc) + '</a>\\n'\n  var res = this.res\n\n  // redirect\n  res.statusCode = 301\n  res.setHeader('Content-Type', 'text/html; charset=UTF-8')\n  res.setHeader('Content-Length', Buffer.byteLength(msg))\n  res.setHeader('X-Content-Type-Options', 'nosniff')\n  res.setHeader('Location', loc)\n  res.end(msg)\n}\n\n/**\n * Pipe to `res.\n *\n * @param {Stream} res\n * @return {Stream} res\n * @api public\n */\n\nSendStream.prototype.pipe = function(res){\n  var self = this\n    , args = arguments\n    , root = this._root;\n\n  // references\n  this.res = res;\n\n  // decode the path\n  var path = decode(this.path)\n  if (path === -1) return this.error(400)\n\n  // null byte(s)\n  if (~path.indexOf('\\0')) return this.error(400);\n\n  var parts\n  if (root !== null) {\n    // malicious path\n    if (upPathRegexp.test(normalize('.' + sep + path))) {\n      debug('malicious path \"%s\"', path)\n      return this.error(403)\n    }\n\n    // join / normalize from optional root dir\n    path = normalize(join(root, path))\n    root = normalize(root + sep)\n\n    // explode path parts\n    parts = path.substr(root.length).split(sep)\n  } else {\n    // \"..\" is malicious without \"root\"\n    if (upPathRegexp.test(path)) {\n      debug('malicious path \"%s\"', path)\n      return this.error(403)\n    }\n\n    // explode path parts\n    parts = normalize(path).split(sep)\n\n    // resolve the path\n    path = resolve(path)\n  }\n\n  // dotfile handling\n  if (containsDotFile(parts)) {\n    var access = this._dotfiles\n\n    // legacy support\n    if (access === undefined) {\n      access = parts[parts.length - 1][0] === '.'\n        ? (this._hidden ? 'allow' : 'ignore')\n        : 'allow'\n    }\n\n    debug('%s dotfile \"%s\"', access, path)\n    switch (access) {\n      case 'allow':\n        break\n      case 'deny':\n        return this.error(403)\n      case 'ignore':\n      default:\n        return this.error(404)\n    }\n  }\n\n  // index file support\n  if (this._index.length && this.path[this.path.length - 1] === '/') {\n    this.sendIndex(path);\n    return res;\n  }\n\n  this.sendFile(path);\n  return res;\n};\n\n/**\n * Transfer `path`.\n *\n * @param {String} path\n * @api public\n */\n\nSendStream.prototype.send = function(path, stat){\n  var len = stat.size;\n  var options = this.options\n  var opts = {}\n  var res = this.res;\n  var req = this.req;\n  var ranges = req.headers.range;\n  var offset = options.start || 0;\n\n  if (res._header) {\n    // impossible to send now\n    return this.headersAlreadySent();\n  }\n\n  debug('pipe \"%s\"', path)\n\n  // set header fields\n  this.setHeader(path, stat);\n\n  // set content-type\n  this.type(path);\n\n  // conditional GET support\n  if (this.isConditionalGET()\n    && this.isCachable()\n    && this.isFresh()) {\n    return this.notModified();\n  }\n\n  // adjust len to start/end options\n  len = Math.max(0, len - offset);\n  if (options.end !== undefined) {\n    var bytes = options.end - offset + 1;\n    if (len > bytes) len = bytes;\n  }\n\n  // Range support\n  if (ranges) {\n    ranges = parseRange(len, ranges);\n\n    // If-Range support\n    if (!this.isRangeFresh()) {\n      debug('range stale');\n      ranges = -2;\n    }\n\n    // unsatisfiable\n    if (-1 == ranges) {\n      debug('range unsatisfiable');\n      res.setHeader('Content-Range', 'bytes */' + stat.size);\n      return this.error(416);\n    }\n\n    // valid (syntactically invalid/multiple ranges are treated as a regular response)\n    if (-2 != ranges && ranges.length === 1) {\n      debug('range %j', ranges);\n\n      // Content-Range\n      res.statusCode = 206;\n      res.setHeader('Content-Range', 'bytes '\n        + ranges[0].start\n        + '-'\n        + ranges[0].end\n        + '/'\n        + len);\n\n      offset += ranges[0].start;\n      len = ranges[0].end - ranges[0].start + 1;\n    }\n  }\n\n  // clone options\n  for (var prop in options) {\n    opts[prop] = options[prop]\n  }\n\n  // set read options\n  opts.start = offset\n  opts.end = Math.max(offset, offset + len - 1)\n\n  // content-length\n  res.setHeader('Content-Length', len);\n\n  // HEAD support\n  if ('HEAD' == req.method) return res.end();\n\n  this.stream(path, opts)\n};\n\n/**\n * Transfer file for `path`.\n *\n * @param {String} path\n * @api private\n */\nSendStream.prototype.sendFile = function sendFile(path) {\n  var i = 0\n  var self = this\n\n  debug('stat \"%s\"', path);\n  fs.stat(path, function onstat(err, stat) {\n    if (err && err.code === 'ENOENT'\n      && !extname(path)\n      && path[path.length - 1] !== sep) {\n      // not found, check extensions\n      return next(err)\n    }\n    if (err) return self.onStatError(err)\n    if (stat.isDirectory()) return self.redirect(self.path)\n    self.emit('file', path, stat)\n    self.send(path, stat)\n  })\n\n  function next(err) {\n    if (self._extensions.length <= i) {\n      return err\n        ? self.onStatError(err)\n        : self.error(404)\n    }\n\n    var p = path + '.' + self._extensions[i++]\n\n    debug('stat \"%s\"', p)\n    fs.stat(p, function (err, stat) {\n      if (err) return next(err)\n      if (stat.isDirectory()) return next()\n      self.emit('file', p, stat)\n      self.send(p, stat)\n    })\n  }\n}\n\n/**\n * Transfer index for `path`.\n *\n * @param {String} path\n * @api private\n */\nSendStream.prototype.sendIndex = function sendIndex(path){\n  var i = -1;\n  var self = this;\n\n  function next(err){\n    if (++i >= self._index.length) {\n      if (err) return self.onStatError(err);\n      return self.error(404);\n    }\n\n    var p = join(path, self._index[i]);\n\n    debug('stat \"%s\"', p);\n    fs.stat(p, function(err, stat){\n      if (err) return next(err);\n      if (stat.isDirectory()) return next();\n      self.emit('file', p, stat);\n      self.send(p, stat);\n    });\n  }\n\n  next();\n};\n\n/**\n * Stream `path` to the response.\n *\n * @param {String} path\n * @param {Object} options\n * @api private\n */\n\nSendStream.prototype.stream = function(path, options){\n  // TODO: this is all lame, refactor meeee\n  var finished = false;\n  var self = this;\n  var res = this.res;\n  var req = this.req;\n\n  // pipe\n  var stream = fs.createReadStream(path, options);\n  this.emit('stream', stream);\n  stream.pipe(res);\n\n  // response finished, done with the fd\n  onFinished(res, function onfinished(){\n    finished = true;\n    destroy(stream);\n  });\n\n  // error handling code-smell\n  stream.on('error', function onerror(err){\n    // request already finished\n    if (finished) return;\n\n    // clean up stream\n    finished = true;\n    destroy(stream);\n\n    // error\n    self.onStatError(err);\n  });\n\n  // end\n  stream.on('end', function onend(){\n    self.emit('end');\n  });\n};\n\n/**\n * Set content-type based on `path`\n * if it hasn't been explicitly set.\n *\n * @param {String} path\n * @api private\n */\n\nSendStream.prototype.type = function(path){\n  var res = this.res;\n  if (res.getHeader('Content-Type')) return;\n  var type = mime.lookup(path);\n  var charset = mime.charsets.lookup(type);\n  debug('content-type %s', type);\n  res.setHeader('Content-Type', type + (charset ? '; charset=' + charset : ''));\n};\n\n/**\n * Set response header fields, most\n * fields may be pre-defined.\n *\n * @param {String} path\n * @param {Object} stat\n * @api private\n */\n\nSendStream.prototype.setHeader = function setHeader(path, stat){\n  var res = this.res;\n\n  this.emit('headers', res, path, stat);\n\n  if (!res.getHeader('Accept-Ranges')) res.setHeader('Accept-Ranges', 'bytes');\n  if (!res.getHeader('Cache-Control')) res.setHeader('Cache-Control', 'public, max-age=' + Math.floor(this._maxage / 1000));\n\n  if (this._lastModified && !res.getHeader('Last-Modified')) {\n    var modified = stat.mtime.toUTCString()\n    debug('modified %s', modified)\n    res.setHeader('Last-Modified', modified)\n  }\n\n  if (this._etag && !res.getHeader('ETag')) {\n    var val = etag(stat)\n    debug('etag %s', val)\n    res.setHeader('ETag', val)\n  }\n};\n\n/**\n * Determine if path parts contain a dotfile.\n *\n * @api private\n */\n\nfunction containsDotFile(parts) {\n  for (var i = 0; i < parts.length; i++) {\n    if (parts[i][0] === '.') {\n      return true\n    }\n  }\n\n  return false\n}\n\n/**\n * decodeURIComponent.\n *\n * Allows V8 to only deoptimize this fn instead of all\n * of send().\n *\n * @param {String} path\n * @api private\n */\n\nfunction decode(path) {\n  try {\n    return decodeURIComponent(path)\n  } catch (err) {\n    return -1\n  }\n}\n\n/**\n * Normalize the index option into an array.\n *\n * @param {boolean|string|array} val\n * @param {string} name\n * @private\n */\n\nfunction normalizeList(val, name) {\n  var list = [].concat(val || [])\n\n  for (var i = 0; i < list.length; i++) {\n    if (typeof list[i] !== 'string') {\n      throw new TypeError(name + ' must be array of strings or false')\n    }\n  }\n\n  return list\n}\n"]}