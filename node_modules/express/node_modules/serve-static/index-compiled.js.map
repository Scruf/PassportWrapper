{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"index-compiled.js","sourcesContent":["/*!\n * serve-static\n * Copyright(c) 2010 Sencha Inc.\n * Copyright(c) 2011 TJ Holowaychuk\n * Copyright(c) 2014-2015 Douglas Christopher Wilson\n * MIT Licensed\n */\n\n'use strict'\n\n/**\n * Module dependencies.\n * @private\n */\n\nvar escapeHtml = require('escape-html')\nvar parseUrl = require('parseurl')\nvar resolve = require('path').resolve\nvar send = require('send')\nvar url = require('url')\n\n/**\n * Module exports.\n * @public\n */\n\nmodule.exports = serveStatic\nmodule.exports.mime = send.mime\n\n/**\n * @param {string} root\n * @param {object} [options]\n * @return {function}\n * @public\n */\n\nfunction serveStatic(root, options) {\n  if (!root) {\n    throw new TypeError('root path required')\n  }\n\n  if (typeof root !== 'string') {\n    throw new TypeError('root path must be a string')\n  }\n\n  // copy options object\n  var opts = Object.create(options || null)\n\n  // fall-though\n  var fallthrough = opts.fallthrough !== false\n\n  // default redirect\n  var redirect = opts.redirect !== false\n\n  // headers listener\n  var setHeaders = opts.setHeaders\n\n  if (setHeaders && typeof setHeaders !== 'function') {\n    throw new TypeError('option setHeaders must be function')\n  }\n\n  // setup options for send\n  opts.maxage = opts.maxage || opts.maxAge || 0\n  opts.root = resolve(root)\n\n  // construct directory listener\n  var onDirectory = redirect\n    ? createRedirectDirectoryListener()\n    : createNotFoundDirectoryListener()\n\n  return function serveStatic(req, res, next) {\n    if (req.method !== 'GET' && req.method !== 'HEAD') {\n      if (fallthrough) {\n        return next()\n      }\n\n      // method not allowed\n      res.statusCode = 405\n      res.setHeader('Allow', 'GET, HEAD')\n      res.setHeader('Content-Length', '0')\n      res.end()\n      return\n    }\n\n    var forwardError = !fallthrough\n    var originalUrl = parseUrl.original(req)\n    var path = parseUrl(req).pathname\n\n    // make sure redirect occurs at mount\n    if (path === '/' && originalUrl.pathname.substr(-1) !== '/') {\n      path = ''\n    }\n\n    // create send stream\n    var stream = send(req, path, opts)\n\n    // add directory handler\n    stream.on('directory', onDirectory)\n\n    // add headers listener\n    if (setHeaders) {\n      stream.on('headers', setHeaders)\n    }\n\n    // add file listener for fallthrough\n    if (fallthrough) {\n      stream.on('file', function onFile() {\n        // once file is determined, always forward error\n        forwardError = true\n      })\n    }\n\n    // forward errors\n    stream.on('error', function error(err) {\n      if (forwardError || !(err.statusCode < 500)) {\n        next(err)\n        return\n      }\n\n      next()\n    })\n\n    // pipe\n    stream.pipe(res)\n  }\n}\n\n/**\n * Collapse all leading slashes into a single slash\n * @private\n */\nfunction collapseLeadingSlashes(str) {\n  for (var i = 0; i < str.length; i++) {\n    if (str[i] !== '/') {\n      break\n    }\n  }\n\n  return i > 1\n    ? '/' + str.substr(i)\n    : str\n}\n\n/**\n * Create a directory listener that just 404s.\n * @private\n */\n\nfunction createNotFoundDirectoryListener() {\n  return function notFound() {\n    this.error(404)\n  }\n}\n\n/**\n * Create a directory listener that performs a redirect.\n * @private\n */\n\nfunction createRedirectDirectoryListener() {\n  return function redirect() {\n    if (this.hasTrailingSlash()) {\n      this.error(404)\n      return\n    }\n\n    // get original URL\n    var originalUrl = parseUrl.original(this.req)\n\n    // append trailing slash\n    originalUrl.path = null\n    originalUrl.pathname = collapseLeadingSlashes(originalUrl.pathname + '/')\n\n    // reformat the URL\n    var loc = url.format(originalUrl)\n    var msg = 'Redirecting to <a href=\"' + escapeHtml(loc) + '\">' + escapeHtml(loc) + '</a>\\n'\n    var res = this.res\n\n    // send redirect response\n    res.statusCode = 303\n    res.setHeader('Content-Type', 'text/html; charset=UTF-8')\n    res.setHeader('Content-Length', Buffer.byteLength(msg))\n    res.setHeader('X-Content-Type-Options', 'nosniff')\n    res.setHeader('Location', loc)\n    res.end(msg)\n  }\n}\n"]}