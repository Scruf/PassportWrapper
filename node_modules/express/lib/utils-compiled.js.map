{"version":3,"sources":["utils.js"],"names":[],"mappings":"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","file":"utils-compiled.js","sourcesContent":["/*!\n * express\n * Copyright(c) 2009-2013 TJ Holowaychuk\n * Copyright(c) 2014-2015 Douglas Christopher Wilson\n * MIT Licensed\n */\n\n'use strict';\n\n/**\n * Module dependencies.\n * @api private\n */\n\nvar contentDisposition = require('content-disposition');\nvar contentType = require('content-type');\nvar deprecate = require('depd')('express');\nvar flatten = require('array-flatten');\nvar mime = require('send').mime;\nvar basename = require('path').basename;\nvar etag = require('etag');\nvar proxyaddr = require('proxy-addr');\nvar qs = require('qs');\nvar querystring = require('querystring');\n\n/**\n * Return strong ETag for `body`.\n *\n * @param {String|Buffer} body\n * @param {String} [encoding]\n * @return {String}\n * @api private\n */\n\nexports.etag = function (body, encoding) {\n  var buf = !Buffer.isBuffer(body)\n    ? new Buffer(body, encoding)\n    : body;\n\n  return etag(buf, {weak: false});\n};\n\n/**\n * Return weak ETag for `body`.\n *\n * @param {String|Buffer} body\n * @param {String} [encoding]\n * @return {String}\n * @api private\n */\n\nexports.wetag = function wetag(body, encoding){\n  var buf = !Buffer.isBuffer(body)\n    ? new Buffer(body, encoding)\n    : body;\n\n  return etag(buf, {weak: true});\n};\n\n/**\n * Check if `path` looks absolute.\n *\n * @param {String} path\n * @return {Boolean}\n * @api private\n */\n\nexports.isAbsolute = function(path){\n  if ('/' == path[0]) return true;\n  if (':' == path[1] && '\\\\' == path[2]) return true;\n  if ('\\\\\\\\' == path.substring(0, 2)) return true; // Microsoft Azure absolute path\n};\n\n/**\n * Flatten the given `arr`.\n *\n * @param {Array} arr\n * @return {Array}\n * @api private\n */\n\nexports.flatten = deprecate.function(flatten,\n  'utils.flatten: use array-flatten npm module instead');\n\n/**\n * Normalize the given `type`, for example \"html\" becomes \"text/html\".\n *\n * @param {String} type\n * @return {Object}\n * @api private\n */\n\nexports.normalizeType = function(type){\n  return ~type.indexOf('/')\n    ? acceptParams(type)\n    : { value: mime.lookup(type), params: {} };\n};\n\n/**\n * Normalize `types`, for example \"html\" becomes \"text/html\".\n *\n * @param {Array} types\n * @return {Array}\n * @api private\n */\n\nexports.normalizeTypes = function(types){\n  var ret = [];\n\n  for (var i = 0; i < types.length; ++i) {\n    ret.push(exports.normalizeType(types[i]));\n  }\n\n  return ret;\n};\n\n/**\n * Generate Content-Disposition header appropriate for the filename.\n * non-ascii filenames are urlencoded and a filename* parameter is added\n *\n * @param {String} filename\n * @return {String}\n * @api private\n */\n\nexports.contentDisposition = deprecate.function(contentDisposition,\n  'utils.contentDisposition: use content-disposition npm module instead');\n\n/**\n * Parse accept params `str` returning an\n * object with `.value`, `.quality` and `.params`.\n * also includes `.originalIndex` for stable sorting\n *\n * @param {String} str\n * @return {Object}\n * @api private\n */\n\nfunction acceptParams(str, index) {\n  var parts = str.split(/ *; */);\n  var ret = { value: parts[0], quality: 1, params: {}, originalIndex: index };\n\n  for (var i = 1; i < parts.length; ++i) {\n    var pms = parts[i].split(/ *= */);\n    if ('q' == pms[0]) {\n      ret.quality = parseFloat(pms[1]);\n    } else {\n      ret.params[pms[0]] = pms[1];\n    }\n  }\n\n  return ret;\n}\n\n/**\n * Compile \"etag\" value to function.\n *\n * @param  {Boolean|String|Function} val\n * @return {Function}\n * @api private\n */\n\nexports.compileETag = function(val) {\n  var fn;\n\n  if (typeof val === 'function') {\n    return val;\n  }\n\n  switch (val) {\n    case true:\n      fn = exports.wetag;\n      break;\n    case false:\n      break;\n    case 'strong':\n      fn = exports.etag;\n      break;\n    case 'weak':\n      fn = exports.wetag;\n      break;\n    default:\n      throw new TypeError('unknown value for etag function: ' + val);\n  }\n\n  return fn;\n}\n\n/**\n * Compile \"query parser\" value to function.\n *\n * @param  {String|Function} val\n * @return {Function}\n * @api private\n */\n\nexports.compileQueryParser = function compileQueryParser(val) {\n  var fn;\n\n  if (typeof val === 'function') {\n    return val;\n  }\n\n  switch (val) {\n    case true:\n      fn = querystring.parse;\n      break;\n    case false:\n      fn = newObject;\n      break;\n    case 'extended':\n      fn = parseExtendedQueryString;\n      break;\n    case 'simple':\n      fn = querystring.parse;\n      break;\n    default:\n      throw new TypeError('unknown value for query parser function: ' + val);\n  }\n\n  return fn;\n}\n\n/**\n * Compile \"proxy trust\" value to function.\n *\n * @param  {Boolean|String|Number|Array|Function} val\n * @return {Function}\n * @api private\n */\n\nexports.compileTrust = function(val) {\n  if (typeof val === 'function') return val;\n\n  if (val === true) {\n    // Support plain true/false\n    return function(){ return true };\n  }\n\n  if (typeof val === 'number') {\n    // Support trusting hop count\n    return function(a, i){ return i < val };\n  }\n\n  if (typeof val === 'string') {\n    // Support comma-separated values\n    val = val.split(/ *, */);\n  }\n\n  return proxyaddr.compile(val || []);\n}\n\n/**\n * Set the charset in a given Content-Type string.\n *\n * @param {String} type\n * @param {String} charset\n * @return {String}\n * @api private\n */\n\nexports.setCharset = function setCharset(type, charset) {\n  if (!type || !charset) {\n    return type;\n  }\n\n  // parse type\n  var parsed = contentType.parse(type);\n\n  // set charset\n  parsed.parameters.charset = charset;\n\n  // format type\n  return contentType.format(parsed);\n};\n\n/**\n * Parse an extended query string with qs.\n *\n * @return {Object}\n * @private\n */\n\nfunction parseExtendedQueryString(str) {\n  return qs.parse(str, {\n    allowDots: false,\n    allowPrototypes: true\n  });\n}\n\n/**\n * Return new empty object.\n *\n * @return {Object}\n * @api private\n */\n\nfunction newObject() {\n  return {};\n}\n"]}