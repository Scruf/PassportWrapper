{"version":3,"sources":["manipulation.js"],"names":[],"mappings":"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","file":"manipulation-compiled.js","sourcesContent":["var _ = require('lodash'),\n    parse = require('../parse'),\n    $ = require('../static'),\n    updateDOM = parse.update,\n    evaluate = parse.evaluate,\n    utils = require('../utils'),\n    domEach = utils.domEach,\n    cloneDom = utils.cloneDom,\n    isHtml = utils.isHtml,\n    slice = Array.prototype.slice;\n\n// Create an array of nodes, recursing into arrays and parsing strings if\n// necessary\nexports._makeDomArray = function makeDomArray(elem, clone) {\n  if (elem == null) {\n    return [];\n  } else if (elem.cheerio) {\n    return clone ? cloneDom(elem.get(), elem.options) : elem.get();\n  } else if (Array.isArray(elem)) {\n    return _.flatten(elem.map(function(el) {\n      return this._makeDomArray(el, clone);\n    }, this));\n  } else if (typeof elem === 'string') {\n    return evaluate(elem, this.options);\n  } else {\n    return clone ? cloneDom([elem]) : [elem];\n  }\n};\n\nvar _insert = function(concatenator) {\n  return function() {\n    var elems = slice.call(arguments),\n        lastIdx = this.length - 1;\n\n    return domEach(this, function(i, el) {\n      var dom, domSrc;\n\n      if (typeof elems[0] === 'function') {\n        domSrc = elems[0].call(el, i, $.html(el.children));\n      } else {\n        domSrc = elems;\n      }\n\n      dom = this._makeDomArray(domSrc, i < lastIdx);\n      concatenator(dom, el.children, el);\n    });\n  };\n};\n\n/*\n * Modify an array in-place, removing some number of elements and adding new\n * elements directly following them.\n *\n * @param {Array} array Target array to splice.\n * @param {Number} spliceIdx Index at which to begin changing the array.\n * @param {Number} spliceCount Number of elements to remove from the array.\n * @param {Array} newElems Elements to insert into the array.\n *\n * @api private\n */\nvar uniqueSplice = function(array, spliceIdx, spliceCount, newElems, parent) {\n  var spliceArgs = [spliceIdx, spliceCount].concat(newElems),\n      prev = array[spliceIdx - 1] || null,\n      next = array[spliceIdx] || null;\n  var idx, len, prevIdx, node, oldParent;\n\n  // Before splicing in new elements, ensure they do not already appear in the\n  // current array.\n  for (idx = 0, len = newElems.length; idx < len; ++idx) {\n    node = newElems[idx];\n    oldParent = node.parent || node.root;\n    prevIdx = oldParent && oldParent.children.indexOf(newElems[idx]);\n\n    if (oldParent && prevIdx > -1) {\n      oldParent.children.splice(prevIdx, 1);\n      if (parent === oldParent && spliceIdx > prevIdx) {\n        spliceArgs[0]--;\n      }\n    }\n\n    node.root = null;\n    node.parent = parent;\n\n    if (node.prev) {\n      node.prev.next = node.next || null;\n    }\n\n    if (node.next) {\n      node.next.prev = node.prev || null;\n    }\n\n    node.prev = newElems[idx - 1] || prev;\n    node.next = newElems[idx + 1] || next;\n  }\n\n  if (prev) {\n    prev.next = newElems[0];\n  }\n  if (next) {\n    next.prev = newElems[newElems.length - 1];\n  }\n  return array.splice.apply(array, spliceArgs);\n};\n\nexports.appendTo = function(target) {\n  if (!target.cheerio) {\n    target = this.constructor.call(this.constructor, target, null, this._originalRoot);\n  }\n\n  target.append(this);\n\n  return this;\n};\n\nexports.prependTo = function(target) {\n  if (!target.cheerio) {\n    target = this.constructor.call(this.constructor, target, null, this._originalRoot);\n  }\n\n  target.prepend(this);\n\n  return this;\n};\n\nexports.append = _insert(function(dom, children, parent) {\n  uniqueSplice(children, children.length, 0, dom, parent);\n});\n\nexports.prepend = _insert(function(dom, children, parent) {\n  uniqueSplice(children, 0, 0, dom, parent);\n});\n\nexports.wrap = function(wrapper) {\n  var wrapperFn = typeof wrapper === 'function' && wrapper,\n      lastIdx = this.length - 1;\n\n  _.forEach(this, _.bind(function(el, i) {\n    var parent = el.parent || el.root,\n        siblings = parent.children,\n        dom, index;\n\n    if (!parent) {\n      return;\n    }\n\n    if (wrapperFn) {\n      wrapper = wrapperFn.call(el, i);\n    }\n\n    if (typeof wrapper === 'string' && !isHtml(wrapper)) {\n      wrapper = this.parents().last().find(wrapper).clone();\n    }\n\n    dom = this._makeDomArray(wrapper, i < lastIdx).slice(0, 1);\n    index = siblings.indexOf(el);\n\n    updateDOM([el], dom[0]);\n    // The previous operation removed the current element from the `siblings`\n    // array, so the `dom` array can be inserted without removing any\n    // additional elements.\n    uniqueSplice(siblings, index, 0, dom, parent);\n  }, this));\n\n  return this;\n};\n\nexports.after = function() {\n  var elems = slice.call(arguments),\n      lastIdx = this.length - 1;\n\n  domEach(this, function(i, el) {\n    var parent = el.parent || el.root;\n    if (!parent) {\n      return;\n    }\n\n    var siblings = parent.children,\n        index = siblings.indexOf(el),\n        domSrc, dom;\n\n    // If not found, move on\n    if (index < 0) return;\n\n    if (typeof elems[0] === 'function') {\n      domSrc = elems[0].call(el, i, $.html(el.children));\n    } else {\n      domSrc = elems;\n    }\n    dom = this._makeDomArray(domSrc, i < lastIdx);\n\n    // Add element after `this` element\n    uniqueSplice(siblings, index + 1, 0, dom, parent);\n  });\n\n  return this;\n};\n\nexports.insertAfter = function(target) {\n  var clones = [],\n      self = this;\n  if (typeof target === 'string') {\n    target = this.constructor.call(this.constructor, target, null, this._originalRoot);\n  }\n  target = this._makeDomArray(target);\n  self.remove();\n  domEach(target, function(i, el) {\n    var clonedSelf = self._makeDomArray(self.clone());\n    var parent = el.parent || el.root;\n    if (!parent) {\n      return;\n    }\n\n    var siblings = parent.children,\n        index = siblings.indexOf(el);\n\n    // If not found, move on\n    if (index < 0) return;\n\n    // Add cloned `this` element(s) after target element\n    uniqueSplice(siblings, index + 1, 0, clonedSelf, parent);\n    clones.push(clonedSelf);\n  });\n  return this.constructor.call(this.constructor, this._makeDomArray(clones));\n};\n\nexports.before = function() {\n  var elems = slice.call(arguments),\n      lastIdx = this.length - 1;\n\n  domEach(this, function(i, el) {\n    var parent = el.parent || el.root;\n    if (!parent) {\n      return;\n    }\n\n    var siblings = parent.children,\n        index = siblings.indexOf(el),\n        domSrc, dom;\n\n    // If not found, move on\n    if (index < 0) return;\n\n    if (typeof elems[0] === 'function') {\n      domSrc = elems[0].call(el, i, $.html(el.children));\n    } else {\n      domSrc = elems;\n    }\n\n    dom = this._makeDomArray(domSrc, i < lastIdx);\n\n    // Add element before `el` element\n    uniqueSplice(siblings, index, 0, dom, parent);\n  });\n\n  return this;\n};\n\nexports.insertBefore = function(target) {\n  var clones = [],\n      self = this;\n  if (typeof target === 'string') {\n    target = this.constructor.call(this.constructor, target, null, this._originalRoot);\n  }\n  target = this._makeDomArray(target);\n  self.remove();\n  domEach(target, function(i, el) {\n    var clonedSelf = self._makeDomArray(self.clone());\n    var parent = el.parent || el.root;\n    if (!parent) {\n      return;\n    }\n\n    var siblings = parent.children,\n        index = siblings.indexOf(el);\n\n    // If not found, move on\n    if (index < 0) return;\n\n    // Add cloned `this` element(s) after target element\n    uniqueSplice(siblings, index, 0, clonedSelf, parent);\n    clones.push(clonedSelf);\n  });\n  return this.constructor.call(this.constructor, this._makeDomArray(clones));\n};\n\n/*\n  remove([selector])\n*/\nexports.remove = function(selector) {\n  var elems = this;\n\n  // Filter if we have selector\n  if (selector)\n    elems = elems.filter(selector);\n\n  domEach(elems, function(i, el) {\n    var parent = el.parent || el.root;\n    if (!parent) {\n      return;\n    }\n\n    var siblings = parent.children,\n        index = siblings.indexOf(el);\n\n    if (index < 0) return;\n\n    siblings.splice(index, 1);\n    if (el.prev) {\n      el.prev.next = el.next;\n    }\n    if (el.next) {\n      el.next.prev = el.prev;\n    }\n    el.prev = el.next = el.parent = el.root = null;\n  });\n\n  return this;\n};\n\nexports.replaceWith = function(content) {\n  var self = this;\n\n  domEach(this, function(i, el) {\n    var parent = el.parent || el.root;\n    if (!parent) {\n      return;\n    }\n\n    var siblings = parent.children,\n        dom = self._makeDomArray(typeof content === 'function' ? content.call(el, i, el) : content),\n        index;\n\n    // In the case that `dom` contains nodes that already exist in other\n    // structures, ensure those nodes are properly removed.\n    updateDOM(dom, null);\n\n    index = siblings.indexOf(el);\n\n    // Completely remove old element\n    uniqueSplice(siblings, index, 1, dom, parent);\n    el.parent = el.prev = el.next = el.root = null;\n  });\n\n  return this;\n};\n\nexports.empty = function() {\n  domEach(this, function(i, el) {\n    _.each(el.children, function(el) {\n      el.next = el.prev = el.parent = null;\n    });\n\n    el.children.length = 0;\n  });\n  return this;\n};\n\n/**\n * Set/Get the HTML\n */\nexports.html = function(str) {\n  if (str === undefined) {\n    if (!this[0] || !this[0].children) return null;\n    return $.html(this[0].children, this.options);\n  }\n\n  var opts = this.options;\n\n  domEach(this, function(i, el) {\n    _.each(el.children, function(el) {\n      el.next = el.prev = el.parent = null;\n    });\n\n    var content = str.cheerio ? str.clone().get() : evaluate('' + str, opts);\n\n    updateDOM(content, el);\n  });\n\n  return this;\n};\n\nexports.toString = function() {\n  return $.html(this, this.options);\n};\n\nexports.text = function(str) {\n  // If `str` is undefined, act as a \"getter\"\n  if (str === undefined) {\n    return $.text(this);\n  } else if (typeof str === 'function') {\n    // Function support\n    return domEach(this, function(i, el) {\n      var $el = [el];\n      return exports.text.call($el, str.call(el, i, $.text($el)));\n    });\n  }\n\n  // Append text node to each selected elements\n  domEach(this, function(i, el) {\n    _.each(el.children, function(el) {\n      el.next = el.prev = el.parent = null;\n    });\n\n    var elem = {\n      data: '' + str,\n      type: 'text',\n      parent: el,\n      prev: null,\n      next: null,\n      children: []\n    };\n\n    updateDOM(elem, el);\n  });\n\n  return this;\n};\n\nexports.clone = function() {\n  return this._make(cloneDom(this.get(), this.options));\n};\n"]}