{"version":3,"sources":["history.js"],"names":[],"mappings":"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","file":"history-compiled.js","sourcesContent":["\"use strict\";\nconst whatwgURL = require(\"whatwg-url-compat\");\nconst resolveHref = require(\"../utils\").resolveHref;\n\nfunction StateEntry(data, title, url) {\n  this.data = data;\n  this.title = title;\n  this.url = url;\n}\n\nmodule.exports = History;\n\nfunction History(window) {\n  this._states = [new StateEntry(null, \"\", window._document._URL)];\n  this._index = 0;\n  this._window = window;\n  this._location = window._document._location;\n}\n\nHistory.prototype = {\n  constructor: History,\n\n  get length() {\n    return this._states.length;\n  },\n\n  get state() {\n    const state = this._states[this._index];\n    return state ? state.data : null;\n  },\n\n  back() {\n    this.go(-1);\n  },\n\n  forward() {\n    this.go(1);\n  },\n\n  go(delta) {\n    if (typeof delta === \"undefined\" || delta === 0) {\n      this._location.reload();\n      return;\n    }\n\n    const newIndex = this._index + delta;\n\n    if (newIndex < 0 || newIndex >= this.length) {\n      return;\n    }\n\n    this._index = newIndex;\n\n    const state = this._states[newIndex];\n\n    this._applyState(state);\n    this._signalPopstate(state);\n  },\n\n  pushState(data, title, url) {\n    const state = new StateEntry(data, title, url);\n    if (this._index + 1 !== this._states.length) {\n      this._states = this._states.slice(0, this._index + 1);\n    }\n    this._states.push(state);\n    this._applyState(state);\n    this._index++;\n  },\n\n  replaceState(data, title, url) {\n    const state = new StateEntry(data, title, url);\n    this._states[this._index] = state;\n    this._applyState(state);\n  },\n\n  _applyState(state) {\n    whatwgURL.setTheInput(this._location, resolveHref(this._location.href, state.url));\n  },\n\n  _signalPopstate(state) {\n    if (this._window.document) {\n      const ev = this._window.document.createEvent(\"HTMLEvents\");\n      ev.initEvent(\"popstate\", false, false);\n      ev.state = state.data;\n      process.nextTick(() => this._window.dispatchEvent(ev));\n    }\n  },\n\n  toString() {\n    return \"[object History]\";\n  }\n};\n"]}