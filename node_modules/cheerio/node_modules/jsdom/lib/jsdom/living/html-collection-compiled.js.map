{"version":3,"sources":["html-collection.js"],"names":[],"mappings":"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","file":"html-collection-compiled.js","sourcesContent":["\"use strict\";\nconst lengthFromProperties = require(\"../utils\").lengthFromProperties;\nconst getAttributeValue = require(\"./attributes\").getAttributeValue;\n\nconst privates = Symbol(\"HTMLCollection internal slots\");\n\nclass HTMLCollection {\n  constructor(secret, element, query) {\n    if (secret !== privates) {\n      throw new TypeError(\"Invalid constructor\");\n    }\n\n    this[privates] = { element, query, snapshot: undefined, keys: [], length: 0, version: -1 };\n    updateHTMLCollection(this);\n  }\n\n  get length() {\n    updateHTMLCollection(this);\n    return this[privates].length;\n  }\n\n  item(index) {\n    updateHTMLCollection(this);\n    return this[index] || null;\n  }\n\n  namedItem(name) {\n    updateHTMLCollection(this);\n\n    if (Object.prototype.hasOwnProperty.call(this, name)) {\n      return this[name];\n    }\n    return null;\n  }\n}\n\nfunction updateHTMLCollection(collection) {\n  if (collection[privates].version < collection[privates].element._version) {\n    collection[privates].snapshot = collection[privates].query();\n    resetHTMLCollectionTo(collection, collection[privates].snapshot);\n    collection[privates].version = collection[privates].element._version;\n  }\n}\n\nfunction resetHTMLCollectionTo(collection, els) {\n  const startingLength = lengthFromProperties(collection);\n  for (let i = 0; i < startingLength; ++i) {\n    delete collection[i];\n  }\n\n  for (let i = 0; i < els.length; ++i) {\n    collection[i] = els[i];\n  }\n  collection[privates].length = els.length;\n\n  const keys = collection[privates].keys;\n  for (let i = 0; i < keys.length; ++i) {\n    delete collection[keys[i]];\n  }\n  keys.length = 0;\n\n  for (let i = 0; i < els.length; ++i) {\n    addIfAttrPresent(els[i], \"name\");\n  }\n  for (let i = 0; i < els.length; ++i) {\n    addIfAttrPresent(els[i], \"id\");\n  }\n\n  function addIfAttrPresent(el, attr) {\n    const value = getAttributeValue(el, attr);\n\n    if (value === null || value === \"\") {\n      return;\n    }\n\n    // Don't overwrite numeric indices with named ones.\n    const valueAsNumber = Number(value);\n    if (!Number.isNaN(valueAsNumber) && valueAsNumber >= 0) {\n      return;\n    }\n\n    collection[value] = el;\n    keys.push(value);\n  }\n}\n\nmodule.exports = function (core) {\n  core.HTMLCollection = HTMLCollection;\n};\n\nmodule.exports.create = function (element, query) {\n  return new HTMLCollection(privates, element, query);\n};\n\nmodule.exports.update = updateHTMLCollection;\n"]}