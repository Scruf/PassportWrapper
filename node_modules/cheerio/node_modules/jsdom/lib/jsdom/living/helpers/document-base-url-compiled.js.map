{"version":3,"sources":["document-base-url.js"],"names":[],"mappings":"AAAA;;AACA,MAAM,wBAAwB,QAAQ,cAAR,EAAwB,aAAxB;AAC9B,MAAM,kBAAkB,QAAQ,eAAR,EAAyB,iBAAzB;AACxB,MAAM,MAAM,QAAQ,aAAR,EAAuB,GAAvB;;AAEZ,QAAQ,eAAR,GAA0B,UAAU,QAAV,EAAoB;;;AAG5C,QAAM,YAAY,sBAAsB,QAAtB,EAAgC,YAAhC,CAAZ,CAHsC;AAI5C,QAAM,kBAAkB,QAAQ,eAAR,CAAwB,QAAxB,CAAlB,CAJsC;;AAM5C,MAAI,cAAc,IAAd,EAAoB;AACtB,WAAO,eAAP,CADsB;GAAxB;;AAIA,SAAO,QAAQ,aAAR,CAAsB,SAAtB,EAAiC,eAAjC,CAAP,CAV4C;CAApB;;AAa1B,QAAQ,eAAR,GAA0B,UAAU,QAAV,EAAoB;;;;;AAK5C,MAAI,SAAS,IAAT,KAAkB,aAAlB,IAAmC,SAAS,YAAT,IACnC,SAAS,YAAT,CAAsB,OAAtB,KAAkC,SAAS,YAAT,EAAuB;AAC3D,WAAO,OAAO,OAAP,CAAe,eAAf,CAA+B,SAAS,YAAT,CAAsB,OAAtB,CAA8B,SAA9B,CAAtC,CAD2D;GAD7D;;AAKA,SAAO,SAAS,IAAT,CAVqC;CAApB;;AAa1B,QAAQ,aAAR,GAAwB,UAAU,WAAV,EAAuB,eAAvB,EAAwC;;;;AAI9D,QAAM,oBAAoB,gBAAgB,WAAhB,EAA6B,MAA7B,CAApB,CAJwD;;AAM9D,MAAI;AACF,WAAO,IAAI,GAAJ,CAAQ,iBAAR,EAA2B,eAA3B,EAA4C,IAA5C,CADL;GAAJ,CAEE,OAAO,CAAP,EAAU;AACV,WAAO,eAAP,CADU;GAAV;CARoB","file":"document-base-url-compiled.js","sourcesContent":["\"use strict\";\nconst internalQuerySelector = require(\"../selectors\").querySelector;\nconst internalGetAttr = require(\"../attributes\").getAttributeValue;\nconst URL = require(\"../../utils\").URL;\n\nexports.documentBaseURL = function (document) {\n  // https://html.spec.whatwg.org/multipage/infrastructure.html#document-base-url\n\n  const firstBase = internalQuerySelector(document, \"base[href]\");\n  const fallbackBaseURL = exports.fallbackBaseURL(document);\n\n  if (firstBase === null) {\n    return fallbackBaseURL;\n  }\n\n  return exports.frozenBaseURL(firstBase, fallbackBaseURL);\n};\n\nexports.fallbackBaseURL = function (document) {\n  // https://html.spec.whatwg.org/multipage/infrastructure.html#fallback-base-url\n\n  // Unimplemented: <iframe srcdoc>\n\n  if (document._URL === \"about:blank\" && document._defaultView &&\n      document._defaultView._parent !== document._defaultView) {\n    return module.exports.documentBaseURL(document._defaultView._parent._document);\n  }\n\n  return document._URL;\n};\n\nexports.frozenBaseURL = function (baseElement, fallbackBaseURL) {\n  // https://html.spec.whatwg.org/multipage/semantics.html#frozen-base-url\n  // The spec is eager (setting the frozen base URL when things change); we are lazy (getting it when we need to)\n\n  const baseHrefAttribute = internalGetAttr(baseElement, \"href\");\n\n  try {\n    return new URL(baseHrefAttribute, fallbackBaseURL).href;\n  } catch (e) {\n    return fallbackBaseURL;\n  }\n};\n"]}