{"version":3,"sources":["post-message.js"],"names":[],"mappings":"AAAA;;AACA,MAAM,sBAAsB,QAAQ,UAAR,EAAoB,mBAApB;AAC5B,MAAM,eAAe,QAAQ,yBAAR,CAAf;;AAEN,OAAO,OAAP,GAAiB,UAAU,OAAV,EAAmB,YAAnB,EAAiC;AAChD,MAAI,UAAU,MAAV,GAAmB,CAAnB,EAAsB;AACxB,UAAM,IAAI,SAAJ,CAAc,kEAAd,CAAN,CADwB;GAA1B;;AAIA,iBAAe,OAAO,YAAP,CAAf,CALgD;;AAOhD,MAAI,CAAC,oBAAoB,YAApB,CAAD,EAAoC;AACtC,UAAM,IAAI,YAAJ,CAAiB,aAAa,UAAb,EAAyB,kDAC9C,yBAD8C,GAClB,YADkB,GACH,+BADG,CAAhD,CADsC;GAAxC;;;;AAPgD,MAc5C,iBAAiB,GAAjB,IAAwB,iBAAiB,KAAK,MAAL,EAAa;AACxD,WADwD;GAA1D;;;;;;AAdgD,QAsB1C,QAAQ,IAAI,KAAK,YAAL,CAAkB,SAAtB,EAAiC;AAC7C,UAAM,OAAN;GADY,CAAR,CAtB0C;;AA0BhD,QAAM,SAAN,CAAgB,SAAhB,EAA2B,KAA3B,EAAkC,KAAlC,EA1BgD;;AA4BhD,aAAW,MAAM;AACf,SAAK,aAAL,CAAmB,KAAnB,EADe;GAAN,EAER,CAFH,EA5BgD;CAAjC","file":"post-message-compiled.js","sourcesContent":["\"use strict\";\nconst isValidTargetOrigin = require(\"../utils\").isValidTargetOrigin;\nconst DOMException = require(\"../web-idl/DOMException\");\n\nmodule.exports = function (message, targetOrigin) {\n  if (arguments.length < 2) {\n    throw new TypeError(\"'postMessage' requires 2 arguments: 'message' and 'targetOrigin'\");\n  }\n\n  targetOrigin = String(targetOrigin);\n\n  if (!isValidTargetOrigin(targetOrigin)) {\n    throw new DOMException(DOMException.SYNTAX_ERR, \"Failed to execute 'postMessage' on 'Window': \" +\n      \"Invalid target origin '\" + targetOrigin + \"' in a call to 'postMessage'.\");\n  }\n\n  // TODO: targetOrigin === '/' - requires reference to source window\n  // See https://github.com/tmpvar/jsdom/pull/1140#issuecomment-111587499\n  if (targetOrigin !== \"*\" && targetOrigin !== this.origin) {\n    return;\n  }\n\n  // TODO: event.source - requires reference to source window\n  // TODO: event.origin - requires reference to source window\n  // TODO: event.ports\n  // TODO: event.data - structured clone message - requires cloning DOM nodes\n  const event = new this.MessageEvent(\"message\", {\n    data: message\n  });\n\n  event.initEvent(\"message\", false, false);\n\n  setTimeout(() => {\n    this.dispatchEvent(event);\n  }, 0);\n};\n"]}