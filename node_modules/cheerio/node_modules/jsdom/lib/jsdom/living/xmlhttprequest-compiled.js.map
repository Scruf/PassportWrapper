{"version":3,"sources":["xmlhttprequest.js"],"names":[],"mappings":"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","file":"xmlhttprequest-compiled.js","sourcesContent":["\"use strict\";\n\nconst HTTP_STATUS_CODES = require(\"http\").STATUS_CODES;\nconst spawnSync = require(\"child_process\").spawnSync;\n\nconst xhrUtils = require(\"./xhr-utils\");\nconst DOMException = require(\"../web-idl/DOMException\");\nconst xhrSymbols = require(\"./xmlhttprequest-symbols\");\nconst blobSymbols = require(\"./blob-symbols\");\nconst formDataSymbols = require(\"./form-data-symbols\");\nconst utils = require(\"../utils\");\nconst documentBaseURLHelper = require(\"./helpers/document-base-url\");\n\nconst forbiddenRequestHeaders = new RegExp(\"^(?:\" + [\n  \"Accept-Charset\",\n  \"Accept-Encoding\",\n  \"Access-Control-Request-Headers\",\n  \"Access-Control-Request-Method\",\n  \"Connection\",\n  \"Content-Length\",\n  \"Cookie\",\n  \"Cookie2\",\n  \"Date\",\n  \"DNT\",\n  \"Expect\",\n  \"Host\",\n  \"Keep-Alive\",\n  \"Origin\",\n  \"Referer\",\n  \"TE\",\n  \"Trailer\",\n  \"Transfer-Encoding\",\n  \"Upgrade\",\n  \"User-Agent\",\n  \"Via\",\n  \"Sec-.*\",\n  \"Proxy-.*\"\n].join(\"|\") + \")$\", \"i\");\nconst uniqueResponseHeaders = new RegExp(\"^(?:\" + [\n  \"content-type\",\n  \"content-length\",\n  \"user-agent\",\n  \"referer\",\n  \"host\",\n  \"authorization\",\n  \"proxy-authorization\",\n  \"if-modified-since\",\n  \"if-unmodified-since\",\n  \"from\",\n  \"location\",\n  \"max-forwards\"\n].join(\"|\") + \")$\", \"i\");\n\nconst allowedRequestMethods = [\"OPTIONS\", \"GET\", \"HEAD\", \"POST\", \"PUT\", \"DELETE\"];\nconst forbiddenRequestMethods = [\"TRACK\", \"TRACE\", \"CONNECT\"];\n\nconst tokenRegexp = /^(?:(?![\\x00-\\x1F\\x7F \\t\\(\\)<>@,;:\\\\\"\\/\\[\\]?={}])[\\x00-\\x7F])+$/;\nconst fieldValueRegexp = /^(?:(?![\\x00-\\x1F\\x7F])[\\x00-\\xFF])*$/;\n\nconst XMLHttpRequestResponseType = [\n  \"\",\n  \"arraybuffer\",\n  \"blob\",\n  \"document\",\n  \"json\",\n  \"text\"\n];\n\nmodule.exports = function createXMLHttpRequest(window) {\n  const Event = window.Event;\n  const ProgressEvent = window.ProgressEvent;\n  const Blob = window.Blob;\n  const FormData = window.FormData;\n  const XMLHttpRequestEventTarget = window.XMLHttpRequestEventTarget;\n  const XMLHttpRequestUpload = window.XMLHttpRequestUpload;\n\n  class XMLHttpRequest extends XMLHttpRequestEventTarget {\n    constructor() {\n      super();\n      if (!(this instanceof XMLHttpRequest)) {\n        throw new TypeError(\"DOM object constructor cannot be called as a function.\");\n      }\n      this.upload = new XMLHttpRequestUpload();\n      this.upload._ownerDocument = window.document;\n\n      this[xhrSymbols.flag] = {\n        synchronous: false,\n        withCredentials: false,\n        mimeType: null,\n        auth: null,\n        method: undefined,\n        responseType: \"\",\n        requestHeaders: {},\n        baseUrl: \"\",\n        uri: \"\",\n        userAgent: \"\",\n        timeout: 0,\n        body: undefined,\n        formData: false\n      };\n\n      this[xhrSymbols.properties] = {\n        send: false,\n        timeoutStart: 0,\n        timeoutId: 0,\n        timeoutFn: null,\n        client: null,\n        responseHeaders: {},\n        responseBuffer: null,\n        responseCache: null,\n        responseTextCache: null,\n        responseXMLCache: null,\n        readyState: XMLHttpRequest.UNSENT,\n        status: 0,\n        statusText: \"\"\n      };\n      this.onreadystatechange = null;\n    }\n    get readyState() {\n      return this[xhrSymbols.properties].readyState;\n    }\n    get status() {\n      return this[xhrSymbols.properties].status;\n    }\n    get statusText() {\n      return this[xhrSymbols.properties].statusText;\n    }\n    get responseType() {\n      return this[xhrSymbols.flag].responseType;\n    }\n    set responseType(responseType) {\n      const flag = this[xhrSymbols.flag];\n      if (this.readyState === XMLHttpRequest.LOADING || this.readyState === XMLHttpRequest.DONE) {\n        throw new DOMException(DOMException.INVALID_STATE_ERR);\n      }\n      if (this.readyState === XMLHttpRequest.OPENED && flag.synchronous) {\n        throw new DOMException(DOMException.INVALID_ACCESS_ERR);\n      }\n      if (XMLHttpRequestResponseType.indexOf(responseType) === -1) {\n        responseType = \"\";\n      }\n      flag.responseType = responseType;\n    }\n    get response() {\n      const properties = this[xhrSymbols.properties];\n      if (properties.responseCache) {\n        return properties.responseCache;\n      }\n      let res = \"\";\n      switch (this.responseType) {\n        case \"\":\n        case \"text\":\n          res = this.responseText;\n          break;\n        case \"arraybuffer\":\n          if (!properties.responseBuffer) {\n            return null;\n          }\n          res = (new Uint8Array(properties.responseBuffer)).buffer;\n          break;\n        case \"blob\":\n          if (!properties.responseBuffer) {\n            return null;\n          }\n          res = new Blob([(new Uint8Array(properties.responseBuffer)).buffer]);\n          break;\n        case \"document\":\n          res = this.responseXML;\n          break;\n        case \"json\":\n          if (this.readyState !== XMLHttpRequest.DONE || !properties.responseBuffer) {\n            res = null;\n          }\n          try {\n            res = JSON.parse(properties.responseBuffer.toString());\n          } catch (e) {\n            res = null;\n          }\n          break;\n      }\n      properties.responseCache = res;\n      return res;\n    }\n    get responseText() {\n      const properties = this[xhrSymbols.properties];\n      if (this.responseType !== \"\" && this.responseType !== \"text\") {\n        throw new DOMException(DOMException.INVALID_STATE_ERR);\n      }\n      if (this.readyState !== XMLHttpRequest.LOADING && this.readyState !== XMLHttpRequest.DONE) {\n        return \"\";\n      }\n      if (properties.responseTextCache) {\n        return properties.responseTextCache;\n      }\n      const responseBuffer = properties.responseBuffer;\n      if (!responseBuffer) {\n        return \"\";\n      }\n      const res = responseBuffer.toString();\n      properties.responseTextCache = res;\n      return res;\n    }\n    get responseXML() {\n      const flag = this[xhrSymbols.flag];\n      const properties = this[xhrSymbols.properties];\n      if (this.responseType !== \"\" && this.responseType !== \"document\") {\n        throw new DOMException(DOMException.INVALID_STATE_ERR);\n      }\n      if (this.readyState !== XMLHttpRequest.DONE) {\n        return null;\n      }\n      if (properties.responseXMLCache) {\n        return properties.responseXMLCache;\n      }\n      const contentType = flag.mimeType || this.getResponseHeader(\"Content-Type\");\n      if (contentType && !contentType.match(/^(?:text\\/html|text\\/xml|application\\/xml|.*?\\+xml)(?:;.*)*$/)) {\n        return null;\n      }\n      const responseBuffer = properties.responseBuffer;\n      if (!responseBuffer) {\n        return null;\n      }\n      const resText = responseBuffer.toString();\n      const res = new window.Document({ parsingMode: \"xml\" });\n      res._htmlToDom.appendHtmlToDocument(resText, res);\n      properties.responseXMLCache = res;\n      return res;\n    }\n    get timeout() {\n      return this[xhrSymbols.flag].timeout;\n    }\n    set timeout(val) {\n      const flag = this[xhrSymbols.flag];\n      const properties = this[xhrSymbols.properties];\n      if (flag.synchronous) {\n        throw new DOMException(DOMException.INVALID_ACCESS_ERR);\n      }\n      flag.timeout = val;\n      clearTimeout(properties.timeoutId);\n      if (val > 0 && properties.timeoutFn) {\n        properties.timeoutId = setTimeout(\n          properties.timeoutFn,\n          Math.max(0, val - ((new Date()).getTime() - properties.timeoutStart))\n        );\n      } else {\n        properties.timeoutFn = null;\n        properties.timeoutStart = 0;\n      }\n    }\n    get withCredentials() {\n      return this[xhrSymbols.flag].withCredentials;\n    }\n    set withCredentials(val) {\n      const flag = this[xhrSymbols.flag];\n      const properties = this[xhrSymbols.properties];\n      if (!(this.readyState === XMLHttpRequest.UNSENT || this.readyState === XMLHttpRequest.OPENED)) {\n        throw new DOMException(DOMException.INVALID_STATE_ERR);\n      }\n      if (properties.send) {\n        throw new DOMException(DOMException.INVALID_STATE_ERR);\n      }\n      if (flag.synchronous) {\n        throw new DOMException(DOMException.INVALID_ACCESS_ERR);\n      }\n      flag.withCredentials = val;\n    }\n\n    abort() {\n      const flag = this[xhrSymbols.flag];\n      const properties = this[xhrSymbols.properties];\n      clearTimeout(properties.timeoutId);\n      properties.timeoutFn = null;\n      properties.timeoutStart = 0;\n      const client = properties.client;\n      if (client) {\n        client.abort();\n      }\n      if (!(this.readyState === XMLHttpRequest.UNSENT ||\n          (this.readyState === XMLHttpRequest.OPENED && !properties.send) ||\n          this.readyState === XMLHttpRequest.DONE)) {\n        properties.send = false;\n        readyStateChange(this, XMLHttpRequest.DONE);\n        if (!(flag.method === \"HEAD\" || flag.method === \"GET\")) {\n          this.upload.dispatchEvent(new ProgressEvent(\"progress\"));\n          this.upload.dispatchEvent(new ProgressEvent(\"abort\"));\n          this.upload.dispatchEvent(new ProgressEvent(\"loadend\"));\n        }\n        this.dispatchEvent(new ProgressEvent(\"progress\"));\n        this.dispatchEvent(new ProgressEvent(\"abort\"));\n        this.dispatchEvent(new ProgressEvent(\"loadend\"));\n      }\n      properties.readyState = XMLHttpRequest.UNSENT;\n    }\n    getAllResponseHeaders() {\n      const properties = this[xhrSymbols.properties];\n      const readyState = this.readyState;\n      if ([XMLHttpRequest.UNSENT, XMLHttpRequest.OPENED].indexOf(readyState) >= 0) {\n        return \"\";\n      }\n      return Object.keys(properties.responseHeaders)\n        .filter(key => {\n          const keyLc = key.toLowerCase();\n          return keyLc !== \"set-cookie\" && keyLc !== \"set-cookie2\";\n        })\n        .map(key => {\n          return [key, properties.responseHeaders[key]].join(\": \");\n        }, this).join(\"\\r\\n\");\n    }\n\n    getResponseHeader(header) {\n      const properties = this[xhrSymbols.properties];\n      const readyState = this.readyState;\n      if ([XMLHttpRequest.UNSENT, XMLHttpRequest.OPENED].indexOf(readyState) >= 0) {\n        return null;\n      }\n      const keys = Object.keys(properties.responseHeaders);\n      let n = keys.length;\n      const responseHeaders = {};\n      while (n--) {\n        const key = keys[n];\n        responseHeaders[key.toLowerCase()] = properties.responseHeaders[key];\n      }\n      const key = header.toLowerCase();\n      if (key === \"set-cookie\" || key === \"set-cookie2\") {\n        return null;\n      }\n      const value = responseHeaders[key];\n      return typeof value !== \"undefined\" ? String(value) : null;\n    }\n\n    open(method, uri, async, user, password) {\n      const flag = this[xhrSymbols.flag];\n      const properties = this[xhrSymbols.properties];\n      const argumentCount = arguments.length;\n      if (argumentCount < 2) {\n        throw new TypeError(\"Not enought arguments\");\n      }\n      if (!tokenRegexp.test(method)) {\n        throw new DOMException(DOMException.SYNTAX_ERR);\n      }\n      const upperCaseMethod = method.toUpperCase();\n      if (forbiddenRequestMethods.indexOf(upperCaseMethod) !== -1) {\n        throw new DOMException(DOMException.SECURITY_ERR);\n      }\n\n      const client = properties.client;\n      if (client && typeof client.abort === \"function\") {\n        client.abort();\n      }\n\n      if (allowedRequestMethods.indexOf(upperCaseMethod) !== -1) {\n        method = upperCaseMethod;\n      }\n      if (typeof async !== \"undefined\") {\n        flag.synchronous = !async;\n      } else {\n        flag.synchronous = false;\n      }\n      if (flag.responseType && flag.synchronous) {\n        throw new DOMException(DOMException.INVALID_ACCESS_ERR);\n      }\n      if (flag.synchronous && flag.timeout) {\n        throw new DOMException(DOMException.INVALID_ACCESS_ERR);\n      }\n      flag.method = method;\n\n      const baseUrl = documentBaseURLHelper.documentBaseURL(this._ownerDocument).toString();\n      flag.baseUrl = baseUrl;\n      const urlObj = new utils.URL(uri, baseUrl);\n      flag.uri = urlObj.href;\n\n      flag.userAgent = this._ownerDocument._defaultView.navigator.userAgent;\n\n      if (argumentCount >= 4 && (user || password)) {\n        flag.auth = {\n          user,\n          pass: password\n        };\n      }\n      flag.requestHeaders = {};\n      properties.send = false;\n      properties.requestBuffer = null;\n      properties.requestCache = null;\n      readyStateChange(this, XMLHttpRequest.OPENED);\n    }\n\n    overrideMimeType(mime) {\n      if ([XMLHttpRequest.LOADING, XMLHttpRequest.DONE].indexOf(this.readyState) >= 0) {\n        throw new DOMException(DOMException.INVALID_STATE_ERR);\n      }\n      this[xhrSymbols.flag].mimeType = mime;\n    }\n\n    send(body) {\n      const flag = this[xhrSymbols.flag];\n      const properties = this[xhrSymbols.properties];\n      const self = this;\n      if (this.readyState !== XMLHttpRequest.OPENED || properties.send) {\n        throw new DOMException(DOMException.INVALID_STATE_ERR);\n      }\n\n      if (!flag.body &&\n          body !== undefined &&\n          body !== null &&\n          body !== \"\" &&\n          !(flag.method === \"HEAD\" || flag.method === \"GET\")) {\n        if (body instanceof FormData) {\n          flag.formData = true;\n          const formData = [];\n          for (const entry of body[formDataSymbols.entries]) {\n            let val;\n            if (entry.value instanceof Blob) {\n              const blob = entry.value;\n              val = {\n                name: entry.name,\n                value: blob[blobSymbols.buffer],\n                options: {\n                  filename: blob.name,\n                  contentType: blob.type,\n                  knownLength: blob.size\n                }\n              };\n            } else {\n              val = entry;\n            }\n            formData.push(val);\n          }\n          flag.body = formData;\n        } else if (body instanceof Blob) {\n          flag.body = body[blobSymbols.buffer];\n        } else if (body instanceof ArrayBuffer) {\n          flag.body = new Buffer(new Uint8Array(body));\n        } else if (typeof body !== \"string\") {\n          flag.body = String(body);\n        } else {\n          flag.body = body;\n        }\n      }\n\n      if (flag.synchronous) {\n        const flagStr = JSON.stringify(flag);\n        const res = spawnSync(\n          process.execPath,\n          [require.resolve(\"./xhr-sync-worker.js\")],\n          {\n            input: flagStr\n          }\n        );\n        if (res.status !== 0) {\n          throw new Error(res.stderr.toString());\n        }\n        if (res.error) {\n          if (typeof res.error === \"string\") {\n            res.error = new Error(res.error);\n          }\n          throw res.error;\n        }\n        const response = JSON.parse(res.stdout.toString(), (k, v) => {\n          if (k === \"responseBuffer\" && v && v.data) {\n            return new Buffer(v.data);\n          }\n          return v;\n        });\n        response.properties.readyState = XMLHttpRequest.LOADING;\n        this[xhrSymbols.properties] = response.properties;\n\n        readyStateChange(self, XMLHttpRequest.DONE);\n        if (response.error) {\n          this.dispatchEvent(new ProgressEvent(\"error\"));\n          this.dispatchEvent(new ProgressEvent(\"loadend\"));\n          throw new DOMException(DOMException.NETWORK_ERR, response.error);\n        } else {\n          const responseBuffer = this[xhrSymbols.properties].responseBuffer;\n          const contentLength = this.getResponseHeader(\"content-length\") || \"0\";\n          const bufferLength = parseInt(contentLength, 10) || responseBuffer.length;\n          const progressObj = { lengthComputable: false };\n          if (bufferLength !== 0) {\n            progressObj.total = bufferLength;\n            progressObj.loaded = bufferLength;\n            progressObj.lengthComputable = true;\n          }\n          this.dispatchEvent(new ProgressEvent(\"load\"));\n          this.dispatchEvent(new ProgressEvent(\"loadend\", progressObj));\n        }\n      } else {\n        properties.send = true;\n\n        this.dispatchEvent(new ProgressEvent(\"loadstart\"));\n\n        const client = xhrUtils.createClient(this,\n          (err, response) => {\n            if (err) {\n              if (client) {\n                client.removeAllListeners();\n              }\n              readyStateChange(self, XMLHttpRequest.DONE);\n              if (!(flag.method === \"HEAD\" || flag.method === \"GET\")) {\n                self.upload.dispatchEvent(new ProgressEvent(\"error\", err));\n                self.upload.dispatchEvent(new ProgressEvent(\"loadend\"));\n              }\n              self.dispatchEvent(new ProgressEvent(\"error\", err));\n              self.dispatchEvent(new ProgressEvent(\"loadend\"));\n              return;\n            }\n            receiveResponse(self, response);\n          }\n        );\n        properties.client = client;\n        if (client) {\n          if (body !== undefined &&\n            body !== null &&\n            body !== \"\" &&\n            !(flag.method === \"HEAD\" || flag.method === \"GET\")) {\n            setDispatchProgressEvents(this);\n          }\n          if (this.timeout > 0) {\n            properties.timeoutStart = (new Date()).getTime();\n            properties.timeoutFn = function () {\n              client.abort();\n              if (!(self.readyState === XMLHttpRequest.UNSENT ||\n                  (self.readyState === XMLHttpRequest.OPENED && !properties.send) ||\n                  self.readyState === XMLHttpRequest.DONE)) {\n                properties.send = false;\n                readyStateChange(self, XMLHttpRequest.DONE);\n                if (!(flag.method === \"HEAD\" || flag.method === \"GET\")) {\n                  self.upload.dispatchEvent(new ProgressEvent(\"progress\"));\n                  self.upload.dispatchEvent(new ProgressEvent(\"timeout\"));\n                  self.upload.dispatchEvent(new ProgressEvent(\"loadend\"));\n                }\n                self.dispatchEvent(new ProgressEvent(\"progress\"));\n                self.dispatchEvent(new ProgressEvent(\"timeout\"));\n                self.dispatchEvent(new ProgressEvent(\"loadend\"));\n              }\n              properties.readyState = XMLHttpRequest.UNSENT;\n            };\n            properties.timeoutId = setTimeout(properties.timeoutFn, this.timeout);\n          }\n        }\n      }\n      flag.body = undefined;\n      flag.formData = false;\n    }\n\n    setRequestHeader(header, value) {\n      const flag = this[xhrSymbols.flag];\n      const properties = this[xhrSymbols.properties];\n      if (arguments.length !== 2) {\n        throw new TypeError();\n      }\n      value = String(value);\n      if (!tokenRegexp.test(header) || !fieldValueRegexp.test(value)) {\n        throw new DOMException(DOMException.SYNTAX_ERR);\n      }\n      if (this.readyState !== XMLHttpRequest.OPENED || properties.send) {\n        throw new DOMException(DOMException.INVALID_STATE_ERR);\n      }\n      if (forbiddenRequestHeaders.test(header)) {\n        return;\n      }\n      const keys = Object.keys(flag.requestHeaders);\n      let n = keys.length;\n      while (n--) {\n        const key = keys[n];\n        if (key.toLowerCase() === header.toLowerCase()) {\n          flag.requestHeaders[key] += \", \" + value;\n          return;\n        }\n      }\n      flag.requestHeaders[header] = value;\n    }\n\n    toString() {\n      return \"[object XMLHttpRequest]\";\n    }\n\n    get _ownerDocument() {\n      return window.document;\n    }\n  }\n\n  utils.addConstants(XMLHttpRequest, {\n    UNSENT: 0,\n    OPENED: 1,\n    HEADERS_RECEIVED: 2,\n    LOADING: 3,\n    DONE: 4\n  });\n\n  function readyStateChange(xhr, readyState) {\n    if (xhr.readyState !== readyState) {\n      const readyStateChangeEvent = new Event(\"readystatechange\");\n      const properties = xhr[xhrSymbols.properties];\n      properties.readyState = readyState;\n      xhr.dispatchEvent(readyStateChangeEvent);\n    }\n  }\n\n  function receiveResponse(xhr, response) {\n    const properties = xhr[xhrSymbols.properties];\n    let byteOffset = 0;\n    const statusCode = response.statusCode;\n\n    properties.status = statusCode;\n    properties.statusText = response.statusMessage || HTTP_STATUS_CODES[statusCode] || \"OK\";\n\n    const headers = {};\n    const headerMap = {};\n    const rawHeaders = response.rawHeaders;\n    const n = Number(rawHeaders.length);\n    for (let i = 0; i < n; i += 2) {\n      const k = rawHeaders[i];\n      const kl = k.toLowerCase();\n      const v = rawHeaders[i + 1];\n      if (k.match(uniqueResponseHeaders)) {\n        if (headerMap[kl] !== undefined) {\n          delete headers[headerMap[kl]];\n        }\n        headers[k] = v;\n      } else if (headerMap[kl] !== undefined) {\n        headers[headerMap[kl]] += \", \" + v;\n      } else {\n        headers[k] = v;\n      }\n      headerMap[kl] = k;\n    }\n    properties.responseHeaders = headers;\n    const contentLength = xhr.getResponseHeader(\"content-length\") || \"0\";\n    const bufferLength = parseInt(contentLength, 10) || 0;\n    const progressObj = { lengthComputable: false };\n    if (bufferLength !== 0) {\n      progressObj.total = bufferLength;\n      progressObj.loaded = 0;\n      progressObj.lengthComputable = true;\n    }\n    properties.responseBuffer = new Buffer(0);\n    properties.responseCache = null;\n    properties.responseTextCache = null;\n    properties.responseXMLCache = null;\n    readyStateChange(xhr, XMLHttpRequest.HEADERS_RECEIVED);\n    properties.client.on(\"data\", chunk => {\n      properties.responseBuffer = Buffer.concat([properties.responseBuffer, chunk]);\n      properties.responseCache = null;\n      properties.responseTextCache = null;\n      properties.responseXMLCache = null;\n    });\n    response.on(\"data\", chunk => {\n      byteOffset += chunk.length;\n      progressObj.loaded = byteOffset;\n      readyStateChange(xhr, XMLHttpRequest.LOADING);\n      if (progressObj.total !== progressObj.loaded) {\n        xhr.dispatchEvent(new ProgressEvent(\"progress\", progressObj));\n      }\n    });\n    properties.client.on(\"end\", () => {\n      clearTimeout(properties.timeoutId);\n      properties.timeoutFn = null;\n      properties.timeoutStart = 0;\n      properties.client = null;\n      readyStateChange(xhr, XMLHttpRequest.DONE);\n      xhr.dispatchEvent(new ProgressEvent(\"load\"));\n      xhr.dispatchEvent(new ProgressEvent(\"loadend\", progressObj));\n    });\n  }\n\n  function setDispatchProgressEvents(xhr) {\n    const client = xhr[xhrSymbols.properties].client;\n\n    client.on(\"request\", req => {\n      xhr.upload.dispatchEvent(new ProgressEvent(\"loadstart\"));\n      req.on(\"response\", () => {\n        let total = 0;\n        let lengthComputable = false;\n        const length = parseInt(xhrUtils.getRequestHeader(client.headers, \"content-length\"), 10);\n        if (length) {\n          total = length;\n          lengthComputable = true;\n        }\n        const progress = {\n          lengthComputable,\n          total,\n          loaded: total\n        };\n        xhr.upload.dispatchEvent(new ProgressEvent(\"progress\", progress));\n\n        xhr.upload.dispatchEvent(new ProgressEvent(\"load\"));\n        xhr.upload.dispatchEvent(new ProgressEvent(\"loadend\"));\n      });\n    });\n  }\n\n  return XMLHttpRequest;\n};\n"]}