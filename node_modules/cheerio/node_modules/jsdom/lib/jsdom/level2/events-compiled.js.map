{"version":3,"sources":["events.js"],"names":[],"mappings":"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","file":"events-compiled.js","sourcesContent":["\"use strict\";\n/* DOM Level2 Events implemented as described here:\n *\n * http://www.w3.org/TR/2000/REC-DOM-Level-2-Events-20001113/events.html\n *\n */\nvar core = require(\"../level1/core\"),\n    utils = require(\"../utils\"),\n    defineGetter = utils.defineGetter,\n    defineSetter = utils.defineSetter,\n    inheritFrom = utils.inheritFrom;\n\n// The dependencies here are a bit screwy; when we get a chance to move all events to living, things will get simpler.\nconst Event = require(\"../living/generated/Event\");\nconst CustomEvent = require(\"../living/generated/CustomEvent\");\nconst MessageEvent = require(\"../living/generated/MessageEvent\");\nconst ErrorEvent = require(\"../living/generated/ErrorEvent\");\nconst HashChangeEvent = require(\"../living/generated/HashChangeEvent\");\nconst UIEvent = require(\"../living/generated/UIEvent\");\nconst MouseEvent = require(\"../living/generated/MouseEvent\");\nconst KeyboardEvent = require(\"../living/generated/KeyboardEvent\");\nconst TouchEvent = require(\"../living/generated/TouchEvent\");\nconst MutationEvent = require(\"../living/generated/MutationEvent\");\nconst ProgressEvent = require(\"../living/generated/ProgressEvent\");\nconst domSymbolTree = require(\"../living/helpers/internal-constants\").domSymbolTree;\nconst NODE_TYPE = require(\"../living/node-type\");\n\ncore.Event = Event.interface;\ncore.CustomEvent = CustomEvent.interface;\ncore.MessageEvent = MessageEvent.interface;\ncore.ErrorEvent = ErrorEvent.interface;\ncore.HashChangeEvent = HashChangeEvent.interface;\ncore.UIEvent = UIEvent.interface;\ncore.MouseEvent = MouseEvent.interface;\ncore.KeyboardEvent = KeyboardEvent.interface;\ncore.TouchEvent = TouchEvent.interface;\ncore.MutationEvent = MutationEvent.interface;\ncore.ProgressEvent = ProgressEvent.interface;\n\ncore.EventTarget = require('../living/generated/EventTarget').interface;\n\n// Reinherit class heirarchy with EventTarget at its root\ninheritFrom(core.EventTarget, core.Node, core.Node.prototype);\n\n// Node\ninheritFrom(core.Node, core.Document, core.Document.prototype);\ninheritFrom(core.Node, core.DocumentFragment, core.DocumentFragment.prototype);\ninheritFrom(core.Node, core.Element, core.Element.prototype);\n\n\nfunction getDocument(el) {\n  return el.nodeType == NODE_TYPE.DOCUMENT_NODE ? el : el._ownerDocument;\n}\n\nfunction mutationEventsEnabled(el) {\n  return el.nodeType != NODE_TYPE.ATTRIBUTE_NODE &&\n         getDocument(el).implementation._hasFeature('MutationEvents');\n}\n\nvar insertBefore_super = core.Node.prototype.insertBefore;\ncore.Node.prototype.insertBefore = function(newChild, refChild) {\n  var ret = insertBefore_super.apply(this, arguments);\n  if (mutationEventsEnabled(this)) {\n    var doc = getDocument(this),\n        ev = doc.createEvent(\"MutationEvents\");\n\n    ev.initMutationEvent(\"DOMNodeInserted\", true, false, this, null, null, null, null);\n    newChild.dispatchEvent(ev);\n\n    ev = doc.createEvent(\"MutationEvents\");\n    ev.initMutationEvent(\"DOMSubtreeModified\", true, false, this, null, null, null, null);\n    this.dispatchEvent(ev);\n\n    if (this.nodeType == NODE_TYPE.DOCUMENT_NODE || this._attachedToDocument) {\n      ev = doc.createEvent(\"MutationEvents\");\n      ev.initMutationEvent(\"DOMNodeInsertedIntoDocument\", false, false, null, null, null, null, null);\n\n      for (const el of domSymbolTree.treeIterator(newChild)) {\n        if (el.nodeType == NODE_TYPE.ELEMENT_NODE) {\n          el.dispatchEvent(ev);\n          el._attachedToDocument = true;\n        }\n      }\n    }\n  }\n  return ret;\n};\n\nvar removeChild_super = core.Node.prototype.removeChild;\ncore.Node.prototype.removeChild = function (oldChild) {\n  if (mutationEventsEnabled(this)) {\n    var doc = getDocument(this),\n        ev = doc.createEvent(\"MutationEvents\");\n\n    ev.initMutationEvent(\"DOMNodeRemoved\", true, false, this, null, null, null, null);\n    oldChild.dispatchEvent(ev);\n\n    ev = doc.createEvent(\"MutationEvents\");\n    ev.initMutationEvent(\"DOMSubtreeModified\", true, false, this, null, null, null, null);\n    this.dispatchEvent(ev);\n\n    ev = doc.createEvent(\"MutationEvents\");\n    ev.initMutationEvent(\"DOMNodeRemovedFromDocument\", false, false, null, null, null, null, null);\n    for (const el of domSymbolTree.treeIterator(oldChild)) {\n      if (el.nodeType == NODE_TYPE.ELEMENT_NODE) {\n        el.dispatchEvent(ev);\n        el._attachedToDocument = false;\n      }\n    }\n  }\n  return removeChild_super.apply(this, arguments);\n};\n\n\nvar _attrModified_super = core.Node.prototype._attrModified;\ncore.Node.prototype._attrModified = function (name, value, oldValue) {\n    var ret = _attrModified_super.apply(this, arguments);\n    if (mutationEventsEnabled(this) && value !== oldValue) {\n        var doc = getDocument(this),\n            ev = doc.createEvent(\"MutationEvents\");\n\n        ev.initMutationEvent(\"DOMSubtreeModified\", true, false, this, null, null, null, null);\n        this.dispatchEvent(ev);\n    }\n    return ret;\n};\n\nvar interfaceTable = {\n  event: Event,\n  events: Event,\n  htmlevents: Event,\n  mouseevent: MouseEvent,\n  mouseevents: MouseEvent,\n  uievent: UIEvent,\n  uievents: UIEvent,\n  messageevent: MessageEvent,\n\n  customevent: CustomEvent,\n  keyboardevent: KeyboardEvent,\n  keyevents: KeyboardEvent,\n  touchevent: TouchEvent,\n\n  // old, not part of spec anymore\n  mutationevents: MutationEvent\n};\n\ncore.Document.prototype.createEvent = function (type) {\n  var typeLower = type.toLowerCase();\n  var Event = interfaceTable[typeLower] || null;\n\n  if (!Event) {\n    throw new core.DOMException(core.DOMException.NOT_SUPPORTED_ERR,\n      \"The provided event type (\\\"\" + type + \"\\\") is invalid\");\n  }\n\n  return Event.create([\"\"]);\n};\n"]}