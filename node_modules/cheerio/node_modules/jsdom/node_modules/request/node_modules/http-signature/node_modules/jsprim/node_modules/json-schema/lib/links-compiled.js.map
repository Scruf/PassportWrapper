{"version":3,"sources":["links.js"],"names":[],"mappings":";;;;;AAKA,CAAC,EAAC,QAAO,OAAO,MAAP,IAAe,WAAf,GAA2B,MAA3B,GAAkC,UAAS,IAAT,EAAe,OAAf,EAAuB;AAAC,SAAO,OAAP,GAAiB,SAAjB,CAAD;EAAvB,GAA3C,CACA,MADA,CACO,EADP,EACW,YAAU;AACrB,KAAI,UAAU,EAAV,CADiB;AAErB,SAAQ,UAAR,GAAqB,IAArB,CAFqB;AAGrB,SAAQ,OAAR,GAAkB,UAAS,QAAT,EAAmB,QAAnB,EAA6B,MAA7B,EAAoC;;;;;;;;AAQrD,MAAI,QAAQ,OAAO,eAAP,CARyC;AASrD,MAAG,CAAC,KAAD,EAAO;AACT,WAAQ,EAAR,CADS;AAET,OAAI,cAAc,OAAO,KAAP,CAFT;AAGT,OAAG,eAAe,uBAAuB,KAAvB,EAA6B;AAC9C,gBAAY,OAAZ,CAAoB,UAAS,IAAT,EAAc;;;;;;;AAOjC,WAAM,KAAK,GAAL,CAAN,GAAkB,KAAK,IAAL,CAPe;KAAd,CAApB,CAD8C;IAA/C;AAWA,OAAG,QAAQ,UAAR,EAAmB;AACrB,WAAO,eAAP,GAAyB,KAAzB,CADqB;IAAtB;GAdD;AAkBA,MAAI,eAAe,MAAM,QAAN,CAAf,CA3BiD;AA4BrD,SAAO,gBAAgB,QAAQ,UAAR,CAAmB,YAAnB,EAAiC,QAAjC,CAAhB,CA5B8C;EAApC,CAHG;;AAkCrB,SAAQ,UAAR,GAAqB,UAAS,YAAT,EAAuB,QAAvB,EAAgC;AACpD,SAAO,aAAa,OAAb,CAAqB,eAArB,EAAsC,UAAS,CAAT,EAAY,QAAZ,EAAqB;AAChE,OAAI,QAAQ,SAAS,mBAAmB,QAAnB,CAAT,CAAR,CAD4D;AAEhE,OAAG,iBAAiB,KAAjB,EAAuB;;AAEzB,WAAO,MAAM,MAAM,IAAN,CAAW,GAAX,CAAN,GAAwB,GAAxB,CAFkB;IAA1B;AAIA,UAAO,KAAP,CANgE;GAArB,CAA7C,CADoD;EAAhC,CAlCA;AA4CrB,QAAO,OAAP,CA5CqB;CAAV,CADX","file":"links-compiled.js","sourcesContent":["/** \r\n * JSON Schema link handler\r\n * Copyright (c) 2007 Kris Zyp SitePen (www.sitepen.com)\r\n * Licensed under the MIT (MIT-LICENSE.txt) license.\r\n */\r\n({define:typeof define!=\"undefined\"?define:function(deps, factory){module.exports = factory();}}).\r\ndefine([], function(){\r\nvar exports = {};\r\nexports.cacheLinks = true;\r\nexports.getLink = function(relation, instance, schema){\r\n\t// gets the URI of the link for the given relation based on the instance and schema\r\n\t// for example:\r\n\t// getLink(\r\n\t// \t\t\"brother\", \r\n\t// \t\t{\"brother_id\":33}, \r\n\t// \t\t{links:[{rel:\"brother\", href:\"Brother/{brother_id}\"}]}) ->\r\n\t//\t\"Brother/33\"\r\n\tvar links = schema.__linkTemplates; \r\n\tif(!links){\r\n\t\tlinks = {};\r\n\t\tvar schemaLinks = schema.links;\r\n\t\tif(schemaLinks && schemaLinks instanceof Array){\r\n\t\t\tschemaLinks.forEach(function(link){\r\n\t/*\t\t\t// TODO: allow for multiple same-name relations\r\n\t\t\t\tif(links[link.rel]){\r\n\t\t\t\t\tif(!(links[link.rel] instanceof Array)){\r\n\t\t\t\t\t\tlinks[link.rel] = [links[link.rel]];\r\n\t\t\t\t\t}\r\n\t\t\t\t}*/\r\n\t\t\t\tlinks[link.rel] = link.href;\r\n\t\t\t});\r\n\t\t}\r\n\t\tif(exports.cacheLinks){\r\n\t\t\tschema.__linkTemplates = links;\r\n\t\t}\r\n\t}\r\n\tvar linkTemplate = links[relation];\r\n\treturn linkTemplate && exports.substitute(linkTemplate, instance);\r\n};\r\n\r\nexports.substitute = function(linkTemplate, instance){\r\n\treturn linkTemplate.replace(/\\{([^\\}]*)\\}/g, function(t, property){\r\n\t\t\tvar value = instance[decodeURIComponent(property)];\r\n\t\t\tif(value instanceof Array){\r\n\t\t\t\t// the value is an array, it should produce a URI like /Table/(4,5,8) and store.get() should handle that as an array of values\r\n\t\t\t\treturn '(' + value.join(',') + ')';\r\n\t\t\t}\r\n\t\t\treturn value;\r\n\t\t});\r\n};\r\nreturn exports;\r\n});"]}