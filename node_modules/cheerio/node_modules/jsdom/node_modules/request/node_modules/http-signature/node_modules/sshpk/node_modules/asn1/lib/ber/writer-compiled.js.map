{"version":3,"sources":["writer.js"],"names":[],"mappings":"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","file":"writer-compiled.js","sourcesContent":["// Copyright 2011 Mark Cavage <mcavage@gmail.com> All rights reserved.\n\nvar assert = require('assert');\nvar ASN1 = require('./types');\nvar errors = require('./errors');\n\n\n///--- Globals\n\nvar newInvalidAsn1Error = errors.newInvalidAsn1Error;\n\nvar DEFAULT_OPTS = {\n  size: 1024,\n  growthFactor: 8\n};\n\n\n///--- Helpers\n\nfunction merge(from, to) {\n  assert.ok(from);\n  assert.equal(typeof(from), 'object');\n  assert.ok(to);\n  assert.equal(typeof(to), 'object');\n\n  var keys = Object.getOwnPropertyNames(from);\n  keys.forEach(function(key) {\n    if (to[key])\n      return;\n\n    var value = Object.getOwnPropertyDescriptor(from, key);\n    Object.defineProperty(to, key, value);\n  });\n\n  return to;\n}\n\n\n\n///--- API\n\nfunction Writer(options) {\n  options = merge(DEFAULT_OPTS, options || {});\n\n  this._buf = new Buffer(options.size || 1024);\n  this._size = this._buf.length;\n  this._offset = 0;\n  this._options = options;\n\n  // A list of offsets in the buffer where we need to insert\n  // sequence tag/len pairs.\n  this._seq = [];\n}\n\nObject.defineProperty(Writer.prototype, 'buffer', {\n  get: function () {\n    if (this._seq.length)\n      throw new InvalidAsn1Error(this._seq.length + ' unended sequence(s)');\n\n    return (this._buf.slice(0, this._offset));\n  }\n});\n\nWriter.prototype.writeByte = function(b) {\n  if (typeof(b) !== 'number')\n    throw new TypeError('argument must be a Number');\n\n  this._ensure(1);\n  this._buf[this._offset++] = b;\n};\n\n\nWriter.prototype.writeInt = function(i, tag) {\n  if (typeof(i) !== 'number')\n    throw new TypeError('argument must be a Number');\n  if (typeof(tag) !== 'number')\n    tag = ASN1.Integer;\n\n  var sz = 4;\n\n  while ((((i & 0xff800000) === 0) || ((i & 0xff800000) === 0xff800000 >> 0)) &&\n         (sz > 1)) {\n    sz--;\n    i <<= 8;\n  }\n\n  if (sz > 4)\n    throw new InvalidAsn1Error('BER ints cannot be > 0xffffffff');\n\n  this._ensure(2 + sz);\n  this._buf[this._offset++] = tag;\n  this._buf[this._offset++] = sz;\n\n  while (sz-- > 0) {\n    this._buf[this._offset++] = ((i & 0xff000000) >>> 24);\n    i <<= 8;\n  }\n\n};\n\n\nWriter.prototype.writeNull = function() {\n  this.writeByte(ASN1.Null);\n  this.writeByte(0x00);\n};\n\n\nWriter.prototype.writeEnumeration = function(i, tag) {\n  if (typeof(i) !== 'number')\n    throw new TypeError('argument must be a Number');\n  if (typeof(tag) !== 'number')\n    tag = ASN1.Enumeration;\n\n  return this.writeInt(i, tag);\n};\n\n\nWriter.prototype.writeBoolean = function(b, tag) {\n  if (typeof(b) !== 'boolean')\n    throw new TypeError('argument must be a Boolean');\n  if (typeof(tag) !== 'number')\n    tag = ASN1.Boolean;\n\n  this._ensure(3);\n  this._buf[this._offset++] = tag;\n  this._buf[this._offset++] = 0x01;\n  this._buf[this._offset++] = b ? 0xff : 0x00;\n};\n\n\nWriter.prototype.writeString = function(s, tag) {\n  if (typeof(s) !== 'string')\n    throw new TypeError('argument must be a string (was: ' + typeof(s) + ')');\n  if (typeof(tag) !== 'number')\n    tag = ASN1.OctetString;\n\n  var len = Buffer.byteLength(s);\n  this.writeByte(tag);\n  this.writeLength(len);\n  if (len) {\n    this._ensure(len);\n    this._buf.write(s, this._offset);\n    this._offset += len;\n  }\n};\n\n\nWriter.prototype.writeBuffer = function(buf, tag) {\n  if (typeof(tag) !== 'number')\n    throw new TypeError('tag must be a number');\n  if (!Buffer.isBuffer(buf))\n    throw new TypeError('argument must be a buffer');\n\n  this.writeByte(tag);\n  this.writeLength(buf.length);\n  this._ensure(buf.length);\n  buf.copy(this._buf, this._offset, 0, buf.length);\n  this._offset += buf.length;\n};\n\n\nWriter.prototype.writeStringArray = function(strings) {\n  if ((!strings instanceof Array))\n    throw new TypeError('argument must be an Array[String]');\n\n  var self = this;\n  strings.forEach(function(s) {\n    self.writeString(s);\n  });\n};\n\n// This is really to solve DER cases, but whatever for now\nWriter.prototype.writeOID = function(s, tag) {\n  if (typeof(s) !== 'string')\n    throw new TypeError('argument must be a string');\n  if (typeof(tag) !== 'number')\n    tag = ASN1.OID;\n\n  if (!/^([0-9]+\\.){3,}[0-9]+$/.test(s))\n    throw new Error('argument is not a valid OID string');\n\n  function encodeOctet(bytes, octet) {\n    if (octet < 128) {\n        bytes.push(octet);\n    } else if (octet < 16384) {\n        bytes.push((octet >>> 7) | 0x80);\n        bytes.push(octet & 0x7F);\n    } else if (octet < 2097152) {\n      bytes.push((octet >>> 14) | 0x80);\n      bytes.push(((octet >>> 7) | 0x80) & 0xFF);\n      bytes.push(octet & 0x7F);\n    } else if (octet < 268435456) {\n      bytes.push((octet >>> 21) | 0x80);\n      bytes.push(((octet >>> 14) | 0x80) & 0xFF);\n      bytes.push(((octet >>> 7) | 0x80) & 0xFF);\n      bytes.push(octet & 0x7F);\n    } else {\n      bytes.push(((octet >>> 28) | 0x80) & 0xFF);\n      bytes.push(((octet >>> 21) | 0x80) & 0xFF);\n      bytes.push(((octet >>> 14) | 0x80) & 0xFF);\n      bytes.push(((octet >>> 7) | 0x80) & 0xFF);\n      bytes.push(octet & 0x7F);\n    }\n  }\n\n  var tmp = s.split('.');\n  var bytes = [];\n  bytes.push(parseInt(tmp[0], 10) * 40 + parseInt(tmp[1], 10));\n  tmp.slice(2).forEach(function(b) {\n    encodeOctet(bytes, parseInt(b, 10));\n  });\n\n  var self = this;\n  this._ensure(2 + bytes.length);\n  this.writeByte(tag);\n  this.writeLength(bytes.length);\n  bytes.forEach(function(b) {\n    self.writeByte(b);\n  });\n};\n\n\nWriter.prototype.writeLength = function(len) {\n  if (typeof(len) !== 'number')\n    throw new TypeError('argument must be a Number');\n\n  this._ensure(4);\n\n  if (len <= 0x7f) {\n    this._buf[this._offset++] = len;\n  } else if (len <= 0xff) {\n    this._buf[this._offset++] = 0x81;\n    this._buf[this._offset++] = len;\n  } else if (len <= 0xffff) {\n    this._buf[this._offset++] = 0x82;\n    this._buf[this._offset++] = len >> 8;\n    this._buf[this._offset++] = len;\n  } else if (len <= 0xffffff) {\n    this._buf[this._offset++] = 0x83;\n    this._buf[this._offset++] = len >> 16;\n    this._buf[this._offset++] = len >> 8;\n    this._buf[this._offset++] = len;\n  } else {\n    throw new InvalidAsn1ERror('Length too long (> 4 bytes)');\n  }\n};\n\nWriter.prototype.startSequence = function(tag) {\n  if (typeof(tag) !== 'number')\n    tag = ASN1.Sequence | ASN1.Constructor;\n\n  this.writeByte(tag);\n  this._seq.push(this._offset);\n  this._ensure(3);\n  this._offset += 3;\n};\n\n\nWriter.prototype.endSequence = function() {\n  var seq = this._seq.pop();\n  var start = seq + 3;\n  var len = this._offset - start;\n\n  if (len <= 0x7f) {\n    this._shift(start, len, -2);\n    this._buf[seq] = len;\n  } else if (len <= 0xff) {\n    this._shift(start, len, -1);\n    this._buf[seq] = 0x81;\n    this._buf[seq + 1] = len;\n  } else if (len <= 0xffff) {\n    this._buf[seq] = 0x82;\n    this._buf[seq + 1] = len >> 8;\n    this._buf[seq + 2] = len;\n  } else if (len <= 0xffffff) {\n    this._shift(start, len, 1);\n    this._buf[seq] = 0x83;\n    this._buf[seq + 1] = len >> 16;\n    this._buf[seq + 2] = len >> 8;\n    this._buf[seq + 3] = len;\n  } else {\n    throw new InvalidAsn1Error('Sequence too long');\n  }\n};\n\n\nWriter.prototype._shift = function(start, len, shift) {\n  assert.ok(start !== undefined);\n  assert.ok(len !== undefined);\n  assert.ok(shift);\n\n  this._buf.copy(this._buf, start + shift, start, start + len);\n  this._offset += shift;\n};\n\nWriter.prototype._ensure = function(len) {\n  assert.ok(len);\n\n  if (this._size - this._offset < len) {\n    var sz = this._size * this._options.growthFactor;\n    if (sz - this._offset < len)\n      sz += len;\n\n    var buf = new Buffer(sz);\n\n    this._buf.copy(buf, 0, 0, this._offset);\n    this._buf = buf;\n    this._size = sz;\n  }\n};\n\n\n\n///--- Exported API\n\nmodule.exports = Writer;\n"]}