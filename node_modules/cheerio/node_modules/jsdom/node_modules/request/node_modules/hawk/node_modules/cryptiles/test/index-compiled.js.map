{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"index-compiled.js","sourcesContent":["// Load modules\n\nvar Code = require('code');\nvar Cryptiles = require('..');\nvar Lab = require('lab');\n\n\n// Declare internals\n\nvar internals = {};\n\n\n// Test shortcuts\n\nvar lab = exports.lab = Lab.script();\nvar describe = lab.describe;\nvar it = lab.it;\nvar expect = Code.expect;\n\n\ndescribe('randomString()', function () {\n\n    it('should generate the right length string', function (done) {\n\n        for (var i = 1; i <= 1000; ++i) {\n            expect(Cryptiles.randomString(i).length).to.equal(i);\n        }\n\n        done();\n    });\n\n    it('returns an error on invalid bits size', function (done) {\n\n        expect(Cryptiles.randomString(99999999999999999999).message).to.match(/Failed generating random bits/);\n        done();\n    });\n});\n\ndescribe('randomBits()', function () {\n\n    it('returns an error on invalid input', function (done) {\n\n        expect(Cryptiles.randomBits(0).message).to.equal('Invalid random bits count');\n        done();\n    });\n});\n\ndescribe('fixedTimeComparison()', function () {\n\n    var a = Cryptiles.randomString(50000);\n    var b = Cryptiles.randomString(150000);\n\n    it('should take the same amount of time comparing different string sizes', function (done) {\n\n        var now = Date.now();\n        Cryptiles.fixedTimeComparison(b, a);\n        var t1 = Date.now() - now;\n\n        now = Date.now();\n        Cryptiles.fixedTimeComparison(b, b);\n        var t2 = Date.now() - now;\n\n        expect(t2 - t1).to.be.within(-20, 20);\n        done();\n    });\n\n    it('should return true for equal strings', function (done) {\n\n        expect(Cryptiles.fixedTimeComparison(a, a)).to.equal(true);\n        done();\n    });\n\n    it('should return false for different strings (size, a < b)', function (done) {\n\n        expect(Cryptiles.fixedTimeComparison(a, a + 'x')).to.equal(false);\n        done();\n    });\n\n    it('should return false for different strings (size, a > b)', function (done) {\n\n        expect(Cryptiles.fixedTimeComparison(a + 'x', a)).to.equal(false);\n        done();\n    });\n\n    it('should return false for different strings (size, a = b)', function (done) {\n\n        expect(Cryptiles.fixedTimeComparison(a + 'x', a + 'y')).to.equal(false);\n        done();\n    });\n\n    it('should return false when not a string', function (done) {\n\n        expect(Cryptiles.fixedTimeComparison('x', null)).to.equal(false);\n        done();\n    });\n\n    it('should return false when not a string (left)', function (done) {\n\n        expect(Cryptiles.fixedTimeComparison(null, 'x')).to.equal(false);\n        done();\n    });\n});\n"]}