{"version":3,"sources":["browser.js"],"names":[],"mappings":"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","file":"browser-compiled.js","sourcesContent":["// Load modules\r\n\r\nvar Url = require('url');\r\nvar Code = require('code');\r\nvar Hawk = require('../lib');\r\nvar Hoek = require('hoek');\r\nvar Lab = require('lab');\r\nvar Browser = require('../lib/browser');\r\n\r\n\r\n// Declare internals\r\n\r\nvar internals = {};\r\n\r\n\r\n// Test shortcuts\r\n\r\nvar lab = exports.lab = Lab.script();\r\nvar describe = lab.experiment;\r\nvar it = lab.test;\r\nvar expect = Code.expect;\r\n\r\n\r\ndescribe('Browser', function () {\r\n\r\n    var credentialsFunc = function (id, callback) {\r\n\r\n        var credentials = {\r\n            id: id,\r\n            key: 'werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn',\r\n            algorithm: (id === '1' ? 'sha1' : 'sha256'),\r\n            user: 'steve'\r\n        };\r\n\r\n        return callback(null, credentials);\r\n    };\r\n\r\n    it('should generate a bewit then successfully authenticate it', function (done) {\r\n\r\n        var req = {\r\n            method: 'GET',\r\n            url: '/resource/4?a=1&b=2',\r\n            host: 'example.com',\r\n            port: 80\r\n        };\r\n\r\n        credentialsFunc('123456', function (err, credentials1) {\r\n\r\n            var bewit = Browser.client.bewit('http://example.com/resource/4?a=1&b=2', { credentials: credentials1, ttlSec: 60 * 60 * 24 * 365 * 100, ext: 'some-app-data' });\r\n            req.url += '&bewit=' + bewit;\r\n\r\n            Hawk.uri.authenticate(req, credentialsFunc, {}, function (err, credentials2, attributes) {\r\n\r\n                expect(err).to.not.exist();\r\n                expect(credentials2.user).to.equal('steve');\r\n                expect(attributes.ext).to.equal('some-app-data');\r\n                done();\r\n            });\r\n        });\r\n    });\r\n\r\n    it('should generate a bewit then successfully authenticate it (no ext)', function (done) {\r\n\r\n        var req = {\r\n            method: 'GET',\r\n            url: '/resource/4?a=1&b=2',\r\n            host: 'example.com',\r\n            port: 80\r\n        };\r\n\r\n        credentialsFunc('123456', function (err, credentials1) {\r\n\r\n            var bewit = Browser.client.bewit('http://example.com/resource/4?a=1&b=2', { credentials: credentials1, ttlSec: 60 * 60 * 24 * 365 * 100 });\r\n            req.url += '&bewit=' + bewit;\r\n\r\n            Hawk.uri.authenticate(req, credentialsFunc, {}, function (err, credentials2, attributes) {\r\n\r\n                expect(err).to.not.exist();\r\n                expect(credentials2.user).to.equal('steve');\r\n                done();\r\n            });\r\n        });\r\n    });\r\n\r\n    describe('bewit()', function () {\r\n\r\n        it('returns a valid bewit value', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: '2983d45yun89q',\r\n                algorithm: 'sha256'\r\n            };\r\n\r\n            var bewit = Browser.client.bewit('https://example.com/somewhere/over/the/rainbow', { credentials: credentials, ttlSec: 300, localtimeOffsetMsec: 1356420407232 - Hawk.utils.now(), ext: 'xandyandz' });\r\n            expect(bewit).to.equal('MTIzNDU2XDEzNTY0MjA3MDdca3NjeHdOUjJ0SnBQMVQxekRMTlBiQjVVaUtJVTl0T1NKWFRVZEc3WDloOD1ceGFuZHlhbmR6');\r\n            done();\r\n        });\r\n\r\n        it('returns a valid bewit value (explicit HTTP port)', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: '2983d45yun89q',\r\n                algorithm: 'sha256'\r\n            };\r\n\r\n            var bewit = Browser.client.bewit('http://example.com:8080/somewhere/over/the/rainbow', { credentials: credentials, ttlSec: 300, localtimeOffsetMsec: 1356420407232 - Hawk.utils.now(), ext: 'xandyandz' });\r\n            expect(bewit).to.equal('MTIzNDU2XDEzNTY0MjA3MDdcaFpiSjNQMmNLRW80a3kwQzhqa1pBa1J5Q1p1ZWc0V1NOYnhWN3ZxM3hIVT1ceGFuZHlhbmR6');\r\n            done();\r\n        });\r\n\r\n        it('returns a valid bewit value (explicit HTTPS port)', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: '2983d45yun89q',\r\n                algorithm: 'sha256'\r\n            };\r\n\r\n            var bewit = Browser.client.bewit('https://example.com:8043/somewhere/over/the/rainbow', { credentials: credentials, ttlSec: 300, localtimeOffsetMsec: 1356420407232 - Hawk.utils.now(), ext: 'xandyandz' });\r\n            expect(bewit).to.equal('MTIzNDU2XDEzNTY0MjA3MDdcL2t4UjhwK0xSaTdvQTRnUXc3cWlxa3BiVHRKYkR4OEtRMC9HRUwvVytTUT1ceGFuZHlhbmR6');\r\n            done();\r\n        });\r\n\r\n        it('returns a valid bewit value (null ext)', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: '2983d45yun89q',\r\n                algorithm: 'sha256'\r\n            };\r\n\r\n            var bewit = Browser.client.bewit('https://example.com/somewhere/over/the/rainbow', { credentials: credentials, ttlSec: 300, localtimeOffsetMsec: 1356420407232 - Hawk.utils.now(), ext: null });\r\n            expect(bewit).to.equal('MTIzNDU2XDEzNTY0MjA3MDdcSUdZbUxnSXFMckNlOEN4dktQczRKbFdJQStValdKSm91d2dBUmlWaENBZz1c');\r\n            done();\r\n        });\r\n\r\n        it('errors on invalid options', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: '2983d45yun89q',\r\n                algorithm: 'sha256'\r\n            };\r\n\r\n            var bewit = Browser.client.bewit('https://example.com/somewhere/over/the/rainbow', 4);\r\n            expect(bewit).to.equal('');\r\n            done();\r\n        });\r\n\r\n        it('errors on missing uri', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: '2983d45yun89q',\r\n                algorithm: 'sha256'\r\n            };\r\n\r\n            var bewit = Browser.client.bewit('', { credentials: credentials, ttlSec: 300, localtimeOffsetMsec: 1356420407232 - Hawk.utils.now(), ext: 'xandyandz' });\r\n            expect(bewit).to.equal('');\r\n            done();\r\n        });\r\n\r\n        it('errors on invalid uri', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: '2983d45yun89q',\r\n                algorithm: 'sha256'\r\n            };\r\n\r\n            var bewit = Browser.client.bewit(5, { credentials: credentials, ttlSec: 300, localtimeOffsetMsec: 1356420407232 - Hawk.utils.now(), ext: 'xandyandz' });\r\n            expect(bewit).to.equal('');\r\n            done();\r\n        });\r\n\r\n        it('errors on invalid credentials (id)', function (done) {\r\n\r\n            var credentials = {\r\n                key: '2983d45yun89q',\r\n                algorithm: 'sha256'\r\n            };\r\n\r\n            var bewit = Browser.client.bewit('https://example.com/somewhere/over/the/rainbow', { credentials: credentials, ttlSec: 3000, ext: 'xandyandz' });\r\n            expect(bewit).to.equal('');\r\n            done();\r\n        });\r\n\r\n        it('errors on missing credentials', function (done) {\r\n\r\n            var bewit = Browser.client.bewit('https://example.com/somewhere/over/the/rainbow', { ttlSec: 3000, ext: 'xandyandz' });\r\n            expect(bewit).to.equal('');\r\n            done();\r\n        });\r\n\r\n        it('errors on invalid credentials (key)', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                algorithm: 'sha256'\r\n            };\r\n\r\n            var bewit = Browser.client.bewit('https://example.com/somewhere/over/the/rainbow', { credentials: credentials, ttlSec: 3000, ext: 'xandyandz' });\r\n            expect(bewit).to.equal('');\r\n            done();\r\n        });\r\n\r\n        it('errors on invalid algorithm', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: '2983d45yun89q',\r\n                algorithm: 'hmac-sha-0'\r\n            };\r\n\r\n            var bewit = Browser.client.bewit('https://example.com/somewhere/over/the/rainbow', { credentials: credentials, ttlSec: 300, ext: 'xandyandz' });\r\n            expect(bewit).to.equal('');\r\n            done();\r\n        });\r\n\r\n        it('errors on missing options', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: '2983d45yun89q',\r\n                algorithm: 'hmac-sha-0'\r\n            };\r\n\r\n            var bewit = Browser.client.bewit('https://example.com/somewhere/over/the/rainbow');\r\n            expect(bewit).to.equal('');\r\n            done();\r\n        });\r\n    });\r\n\r\n    it('generates a header then successfully parse it (configuration)', function (done) {\r\n\r\n        var req = {\r\n            method: 'GET',\r\n            url: '/resource/4?filter=a',\r\n            host: 'example.com',\r\n            port: 8080\r\n        };\r\n\r\n        credentialsFunc('123456', function (err, credentials1) {\r\n\r\n            req.authorization = Browser.client.header('http://example.com:8080/resource/4?filter=a', req.method, { credentials: credentials1, ext: 'some-app-data' }).field;\r\n            expect(req.authorization).to.exist();\r\n\r\n            Hawk.server.authenticate(req, credentialsFunc, {}, function (err, credentials2, artifacts) {\r\n\r\n                expect(err).to.not.exist();\r\n                expect(credentials2.user).to.equal('steve');\r\n                expect(artifacts.ext).to.equal('some-app-data');\r\n                done();\r\n            });\r\n        });\r\n    });\r\n\r\n    it('generates a header then successfully parse it (node request)', function (done) {\r\n\r\n        var req = {\r\n            method: 'POST',\r\n            url: '/resource/4?filter=a',\r\n            headers: {\r\n                host: 'example.com:8080',\r\n                'content-type': 'text/plain;x=y'\r\n            }\r\n        };\r\n\r\n        var payload = 'some not so random text';\r\n\r\n        credentialsFunc('123456', function (err, credentials1) {\r\n\r\n            var reqHeader = Browser.client.header('http://example.com:8080/resource/4?filter=a', req.method, { credentials: credentials1, ext: 'some-app-data', payload: payload, contentType: req.headers['content-type'] });\r\n            req.headers.authorization = reqHeader.field;\r\n\r\n            Hawk.server.authenticate(req, credentialsFunc, {}, function (err, credentials2, artifacts) {\r\n\r\n                expect(err).to.not.exist();\r\n                expect(credentials2.user).to.equal('steve');\r\n                expect(artifacts.ext).to.equal('some-app-data');\r\n                expect(Hawk.server.authenticatePayload(payload, credentials2, artifacts, req.headers['content-type'])).to.equal(true);\r\n\r\n                var res = {\r\n                    headers: {\r\n                        'content-type': 'text/plain'\r\n                    },\r\n                    getResponseHeader: function (header) {\r\n\r\n                        return res.headers[header.toLowerCase()];\r\n                    }\r\n                };\r\n\r\n                res.headers['server-authorization'] = Hawk.server.header(credentials2, artifacts, { payload: 'some reply', contentType: 'text/plain', ext: 'response-specific' });\r\n                expect(res.headers['server-authorization']).to.exist();\r\n\r\n                expect(Browser.client.authenticate(res, credentials2, artifacts, { payload: 'some reply' })).to.equal(true);\r\n                done();\r\n            });\r\n        });\r\n    });\r\n\r\n    it('generates a header then successfully parse it (browserify)', function (done) {\r\n\r\n        var req = {\r\n            method: 'POST',\r\n            url: '/resource/4?filter=a',\r\n            headers: {\r\n                host: 'example.com:8080',\r\n                'content-type': 'text/plain;x=y'\r\n            }\r\n        };\r\n\r\n        var payload = 'some not so random text';\r\n\r\n        credentialsFunc('123456', function (err, credentials1) {\r\n\r\n            var reqHeader = Browser.client.header('http://example.com:8080/resource/4?filter=a', req.method, { credentials: credentials1, ext: 'some-app-data', payload: payload, contentType: req.headers['content-type'] });\r\n            req.headers.authorization = reqHeader.field;\r\n\r\n            Hawk.server.authenticate(req, credentialsFunc, {}, function (err, credentials2, artifacts) {\r\n\r\n                expect(err).to.not.exist();\r\n                expect(credentials2.user).to.equal('steve');\r\n                expect(artifacts.ext).to.equal('some-app-data');\r\n                expect(Hawk.server.authenticatePayload(payload, credentials2, artifacts, req.headers['content-type'])).to.equal(true);\r\n\r\n                var res = {\r\n                    headers: {\r\n                        'content-type': 'text/plain'\r\n                    },\r\n                    getHeader: function (header) {\r\n\r\n                        return res.headers[header.toLowerCase()];\r\n                    }\r\n                };\r\n\r\n                res.headers['server-authorization'] = Hawk.server.header(credentials2, artifacts, { payload: 'some reply', contentType: 'text/plain', ext: 'response-specific' });\r\n                expect(res.headers['server-authorization']).to.exist();\r\n\r\n                expect(Browser.client.authenticate(res, credentials2, artifacts, { payload: 'some reply' })).to.equal(true);\r\n                done();\r\n            });\r\n        });\r\n    });\r\n\r\n    it('generates a header then successfully parse it (time offset)', function (done) {\r\n\r\n        var req = {\r\n            method: 'GET',\r\n            url: '/resource/4?filter=a',\r\n            host: 'example.com',\r\n            port: 8080\r\n        };\r\n\r\n        credentialsFunc('123456', function (err, credentials1) {\r\n\r\n            req.authorization = Browser.client.header('http://example.com:8080/resource/4?filter=a', req.method, { credentials: credentials1, ext: 'some-app-data', localtimeOffsetMsec: 100000 }).field;\r\n            expect(req.authorization).to.exist();\r\n\r\n            Hawk.server.authenticate(req, credentialsFunc, { localtimeOffsetMsec: 100000 }, function (err, credentials2, artifacts) {\r\n\r\n                expect(err).to.not.exist();\r\n                expect(credentials2.user).to.equal('steve');\r\n                expect(artifacts.ext).to.equal('some-app-data');\r\n                done();\r\n            });\r\n        });\r\n    });\r\n\r\n    it('generates a header then successfully parse it (no server header options)', function (done) {\r\n\r\n        var req = {\r\n            method: 'POST',\r\n            url: '/resource/4?filter=a',\r\n            headers: {\r\n                host: 'example.com:8080',\r\n                'content-type': 'text/plain;x=y'\r\n            }\r\n        };\r\n\r\n        var payload = 'some not so random text';\r\n\r\n        credentialsFunc('123456', function (err, credentials1) {\r\n\r\n            var reqHeader = Browser.client.header('http://example.com:8080/resource/4?filter=a', req.method, { credentials: credentials1, ext: 'some-app-data', payload: payload, contentType: req.headers['content-type'] });\r\n            req.headers.authorization = reqHeader.field;\r\n\r\n            Hawk.server.authenticate(req, credentialsFunc, {}, function (err, credentials2, artifacts) {\r\n\r\n                expect(err).to.not.exist();\r\n                expect(credentials2.user).to.equal('steve');\r\n                expect(artifacts.ext).to.equal('some-app-data');\r\n                expect(Hawk.server.authenticatePayload(payload, credentials2, artifacts, req.headers['content-type'])).to.equal(true);\r\n\r\n                var res = {\r\n                    headers: {\r\n                        'content-type': 'text/plain'\r\n                    },\r\n                    getResponseHeader: function (header) {\r\n\r\n                        return res.headers[header.toLowerCase()];\r\n                    }\r\n                };\r\n\r\n                res.headers['server-authorization'] = Hawk.server.header(credentials2, artifacts);\r\n                expect(res.headers['server-authorization']).to.exist();\r\n\r\n                expect(Browser.client.authenticate(res, credentials2, artifacts)).to.equal(true);\r\n                done();\r\n            });\r\n        });\r\n    });\r\n\r\n    it('generates a header then successfully parse it (no server header)', function (done) {\r\n\r\n        var req = {\r\n            method: 'POST',\r\n            url: '/resource/4?filter=a',\r\n            headers: {\r\n                host: 'example.com:8080',\r\n                'content-type': 'text/plain;x=y'\r\n            }\r\n        };\r\n\r\n        var payload = 'some not so random text';\r\n\r\n        credentialsFunc('123456', function (err, credentials1) {\r\n\r\n            var reqHeader = Browser.client.header('http://example.com:8080/resource/4?filter=a', req.method, { credentials: credentials1, ext: 'some-app-data', payload: payload, contentType: req.headers['content-type'] });\r\n            req.headers.authorization = reqHeader.field;\r\n\r\n            Hawk.server.authenticate(req, credentialsFunc, {}, function (err, credentials2, artifacts) {\r\n\r\n                expect(err).to.not.exist();\r\n                expect(credentials2.user).to.equal('steve');\r\n                expect(artifacts.ext).to.equal('some-app-data');\r\n                expect(Hawk.server.authenticatePayload(payload, credentials2, artifacts, req.headers['content-type'])).to.equal(true);\r\n\r\n                var res = {\r\n                    headers: {\r\n                        'content-type': 'text/plain'\r\n                    },\r\n                    getResponseHeader: function (header) {\r\n\r\n                        return res.headers[header.toLowerCase()];\r\n                    }\r\n                };\r\n\r\n                expect(Browser.client.authenticate(res, credentials2, artifacts)).to.equal(true);\r\n                done();\r\n            });\r\n        });\r\n    });\r\n\r\n    it('generates a header with stale ts and successfully authenticate on second call', function (done) {\r\n\r\n        var req = {\r\n            method: 'GET',\r\n            url: '/resource/4?filter=a',\r\n            host: 'example.com',\r\n            port: 8080\r\n        };\r\n\r\n        credentialsFunc('123456', function (err, credentials1) {\r\n\r\n            Browser.utils.setNtpOffset(60 * 60 * 1000);\r\n            var header = Browser.client.header('http://example.com:8080/resource/4?filter=a', req.method, { credentials: credentials1, ext: 'some-app-data' });\r\n            req.authorization = header.field;\r\n            expect(req.authorization).to.exist();\r\n\r\n            Hawk.server.authenticate(req, credentialsFunc, {}, function (err, credentials2, artifacts2) {\r\n\r\n                expect(err).to.exist();\r\n                expect(err.message).to.equal('Stale timestamp');\r\n\r\n                var res = {\r\n                    headers: {\r\n                        'www-authenticate': err.output.headers['WWW-Authenticate']\r\n                    },\r\n                    getResponseHeader: function (lookup) {\r\n\r\n                        return res.headers[lookup.toLowerCase()];\r\n                    }\r\n                };\r\n\r\n                expect(Browser.utils.getNtpOffset()).to.equal(60 * 60 * 1000);\r\n                expect(Browser.client.authenticate(res, credentials2, header.artifacts)).to.equal(true);\r\n                expect(Browser.utils.getNtpOffset()).to.equal(0);\r\n\r\n                req.authorization = Browser.client.header('http://example.com:8080/resource/4?filter=a', req.method, { credentials: credentials2, ext: 'some-app-data' }).field;\r\n                expect(req.authorization).to.exist();\r\n\r\n                Hawk.server.authenticate(req, credentialsFunc, {}, function (err, credentials3, artifacts3) {\r\n\r\n                    expect(err).to.not.exist();\r\n                    expect(credentials3.user).to.equal('steve');\r\n                    expect(artifacts3.ext).to.equal('some-app-data');\r\n                    done();\r\n                });\r\n            });\r\n        });\r\n    });\r\n\r\n    it('generates a header with stale ts and successfully authenticate on second call (manual localStorage)', function (done) {\r\n\r\n        var req = {\r\n            method: 'GET',\r\n            url: '/resource/4?filter=a',\r\n            host: 'example.com',\r\n            port: 8080\r\n        };\r\n\r\n        credentialsFunc('123456', function (err, credentials1) {\r\n\r\n            var localStorage = new Browser.internals.LocalStorage();\r\n\r\n            Browser.utils.setStorage(localStorage);\r\n\r\n            Browser.utils.setNtpOffset(60 * 60 * 1000);\r\n            var header = Browser.client.header('http://example.com:8080/resource/4?filter=a', req.method, { credentials: credentials1, ext: 'some-app-data' });\r\n            req.authorization = header.field;\r\n            expect(req.authorization).to.exist();\r\n\r\n            Hawk.server.authenticate(req, credentialsFunc, {}, function (err, credentials2, artifacts2) {\r\n\r\n                expect(err).to.exist();\r\n                expect(err.message).to.equal('Stale timestamp');\r\n\r\n                var res = {\r\n                    headers: {\r\n                        'www-authenticate': err.output.headers['WWW-Authenticate']\r\n                    },\r\n                    getResponseHeader: function (lookup) {\r\n\r\n                        return res.headers[lookup.toLowerCase()];\r\n                    }\r\n                };\r\n\r\n                expect(parseInt(localStorage.getItem('hawk_ntp_offset'))).to.equal(60 * 60 * 1000);\r\n                expect(Browser.utils.getNtpOffset()).to.equal(60 * 60 * 1000);\r\n                expect(Browser.client.authenticate(res, credentials2, header.artifacts)).to.equal(true);\r\n                expect(Browser.utils.getNtpOffset()).to.equal(0);\r\n                expect(parseInt(localStorage.getItem('hawk_ntp_offset'))).to.equal(0);\r\n\r\n                req.authorization = Browser.client.header('http://example.com:8080/resource/4?filter=a', req.method, { credentials: credentials2, ext: 'some-app-data' }).field;\r\n                expect(req.authorization).to.exist();\r\n\r\n                Hawk.server.authenticate(req, credentialsFunc, {}, function (err, credentials3, artifacts3) {\r\n\r\n                    expect(err).to.not.exist();\r\n                    expect(credentials3.user).to.equal('steve');\r\n                    expect(artifacts3.ext).to.equal('some-app-data');\r\n                    done();\r\n                });\r\n            });\r\n        });\r\n    });\r\n\r\n    it('generates a header then fails to parse it (missing server header hash)', function (done) {\r\n\r\n        var req = {\r\n            method: 'POST',\r\n            url: '/resource/4?filter=a',\r\n            headers: {\r\n                host: 'example.com:8080',\r\n                'content-type': 'text/plain;x=y'\r\n            }\r\n        };\r\n\r\n        var payload = 'some not so random text';\r\n\r\n        credentialsFunc('123456', function (err, credentials1) {\r\n\r\n            var reqHeader = Browser.client.header('http://example.com:8080/resource/4?filter=a', req.method, { credentials: credentials1, ext: 'some-app-data', payload: payload, contentType: req.headers['content-type'] });\r\n            req.headers.authorization = reqHeader.field;\r\n\r\n            Hawk.server.authenticate(req, credentialsFunc, {}, function (err, credentials2, artifacts) {\r\n\r\n                expect(err).to.not.exist();\r\n                expect(credentials2.user).to.equal('steve');\r\n                expect(artifacts.ext).to.equal('some-app-data');\r\n                expect(Hawk.server.authenticatePayload(payload, credentials2, artifacts, req.headers['content-type'])).to.equal(true);\r\n\r\n                var res = {\r\n                    headers: {\r\n                        'content-type': 'text/plain'\r\n                    },\r\n                    getResponseHeader: function (header) {\r\n\r\n                        return res.headers[header.toLowerCase()];\r\n                    }\r\n                };\r\n\r\n                res.headers['server-authorization'] = Hawk.server.header(credentials2, artifacts);\r\n                expect(res.headers['server-authorization']).to.exist();\r\n\r\n                expect(Browser.client.authenticate(res, credentials2, artifacts, { payload: 'some reply' })).to.equal(false);\r\n                done();\r\n            });\r\n        });\r\n    });\r\n\r\n    it('generates a header then successfully parse it (with hash)', function (done) {\r\n\r\n        var req = {\r\n            method: 'GET',\r\n            url: '/resource/4?filter=a',\r\n            host: 'example.com',\r\n            port: 8080\r\n        };\r\n\r\n        credentialsFunc('123456', function (err, credentials1) {\r\n\r\n            req.authorization = Browser.client.header('http://example.com:8080/resource/4?filter=a', req.method, { credentials: credentials1, payload: 'hola!', ext: 'some-app-data' }).field;\r\n            Hawk.server.authenticate(req, credentialsFunc, {}, function (err, credentials2, artifacts) {\r\n\r\n                expect(err).to.not.exist();\r\n                expect(credentials2.user).to.equal('steve');\r\n                expect(artifacts.ext).to.equal('some-app-data');\r\n                done();\r\n            });\r\n        });\r\n    });\r\n\r\n    it('generates a header then successfully parse it then validate payload', function (done) {\r\n\r\n        var req = {\r\n            method: 'GET',\r\n            url: '/resource/4?filter=a',\r\n            host: 'example.com',\r\n            port: 8080\r\n        };\r\n\r\n        credentialsFunc('123456', function (err, credentials1) {\r\n\r\n            req.authorization = Browser.client.header('http://example.com:8080/resource/4?filter=a', req.method, { credentials: credentials1, payload: 'hola!', ext: 'some-app-data' }).field;\r\n            Hawk.server.authenticate(req, credentialsFunc, {}, function (err, credentials2, artifacts) {\r\n\r\n                expect(err).to.not.exist();\r\n                expect(credentials2.user).to.equal('steve');\r\n                expect(artifacts.ext).to.equal('some-app-data');\r\n                expect(Hawk.server.authenticatePayload('hola!', credentials2, artifacts)).to.be.true();\r\n                expect(Hawk.server.authenticatePayload('hello!', credentials2, artifacts)).to.be.false();\r\n                done();\r\n            });\r\n        });\r\n    });\r\n\r\n    it('generates a header then successfully parse it (app)', function (done) {\r\n\r\n        var req = {\r\n            method: 'GET',\r\n            url: '/resource/4?filter=a',\r\n            host: 'example.com',\r\n            port: 8080\r\n        };\r\n\r\n        credentialsFunc('123456', function (err, credentials1) {\r\n\r\n            req.authorization = Browser.client.header('http://example.com:8080/resource/4?filter=a', req.method, { credentials: credentials1, ext: 'some-app-data', app: 'asd23ased' }).field;\r\n            Hawk.server.authenticate(req, credentialsFunc, {}, function (err, credentials2, artifacts) {\r\n\r\n                expect(err).to.not.exist();\r\n                expect(credentials2.user).to.equal('steve');\r\n                expect(artifacts.ext).to.equal('some-app-data');\r\n                expect(artifacts.app).to.equal('asd23ased');\r\n                done();\r\n            });\r\n        });\r\n    });\r\n\r\n    it('generates a header then successfully parse it (app, dlg)', function (done) {\r\n\r\n        var req = {\r\n            method: 'GET',\r\n            url: '/resource/4?filter=a',\r\n            host: 'example.com',\r\n            port: 8080\r\n        };\r\n\r\n        credentialsFunc('123456', function (err, credentials1) {\r\n\r\n            req.authorization = Browser.client.header('http://example.com:8080/resource/4?filter=a', req.method, { credentials: credentials1, ext: 'some-app-data', app: 'asd23ased', dlg: '23434szr3q4d' }).field;\r\n            Hawk.server.authenticate(req, credentialsFunc, {}, function (err, credentials2, artifacts) {\r\n\r\n                expect(err).to.not.exist();\r\n                expect(credentials2.user).to.equal('steve');\r\n                expect(artifacts.ext).to.equal('some-app-data');\r\n                expect(artifacts.app).to.equal('asd23ased');\r\n                expect(artifacts.dlg).to.equal('23434szr3q4d');\r\n                done();\r\n            });\r\n        });\r\n    });\r\n\r\n    it('generates a header then fail authentication due to bad hash', function (done) {\r\n\r\n        var req = {\r\n            method: 'GET',\r\n            url: '/resource/4?filter=a',\r\n            host: 'example.com',\r\n            port: 8080\r\n        };\r\n\r\n        credentialsFunc('123456', function (err, credentials1) {\r\n\r\n            req.authorization = Browser.client.header('http://example.com:8080/resource/4?filter=a', req.method, { credentials: credentials1, payload: 'hola!', ext: 'some-app-data' }).field;\r\n            Hawk.server.authenticate(req, credentialsFunc, { payload: 'byebye!' }, function (err, credentials2, artifacts) {\r\n\r\n                expect(err).to.exist();\r\n                expect(err.output.payload.message).to.equal('Bad payload hash');\r\n                done();\r\n            });\r\n        });\r\n    });\r\n\r\n    it('generates a header for one resource then fail to authenticate another', function (done) {\r\n\r\n        var req = {\r\n            method: 'GET',\r\n            url: '/resource/4?filter=a',\r\n            host: 'example.com',\r\n            port: 8080\r\n        };\r\n\r\n        credentialsFunc('123456', function (err, credentials1) {\r\n\r\n            req.authorization = Browser.client.header('http://example.com:8080/resource/4?filter=a', req.method, { credentials: credentials1, ext: 'some-app-data' }).field;\r\n            req.url = '/something/else';\r\n\r\n            Hawk.server.authenticate(req, credentialsFunc, {}, function (err, credentials2, artifacts) {\r\n\r\n                expect(err).to.exist();\r\n                expect(credentials2).to.exist();\r\n                done();\r\n            });\r\n        });\r\n    });\r\n\r\n    describe('client', function () {\r\n\r\n        describe('header()', function () {\r\n\r\n            it('returns a valid authorization header (sha1)', function (done) {\r\n\r\n                var credentials = {\r\n                    id: '123456',\r\n                    key: '2983d45yun89q',\r\n                    algorithm: 'sha1'\r\n                };\r\n\r\n                var header = Browser.client.header('http://example.net/somewhere/over/the/rainbow', 'POST', { credentials: credentials, ext: 'Bazinga!', timestamp: 1353809207, nonce: 'Ygvqdz', payload: 'something to write about' }).field;\r\n                expect(header).to.equal('Hawk id=\"123456\", ts=\"1353809207\", nonce=\"Ygvqdz\", hash=\"bsvY3IfUllw6V5rvk4tStEvpBhE=\", ext=\"Bazinga!\", mac=\"qbf1ZPG/r/e06F4ht+T77LXi5vw=\"');\r\n                done();\r\n            });\r\n\r\n            it('returns a valid authorization header (sha256)', function (done) {\r\n\r\n                var credentials = {\r\n                    id: '123456',\r\n                    key: '2983d45yun89q',\r\n                    algorithm: 'sha256'\r\n                };\r\n\r\n                var header = Browser.client.header('https://example.net/somewhere/over/the/rainbow', 'POST', { credentials: credentials, ext: 'Bazinga!', timestamp: 1353809207, nonce: 'Ygvqdz', payload: 'something to write about', contentType: 'text/plain' }).field;\r\n                expect(header).to.equal('Hawk id=\"123456\", ts=\"1353809207\", nonce=\"Ygvqdz\", hash=\"2QfCt3GuY9HQnHWyWD3wX68ZOKbynqlfYmuO2ZBRqtY=\", ext=\"Bazinga!\", mac=\"q1CwFoSHzPZSkbIvl0oYlD+91rBUEvFk763nMjMndj8=\"');\r\n                done();\r\n            });\r\n\r\n            it('returns a valid authorization header (empty payload)', function (done) {\r\n\r\n                var credentials = {\r\n                    id: '123456',\r\n                    key: '2983d45yun89q',\r\n                    algorithm: 'sha1'\r\n                };\r\n\r\n                var header = Browser.client.header('http://example.net/somewhere/over/the/rainbow', 'POST', { credentials: credentials, ext: 'Bazinga!', timestamp: 1353809207, nonce: 'Ygvqdz', payload: '' }).field;\r\n                expect(header).to.equal('Hawk id=\\\"123456\\\", ts=\\\"1353809207\\\", nonce=\\\"Ygvqdz\\\", hash=\\\"404ghL7K+hfyhByKKejFBRGgTjU=\\\", ext=\\\"Bazinga!\\\", mac=\\\"Bh1sj1DOfFRWOdi3ww52nLCJdBE=\\\"');\r\n                done();\r\n            });\r\n\r\n            it('returns a valid authorization header (no ext)', function (done) {\r\n\r\n                var credentials = {\r\n                    id: '123456',\r\n                    key: '2983d45yun89q',\r\n                    algorithm: 'sha256'\r\n                };\r\n\r\n                var header = Browser.client.header('https://example.net/somewhere/over/the/rainbow', 'POST', { credentials: credentials, timestamp: 1353809207, nonce: 'Ygvqdz', payload: 'something to write about', contentType: 'text/plain' }).field;\r\n                expect(header).to.equal('Hawk id=\"123456\", ts=\"1353809207\", nonce=\"Ygvqdz\", hash=\"2QfCt3GuY9HQnHWyWD3wX68ZOKbynqlfYmuO2ZBRqtY=\", mac=\"HTgtd0jPI6E4izx8e4OHdO36q00xFCU0FolNq3RiCYs=\"');\r\n                done();\r\n            });\r\n\r\n            it('returns a valid authorization header (null ext)', function (done) {\r\n\r\n                var credentials = {\r\n                    id: '123456',\r\n                    key: '2983d45yun89q',\r\n                    algorithm: 'sha256'\r\n                };\r\n\r\n                var header = Browser.client.header('https://example.net/somewhere/over/the/rainbow', 'POST', { credentials: credentials, timestamp: 1353809207, nonce: 'Ygvqdz', payload: 'something to write about', contentType: 'text/plain', ext: null }).field;\r\n                expect(header).to.equal('Hawk id=\"123456\", ts=\"1353809207\", nonce=\"Ygvqdz\", hash=\"2QfCt3GuY9HQnHWyWD3wX68ZOKbynqlfYmuO2ZBRqtY=\", mac=\"HTgtd0jPI6E4izx8e4OHdO36q00xFCU0FolNq3RiCYs=\"');\r\n                done();\r\n            });\r\n\r\n            it('returns a valid authorization header (uri object)', function (done) {\r\n\r\n                var credentials = {\r\n                    id: '123456',\r\n                    key: '2983d45yun89q',\r\n                    algorithm: 'sha256'\r\n                };\r\n\r\n                var uri = Browser.utils.parseUri('https://example.net/somewhere/over/the/rainbow');\r\n                var header = Browser.client.header(uri, 'POST', { credentials: credentials, timestamp: 1353809207, nonce: 'Ygvqdz', payload: 'something to write about', contentType: 'text/plain' }).field;\r\n                expect(header).to.equal('Hawk id=\"123456\", ts=\"1353809207\", nonce=\"Ygvqdz\", hash=\"2QfCt3GuY9HQnHWyWD3wX68ZOKbynqlfYmuO2ZBRqtY=\", mac=\"HTgtd0jPI6E4izx8e4OHdO36q00xFCU0FolNq3RiCYs=\"');\r\n                done();\r\n            });\r\n\r\n            it('errors on missing options', function (done) {\r\n\r\n                var header = Browser.client.header('https://example.net/somewhere/over/the/rainbow', 'POST');\r\n                expect(header.field).to.equal('');\r\n                expect(header.err).to.equal('Invalid argument type');\r\n                done();\r\n            });\r\n\r\n            it('errors on empty uri', function (done) {\r\n\r\n                var credentials = {\r\n                    id: '123456',\r\n                    key: '2983d45yun89q',\r\n                    algorithm: 'sha256'\r\n                };\r\n\r\n                var header = Browser.client.header('', 'POST', { credentials: credentials, timestamp: 1353809207, nonce: 'Ygvqdz', payload: 'something to write about', contentType: 'text/plain' });\r\n                expect(header.field).to.equal('');\r\n                expect(header.err).to.equal('Invalid argument type');\r\n                done();\r\n            });\r\n\r\n            it('errors on invalid uri', function (done) {\r\n\r\n                var credentials = {\r\n                    id: '123456',\r\n                    key: '2983d45yun89q',\r\n                    algorithm: 'sha256'\r\n                };\r\n\r\n                var header = Browser.client.header(4, 'POST', { credentials: credentials, timestamp: 1353809207, nonce: 'Ygvqdz', payload: 'something to write about', contentType: 'text/plain' });\r\n                expect(header.field).to.equal('');\r\n                expect(header.err).to.equal('Invalid argument type');\r\n                done();\r\n            });\r\n\r\n            it('errors on missing method', function (done) {\r\n\r\n                var credentials = {\r\n                    id: '123456',\r\n                    key: '2983d45yun89q',\r\n                    algorithm: 'sha256'\r\n                };\r\n\r\n                var header = Browser.client.header('https://example.net/somewhere/over/the/rainbow', '', { credentials: credentials, timestamp: 1353809207, nonce: 'Ygvqdz', payload: 'something to write about', contentType: 'text/plain' });\r\n                expect(header.field).to.equal('');\r\n                expect(header.err).to.equal('Invalid argument type');\r\n                done();\r\n            });\r\n\r\n            it('errors on invalid method', function (done) {\r\n\r\n                var credentials = {\r\n                    id: '123456',\r\n                    key: '2983d45yun89q',\r\n                    algorithm: 'sha256'\r\n                };\r\n\r\n                var header = Browser.client.header('https://example.net/somewhere/over/the/rainbow', 5, { credentials: credentials, timestamp: 1353809207, nonce: 'Ygvqdz', payload: 'something to write about', contentType: 'text/plain' });\r\n                expect(header.field).to.equal('');\r\n                expect(header.err).to.equal('Invalid argument type');\r\n                done();\r\n            });\r\n\r\n            it('errors on missing credentials', function (done) {\r\n\r\n                var header = Browser.client.header('https://example.net/somewhere/over/the/rainbow', 'POST', { ext: 'Bazinga!', timestamp: 1353809207 });\r\n                expect(header.field).to.equal('');\r\n                expect(header.err).to.equal('Invalid credentials object');\r\n                done();\r\n            });\r\n\r\n            it('errors on invalid credentials (id)', function (done) {\r\n\r\n                var credentials = {\r\n                    key: '2983d45yun89q',\r\n                    algorithm: 'sha256'\r\n                };\r\n\r\n                var header = Browser.client.header('https://example.net/somewhere/over/the/rainbow', 'POST', { credentials: credentials, ext: 'Bazinga!', timestamp: 1353809207 });\r\n                expect(header.field).to.equal('');\r\n                expect(header.err).to.equal('Invalid credentials object');\r\n                done();\r\n            });\r\n\r\n            it('errors on invalid credentials (key)', function (done) {\r\n\r\n                var credentials = {\r\n                    id: '123456',\r\n                    algorithm: 'sha256'\r\n                };\r\n\r\n                var header = Browser.client.header('https://example.net/somewhere/over/the/rainbow', 'POST', { credentials: credentials, ext: 'Bazinga!', timestamp: 1353809207 });\r\n                expect(header.field).to.equal('');\r\n                expect(header.err).to.equal('Invalid credentials object');\r\n                done();\r\n            });\r\n\r\n            it('errors on invalid algorithm', function (done) {\r\n\r\n                var credentials = {\r\n                    id: '123456',\r\n                    key: '2983d45yun89q',\r\n                    algorithm: 'hmac-sha-0'\r\n                };\r\n\r\n                var header = Browser.client.header('https://example.net/somewhere/over/the/rainbow', 'POST', { credentials: credentials, payload: 'something, anything!', ext: 'Bazinga!', timestamp: 1353809207 });\r\n                expect(header.field).to.equal('');\r\n                expect(header.err).to.equal('Unknown algorithm');\r\n                done();\r\n            });\r\n\r\n            it('uses a pre-calculated payload hash', function (done) {\r\n\r\n                var credentials = {\r\n                    id: '123456',\r\n                    key: '2983d45yun89q',\r\n                    algorithm: 'sha256'\r\n                };\r\n\r\n                var options = { credentials: credentials, ext: 'Bazinga!', timestamp: 1353809207, nonce: 'Ygvqdz', payload: 'something to write about', contentType: 'text/plain' };\r\n                options.hash = Browser.crypto.calculatePayloadHash(options.payload, credentials.algorithm, options.contentType);\r\n                var header = Browser.client.header('https://example.net/somewhere/over/the/rainbow', 'POST', options).field;\r\n                expect(header).to.equal('Hawk id=\"123456\", ts=\"1353809207\", nonce=\"Ygvqdz\", hash=\"2QfCt3GuY9HQnHWyWD3wX68ZOKbynqlfYmuO2ZBRqtY=\", ext=\"Bazinga!\", mac=\"q1CwFoSHzPZSkbIvl0oYlD+91rBUEvFk763nMjMndj8=\"');\r\n                done();\r\n            });\r\n        });\r\n\r\n        describe('authenticate()', function () {\r\n\r\n            it('skips tsm validation when missing ts', function (done) {\r\n\r\n                var res = {\r\n                    headers: {\r\n                        'www-authenticate': 'Hawk error=\"Stale timestamp\"'\r\n                    },\r\n                    getResponseHeader: function (header) {\r\n\r\n                        return res.headers[header.toLowerCase()];\r\n                    }\r\n                };\r\n\r\n                var credentials = {\r\n                    id: '123456',\r\n                    key: 'werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn',\r\n                    algorithm: 'sha256',\r\n                    user: 'steve'\r\n                };\r\n\r\n                var artifacts = {\r\n                    ts: 1402135580,\r\n                    nonce: 'iBRB6t',\r\n                    method: 'GET',\r\n                    resource: '/resource/4?filter=a',\r\n                    host: 'example.com',\r\n                    port: '8080',\r\n                    ext: 'some-app-data'\r\n                };\r\n\r\n                expect(Browser.client.authenticate(res, credentials, artifacts)).to.equal(true);\r\n                done();\r\n            });\r\n\r\n            it('returns false on invalid header', function (done) {\r\n\r\n                var res = {\r\n                    headers: {\r\n                        'server-authorization': 'Hawk mac=\"abc\", bad=\"xyz\"'\r\n                    },\r\n                    getResponseHeader: function (header) {\r\n\r\n                        return res.headers[header.toLowerCase()];\r\n                    }\r\n                };\r\n\r\n                expect(Browser.client.authenticate(res, {})).to.equal(false);\r\n                done();\r\n            });\r\n\r\n            it('returns false on invalid mac', function (done) {\r\n\r\n                var res = {\r\n                    headers: {\r\n                        'content-type': 'text/plain',\r\n                        'server-authorization': 'Hawk mac=\"_IJRsMl/4oL+nn+vKoeVZPdCHXB4yJkNnBbTbHFZUYE=\", hash=\"f9cDF/TDm7TkYRLnGwRMfeDzT6LixQVLvrIKhh0vgmM=\", ext=\"response-specific\"'\r\n                    },\r\n                    getResponseHeader: function (header) {\r\n\r\n                        return res.headers[header.toLowerCase()];\r\n                    }\r\n                };\r\n\r\n                var artifacts = {\r\n                    method: 'POST',\r\n                    host: 'example.com',\r\n                    port: '8080',\r\n                    resource: '/resource/4?filter=a',\r\n                    ts: '1362336900',\r\n                    nonce: 'eb5S_L',\r\n                    hash: 'nJjkVtBE5Y/Bk38Aiokwn0jiJxt/0S2WRSUwWLCf5xk=',\r\n                    ext: 'some-app-data',\r\n                    app: undefined,\r\n                    dlg: undefined,\r\n                    mac: 'BlmSe8K+pbKIb6YsZCnt4E1GrYvY1AaYayNR82dGpIk=',\r\n                    id: '123456'\r\n                };\r\n\r\n                var credentials = {\r\n                    id: '123456',\r\n                    key: 'werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn',\r\n                    algorithm: 'sha256',\r\n                    user: 'steve'\r\n                };\r\n\r\n                expect(Browser.client.authenticate(res, credentials, artifacts)).to.equal(false);\r\n                done();\r\n            });\r\n\r\n            it('returns true on ignoring hash', function (done) {\r\n\r\n                var res = {\r\n                    headers: {\r\n                        'content-type': 'text/plain',\r\n                        'server-authorization': 'Hawk mac=\"XIJRsMl/4oL+nn+vKoeVZPdCHXB4yJkNnBbTbHFZUYE=\", hash=\"f9cDF/TDm7TkYRLnGwRMfeDzT6LixQVLvrIKhh0vgmM=\", ext=\"response-specific\"'\r\n                    },\r\n                    getResponseHeader: function (header) {\r\n\r\n                        return res.headers[header.toLowerCase()];\r\n                    }\r\n                };\r\n\r\n                var artifacts = {\r\n                    method: 'POST',\r\n                    host: 'example.com',\r\n                    port: '8080',\r\n                    resource: '/resource/4?filter=a',\r\n                    ts: '1362336900',\r\n                    nonce: 'eb5S_L',\r\n                    hash: 'nJjkVtBE5Y/Bk38Aiokwn0jiJxt/0S2WRSUwWLCf5xk=',\r\n                    ext: 'some-app-data',\r\n                    app: undefined,\r\n                    dlg: undefined,\r\n                    mac: 'BlmSe8K+pbKIb6YsZCnt4E1GrYvY1AaYayNR82dGpIk=',\r\n                    id: '123456'\r\n                };\r\n\r\n                var credentials = {\r\n                    id: '123456',\r\n                    key: 'werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn',\r\n                    algorithm: 'sha256',\r\n                    user: 'steve'\r\n                };\r\n\r\n                expect(Browser.client.authenticate(res, credentials, artifacts)).to.equal(true);\r\n                done();\r\n            });\r\n\r\n            it('errors on invalid WWW-Authenticate header format', function (done) {\r\n\r\n                var res = {\r\n                    headers: {\r\n                        'www-authenticate': 'Hawk ts=\"1362346425875\", tsm=\"PhwayS28vtnn3qbv0mqRBYSXebN/zggEtucfeZ620Zo=\", x=\"Stale timestamp\"'\r\n                    },\r\n                    getResponseHeader: function (header) {\r\n\r\n                        return res.headers[header.toLowerCase()];\r\n                    }\r\n                };\r\n\r\n                expect(Browser.client.authenticate(res, {})).to.equal(false);\r\n                done();\r\n            });\r\n\r\n            it('errors on invalid WWW-Authenticate header format', function (done) {\r\n\r\n                var credentials = {\r\n                    id: '123456',\r\n                    key: 'werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn',\r\n                    algorithm: 'sha256',\r\n                    user: 'steve'\r\n                };\r\n\r\n                var res = {\r\n                    headers: {\r\n                        'www-authenticate': 'Hawk ts=\"1362346425875\", tsm=\"hwayS28vtnn3qbv0mqRBYSXebN/zggEtucfeZ620Zo=\", error=\"Stale timestamp\"'\r\n                    },\r\n                    getResponseHeader: function (header) {\r\n\r\n                        return res.headers[header.toLowerCase()];\r\n                    }\r\n                };\r\n\r\n                expect(Browser.client.authenticate(res, credentials)).to.equal(false);\r\n                done();\r\n            });\r\n        });\r\n\r\n        describe('message()', function () {\r\n\r\n            it('generates an authorization then successfully parse it', function (done) {\r\n\r\n                credentialsFunc('123456', function (err, credentials1) {\r\n\r\n                    var auth = Browser.client.message('example.com', 8080, 'some message', { credentials: credentials1 });\r\n                    expect(auth).to.exist();\r\n\r\n                    Hawk.server.authenticateMessage('example.com', 8080, 'some message', auth, credentialsFunc, {}, function (err, credentials2) {\r\n\r\n                        expect(err).to.not.exist();\r\n                        expect(credentials2.user).to.equal('steve');\r\n                        done();\r\n                    });\r\n                });\r\n            });\r\n\r\n            it('generates an authorization using custom nonce/timestamp', function (done) {\r\n\r\n                credentialsFunc('123456', function (err, credentials) {\r\n\r\n                    var auth = Browser.client.message('example.com', 8080, 'some message', { credentials: credentials, nonce: 'abc123', timestamp: 1398536270957 });\r\n                    expect(auth).to.exist();\r\n                    expect(auth.nonce).to.equal('abc123');\r\n                    expect(auth.ts).to.equal(1398536270957);\r\n                    done();\r\n                });\r\n            });\r\n\r\n            it('errors on missing host', function (done) {\r\n\r\n                credentialsFunc('123456', function (err, credentials) {\r\n\r\n                    var auth = Browser.client.message(null, 8080, 'some message', { credentials: credentials });\r\n                    expect(auth).to.not.exist();\r\n                    done();\r\n                });\r\n            });\r\n\r\n            it('errors on invalid host', function (done) {\r\n\r\n                credentialsFunc('123456', function (err, credentials) {\r\n\r\n                    var auth = Browser.client.message(5, 8080, 'some message', { credentials: credentials });\r\n                    expect(auth).to.not.exist();\r\n                    done();\r\n                });\r\n            });\r\n\r\n            it('errors on missing port', function (done) {\r\n\r\n                credentialsFunc('123456', function (err, credentials) {\r\n\r\n                    var auth = Browser.client.message('example.com', 0, 'some message', { credentials: credentials });\r\n                    expect(auth).to.not.exist();\r\n                    done();\r\n                });\r\n            });\r\n\r\n            it('errors on invalid port', function (done) {\r\n\r\n                credentialsFunc('123456', function (err, credentials) {\r\n\r\n                    var auth = Browser.client.message('example.com', 'a', 'some message', { credentials: credentials });\r\n                    expect(auth).to.not.exist();\r\n                    done();\r\n                });\r\n            });\r\n\r\n            it('errors on missing message', function (done) {\r\n\r\n                credentialsFunc('123456', function (err, credentials) {\r\n\r\n                    var auth = Browser.client.message('example.com', 8080, undefined, { credentials: credentials });\r\n                    expect(auth).to.not.exist();\r\n                    done();\r\n                });\r\n            });\r\n\r\n            it('errors on null message', function (done) {\r\n\r\n                credentialsFunc('123456', function (err, credentials) {\r\n\r\n                    var auth = Browser.client.message('example.com', 8080, null, { credentials: credentials });\r\n                    expect(auth).to.not.exist();\r\n                    done();\r\n                });\r\n            });\r\n\r\n            it('errors on invalid message', function (done) {\r\n\r\n                credentialsFunc('123456', function (err, credentials) {\r\n\r\n                    var auth = Browser.client.message('example.com', 8080, 5, { credentials: credentials });\r\n                    expect(auth).to.not.exist();\r\n                    done();\r\n                });\r\n            });\r\n\r\n            it('errors on missing credentials', function (done) {\r\n\r\n                var auth = Browser.client.message('example.com', 8080, 'some message', {});\r\n                expect(auth).to.not.exist();\r\n                done();\r\n            });\r\n\r\n            it('errors on missing options', function (done) {\r\n\r\n                var auth = Browser.client.message('example.com', 8080, 'some message');\r\n                expect(auth).to.not.exist();\r\n                done();\r\n            });\r\n\r\n            it('errors on invalid credentials (id)', function (done) {\r\n\r\n                credentialsFunc('123456', function (err, credentials) {\r\n\r\n                    var creds = Hoek.clone(credentials);\r\n                    delete creds.id;\r\n                    var auth = Browser.client.message('example.com', 8080, 'some message', { credentials: creds });\r\n                    expect(auth).to.not.exist();\r\n                    done();\r\n                });\r\n            });\r\n\r\n            it('errors on invalid credentials (key)', function (done) {\r\n\r\n                credentialsFunc('123456', function (err, credentials) {\r\n\r\n                    var creds = Hoek.clone(credentials);\r\n                    delete creds.key;\r\n                    var auth = Browser.client.message('example.com', 8080, 'some message', { credentials: creds });\r\n                    expect(auth).to.not.exist();\r\n                    done();\r\n                });\r\n            });\r\n\r\n            it('errors on invalid algorithm', function (done) {\r\n\r\n                credentialsFunc('123456', function (err, credentials) {\r\n\r\n                    var creds = Hoek.clone(credentials);\r\n                    creds.algorithm = 'blah';\r\n                    var auth = Browser.client.message('example.com', 8080, 'some message', { credentials: creds });\r\n                    expect(auth).to.not.exist();\r\n                    done();\r\n                });\r\n            });\r\n        });\r\n\r\n        describe('authenticateTimestamp()', function (done) {\r\n\r\n            it('validates a timestamp', function (done) {\r\n\r\n                credentialsFunc('123456', function (err, credentials) {\r\n\r\n                    var tsm = Hawk.crypto.timestampMessage(credentials);\r\n                    expect(Browser.client.authenticateTimestamp(tsm, credentials)).to.equal(true);\r\n                    done();\r\n                });\r\n            });\r\n\r\n            it('validates a timestamp without updating local time', function (done) {\r\n\r\n                credentialsFunc('123456', function (err, credentials) {\r\n\r\n                    var offset = Browser.utils.getNtpOffset();\r\n                    var tsm = Hawk.crypto.timestampMessage(credentials, 10000);\r\n                    expect(Browser.client.authenticateTimestamp(tsm, credentials, false)).to.equal(true);\r\n                    expect(offset).to.equal(Browser.utils.getNtpOffset());\r\n                    done();\r\n                });\r\n            });\r\n\r\n            it('detects a bad timestamp', function (done) {\r\n\r\n                credentialsFunc('123456', function (err, credentials) {\r\n\r\n                    var tsm = Hawk.crypto.timestampMessage(credentials);\r\n                    tsm.ts = 4;\r\n                    expect(Browser.client.authenticateTimestamp(tsm, credentials)).to.equal(false);\r\n                    done();\r\n                });\r\n            });\r\n        });\r\n    });\r\n\r\n    describe('internals', function () {\r\n\r\n        describe('LocalStorage', function () {\r\n\r\n            it('goes through the full lifecycle', function (done) {\r\n\r\n                var storage = new Browser.internals.LocalStorage();\r\n                expect(storage.length).to.equal(0);\r\n                expect(storage.getItem('a')).to.equal(null);\r\n                storage.setItem('a', 5);\r\n                expect(storage.length).to.equal(1);\r\n                expect(storage.key()).to.equal('a');\r\n                expect(storage.key(0)).to.equal('a');\r\n                expect(storage.getItem('a')).to.equal('5');\r\n                storage.setItem('b', 'test');\r\n                expect(storage.key()).to.equal('a');\r\n                expect(storage.key(0)).to.equal('a');\r\n                expect(storage.key(1)).to.equal('b');\r\n                expect(storage.length).to.equal(2);\r\n                expect(storage.getItem('b')).to.equal('test');\r\n                storage.removeItem('a');\r\n                expect(storage.length).to.equal(1);\r\n                expect(storage.getItem('a')).to.equal(null);\r\n                expect(storage.getItem('b')).to.equal('test');\r\n                storage.clear();\r\n                expect(storage.length).to.equal(0);\r\n                expect(storage.getItem('a')).to.equal(null);\r\n                expect(storage.getItem('b')).to.equal(null);\r\n                done();\r\n            });\r\n        });\r\n    });\r\n\r\n    describe('utils', function () {\r\n\r\n        describe('setStorage()', function () {\r\n\r\n            it('sets storage for the first time', function (done) {\r\n\r\n                Browser.utils.storage = new Browser.internals.LocalStorage();        // Reset state\r\n\r\n                expect(Browser.utils.storage.getItem('hawk_ntp_offset')).to.not.exist();\r\n                Browser.utils.storage.setItem('test', '1');\r\n                Browser.utils.setStorage(new Browser.internals.LocalStorage());\r\n                expect(Browser.utils.storage.getItem('test')).to.not.exist();\r\n                Browser.utils.storage.setItem('test', '2');\r\n                expect(Browser.utils.storage.getItem('test')).to.equal('2');\r\n                done();\r\n            });\r\n        });\r\n\r\n        describe('setNtpOffset()', function (done) {\r\n\r\n            it('catches localStorage errors', { parallel: false }, function (done) {\r\n\r\n                var orig = Browser.utils.storage.setItem;\r\n                var consoleOrig = console.error;\r\n                var count = 0;\r\n                console.error = function () {\r\n\r\n                    if (count++ === 2) {\r\n\r\n                        console.error = consoleOrig;\r\n                    }\r\n                };\r\n\r\n                Browser.utils.storage.setItem = function () {\r\n\r\n                    Browser.utils.storage.setItem = orig;\r\n                    throw new Error();\r\n                };\r\n\r\n                expect(function () {\r\n\r\n                    Browser.utils.setNtpOffset(100);\r\n                }).not.to.throw();\r\n\r\n                done();\r\n            });\r\n        });\r\n\r\n        describe('parseAuthorizationHeader()', function (done) {\r\n\r\n            it('returns null on missing header', function (done) {\r\n\r\n                expect(Browser.utils.parseAuthorizationHeader()).to.equal(null);\r\n                done();\r\n            });\r\n\r\n            it('returns null on bad header syntax (structure)', function (done) {\r\n\r\n                expect(Browser.utils.parseAuthorizationHeader('Hawk')).to.equal(null);\r\n                done();\r\n            });\r\n\r\n            it('returns null on bad header syntax (parts)', function (done) {\r\n\r\n                expect(Browser.utils.parseAuthorizationHeader(' ')).to.equal(null);\r\n                done();\r\n            });\r\n\r\n            it('returns null on bad scheme name', function (done) {\r\n\r\n                expect(Browser.utils.parseAuthorizationHeader('Basic asdasd')).to.equal(null);\r\n                done();\r\n            });\r\n\r\n            it('returns null on bad attribute value', function (done) {\r\n\r\n                expect(Browser.utils.parseAuthorizationHeader('Hawk test=\"\\t\"', ['test'])).to.equal(null);\r\n                done();\r\n            });\r\n\r\n            it('returns null on duplicated attribute', function (done) {\r\n\r\n                expect(Browser.utils.parseAuthorizationHeader('Hawk test=\"a\", test=\"b\"', ['test'])).to.equal(null);\r\n                done();\r\n            });\r\n        });\r\n\r\n        describe('parseUri()', function () {\r\n\r\n            it('returns empty object on invalid', function (done) {\r\n\r\n                var uri = Browser.utils.parseUri('ftp');\r\n                expect(uri).to.deep.equal({ host: '', port: '', resource: '' });\r\n                done();\r\n            });\r\n\r\n            it('returns empty port when unknown scheme', function (done) {\r\n\r\n                var uri = Browser.utils.parseUri('ftp://example.com');\r\n                expect(uri.port).to.equal('');\r\n                done();\r\n            });\r\n\r\n            it('returns default port when missing', function (done) {\r\n\r\n                var uri = Browser.utils.parseUri('http://example.com');\r\n                expect(uri.port).to.equal('80');\r\n                done();\r\n            });\r\n\r\n            it('handles unusual characters correctly', function (done) {\r\n\r\n                var parts = {\r\n                    protocol: 'http+vnd.my-extension',\r\n                    user: 'user!$&\\'()*+,;=%40my-domain.com',\r\n                    password: 'pass!$&\\'()*+,;=%40:word',\r\n                    hostname: 'foo-bar.com',\r\n                    port: '99',\r\n                    pathname: '/path/%40/!$&\\'()*+,;=:@/',\r\n                    query: 'query%40/!$&\\'()*+,;=:@/?',\r\n                    fragment: 'fragm%40/!$&\\'()*+,;=:@/?'\r\n                };\r\n\r\n                parts.userInfo = parts.user + ':' + parts.password;\r\n                parts.authority = parts.userInfo + '@' + parts.hostname + ':' + parts.port;\r\n                parts.relative = parts.pathname + '?' + parts.query;\r\n                parts.resource = parts.relative + '#' + parts.fragment;\r\n                parts.source = parts.protocol + '://' + parts.authority + parts.resource;\r\n\r\n                var uri = Browser.utils.parseUri(parts.source);\r\n                expect(uri.host).to.equal('foo-bar.com');\r\n                expect(uri.port).to.equal('99');\r\n                expect(uri.resource).to.equal(parts.pathname + '?' + parts.query);\r\n                done();\r\n            });\r\n        });\r\n\r\n        var str = 'https://www.google.ca/webhp?sourceid=chrome-instant&ion=1&espv=2&ie=UTF-8#q=url';\r\n        var base64str = 'aHR0cHM6Ly93d3cuZ29vZ2xlLmNhL3dlYmhwP3NvdXJjZWlkPWNocm9tZS1pbnN0YW50Jmlvbj0xJmVzcHY9MiZpZT1VVEYtOCNxPXVybA';\r\n\r\n        describe('base64urlEncode()', function () {\r\n\r\n            it('should base64 URL-safe decode a string', function (done) {\r\n\r\n                expect(Browser.utils.base64urlEncode(str)).to.equal(base64str);\r\n                done();\r\n            });\r\n        });\r\n    });\r\n});\r\n"]}