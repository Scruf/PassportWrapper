{"version":3,"sources":["uri.js"],"names":[],"mappings":"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","file":"uri-compiled.js","sourcesContent":["// Load modules\r\n\r\nvar Http = require('http');\r\nvar Url = require('url');\r\nvar Code = require('code');\r\nvar Hawk = require('../lib');\r\nvar Hoek = require('hoek');\r\nvar Lab = require('lab');\r\n\r\n\r\n// Declare internals\r\n\r\nvar internals = {};\r\n\r\n\r\n// Test shortcuts\r\n\r\nvar lab = exports.lab = Lab.script();\r\nvar describe = lab.experiment;\r\nvar it = lab.test;\r\nvar expect = Code.expect;\r\n\r\n\r\ndescribe('Uri', function () {\r\n\r\n    var credentialsFunc = function (id, callback) {\r\n\r\n        var credentials = {\r\n            id: id,\r\n            key: 'werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn',\r\n            algorithm: (id === '1' ? 'sha1' : 'sha256'),\r\n            user: 'steve'\r\n        };\r\n\r\n        return callback(null, credentials);\r\n    };\r\n\r\n    it('should generate a bewit then successfully authenticate it', function (done) {\r\n\r\n        var req = {\r\n            method: 'GET',\r\n            url: '/resource/4?a=1&b=2',\r\n            host: 'example.com',\r\n            port: 80\r\n        };\r\n\r\n        credentialsFunc('123456', function (err, credentials1) {\r\n\r\n            var bewit = Hawk.uri.getBewit('http://example.com/resource/4?a=1&b=2', { credentials: credentials1, ttlSec: 60 * 60 * 24 * 365 * 100, ext: 'some-app-data' });\r\n            req.url += '&bewit=' + bewit;\r\n\r\n            Hawk.uri.authenticate(req, credentialsFunc, {}, function (err, credentials2, attributes) {\r\n\r\n                expect(err).to.not.exist();\r\n                expect(credentials2.user).to.equal('steve');\r\n                expect(attributes.ext).to.equal('some-app-data');\r\n                done();\r\n            });\r\n        });\r\n    });\r\n\r\n    it('should generate a bewit then successfully authenticate it (no ext)', function (done) {\r\n\r\n        var req = {\r\n            method: 'GET',\r\n            url: '/resource/4?a=1&b=2',\r\n            host: 'example.com',\r\n            port: 80\r\n        };\r\n\r\n        credentialsFunc('123456', function (err, credentials1) {\r\n\r\n            var bewit = Hawk.uri.getBewit('http://example.com/resource/4?a=1&b=2', { credentials: credentials1, ttlSec: 60 * 60 * 24 * 365 * 100 });\r\n            req.url += '&bewit=' + bewit;\r\n\r\n            Hawk.uri.authenticate(req, credentialsFunc, {}, function (err, credentials2, attributes) {\r\n\r\n                expect(err).to.not.exist();\r\n                expect(credentials2.user).to.equal('steve');\r\n                done();\r\n            });\r\n        });\r\n    });\r\n\r\n    it('should successfully authenticate a request (last param)', function (done) {\r\n\r\n        var req = {\r\n            method: 'GET',\r\n            url: '/resource/4?a=1&b=2&bewit=MTIzNDU2XDQ1MTE0ODQ2MjFcMzFjMmNkbUJFd1NJRVZDOVkva1NFb2c3d3YrdEVNWjZ3RXNmOGNHU2FXQT1cc29tZS1hcHAtZGF0YQ',\r\n            host: 'example.com',\r\n            port: 8080\r\n        };\r\n\r\n        Hawk.uri.authenticate(req, credentialsFunc, {}, function (err, credentials, attributes) {\r\n\r\n            expect(err).to.not.exist();\r\n            expect(credentials.user).to.equal('steve');\r\n            expect(attributes.ext).to.equal('some-app-data');\r\n            done();\r\n        });\r\n    });\r\n\r\n    it('should successfully authenticate a request (first param)', function (done) {\r\n\r\n        var req = {\r\n            method: 'GET',\r\n            url: '/resource/4?bewit=MTIzNDU2XDQ1MTE0ODQ2MjFcMzFjMmNkbUJFd1NJRVZDOVkva1NFb2c3d3YrdEVNWjZ3RXNmOGNHU2FXQT1cc29tZS1hcHAtZGF0YQ&a=1&b=2',\r\n            host: 'example.com',\r\n            port: 8080\r\n        };\r\n\r\n        Hawk.uri.authenticate(req, credentialsFunc, {}, function (err, credentials, attributes) {\r\n\r\n            expect(err).to.not.exist();\r\n            expect(credentials.user).to.equal('steve');\r\n            expect(attributes.ext).to.equal('some-app-data');\r\n            done();\r\n        });\r\n    });\r\n\r\n    it('should successfully authenticate a request (only param)', function (done) {\r\n\r\n        var req = {\r\n            method: 'GET',\r\n            url: '/resource/4?bewit=MTIzNDU2XDQ1MTE0ODQ2NDFcZm1CdkNWT3MvcElOTUUxSTIwbWhrejQ3UnBwTmo4Y1VrSHpQd3Q5OXJ1cz1cc29tZS1hcHAtZGF0YQ',\r\n            host: 'example.com',\r\n            port: 8080\r\n        };\r\n\r\n        Hawk.uri.authenticate(req, credentialsFunc, {}, function (err, credentials, attributes) {\r\n\r\n            expect(err).to.not.exist();\r\n            expect(credentials.user).to.equal('steve');\r\n            expect(attributes.ext).to.equal('some-app-data');\r\n            done();\r\n        });\r\n    });\r\n\r\n    it('should fail on multiple authentication', function (done) {\r\n\r\n        var req = {\r\n            method: 'GET',\r\n            url: '/resource/4?bewit=MTIzNDU2XDQ1MTE0ODQ2NDFcZm1CdkNWT3MvcElOTUUxSTIwbWhrejQ3UnBwTmo4Y1VrSHpQd3Q5OXJ1cz1cc29tZS1hcHAtZGF0YQ',\r\n            host: 'example.com',\r\n            port: 8080,\r\n            authorization: 'Basic asdasdasdasd'\r\n        };\r\n\r\n        Hawk.uri.authenticate(req, credentialsFunc, {}, function (err, credentials, attributes) {\r\n\r\n            expect(err).to.exist();\r\n            expect(err.output.payload.message).to.equal('Multiple authentications');\r\n            done();\r\n        });\r\n    });\r\n\r\n    it('should fail on method other than GET', function (done) {\r\n\r\n        credentialsFunc('123456', function (err, credentials1) {\r\n\r\n            var req = {\r\n                method: 'POST',\r\n                url: '/resource/4?filter=a',\r\n                host: 'example.com',\r\n                port: 8080\r\n            };\r\n\r\n            var exp = Math.floor(Hawk.utils.now() / 1000) + 60;\r\n            var ext = 'some-app-data';\r\n            var mac = Hawk.crypto.calculateMac('bewit', credentials1, {\r\n                timestamp: exp,\r\n                nonce: '',\r\n                method: req.method,\r\n                resource: req.url,\r\n                host: req.host,\r\n                port: req.port,\r\n                ext: ext\r\n            });\r\n\r\n            var bewit = credentials1.id + '\\\\' + exp + '\\\\' + mac + '\\\\' + ext;\r\n\r\n            req.url += '&bewit=' + Hoek.base64urlEncode(bewit);\r\n\r\n            Hawk.uri.authenticate(req, credentialsFunc, {}, function (err, credentials2, attributes) {\r\n\r\n                expect(err).to.exist();\r\n                expect(err.output.payload.message).to.equal('Invalid method');\r\n                done();\r\n            });\r\n        });\r\n    });\r\n\r\n    it('should fail on invalid host header', function (done) {\r\n\r\n        var req = {\r\n            method: 'GET',\r\n            url: '/resource/4?bewit=MTIzNDU2XDQ1MDk5OTE3MTlcTUE2eWkwRWRwR0pEcWRwb0JkYVdvVDJrL0hDSzA1T0Y3MkhuZlVmVy96Zz1cc29tZS1hcHAtZGF0YQ',\r\n            headers: {\r\n                host: 'example.com:something'\r\n            }\r\n        };\r\n\r\n        Hawk.uri.authenticate(req, credentialsFunc, {}, function (err, credentials, attributes) {\r\n\r\n            expect(err).to.exist();\r\n            expect(err.output.payload.message).to.equal('Invalid Host header');\r\n            done();\r\n        });\r\n    });\r\n\r\n    it('should fail on empty bewit', function (done) {\r\n\r\n        var req = {\r\n            method: 'GET',\r\n            url: '/resource/4?bewit=',\r\n            host: 'example.com',\r\n            port: 8080\r\n        };\r\n\r\n        Hawk.uri.authenticate(req, credentialsFunc, {}, function (err, credentials, attributes) {\r\n\r\n            expect(err).to.exist();\r\n            expect(err.output.payload.message).to.equal('Empty bewit');\r\n            expect(err.isMissing).to.not.exist();\r\n            done();\r\n        });\r\n    });\r\n\r\n    it('should fail on invalid bewit', function (done) {\r\n\r\n        var req = {\r\n            method: 'GET',\r\n            url: '/resource/4?bewit=*',\r\n            host: 'example.com',\r\n            port: 8080\r\n        };\r\n\r\n        Hawk.uri.authenticate(req, credentialsFunc, {}, function (err, credentials, attributes) {\r\n\r\n            expect(err).to.exist();\r\n            expect(err.output.payload.message).to.equal('Invalid bewit encoding');\r\n            expect(err.isMissing).to.not.exist();\r\n            done();\r\n        });\r\n    });\r\n\r\n    it('should fail on missing bewit', function (done) {\r\n\r\n        var req = {\r\n            method: 'GET',\r\n            url: '/resource/4',\r\n            host: 'example.com',\r\n            port: 8080\r\n        };\r\n\r\n        Hawk.uri.authenticate(req, credentialsFunc, {}, function (err, credentials, attributes) {\r\n\r\n            expect(err).to.exist();\r\n            expect(err.output.payload.message).to.not.exist();\r\n            expect(err.isMissing).to.equal(true);\r\n            done();\r\n        });\r\n    });\r\n\r\n    it('should fail on invalid bewit structure', function (done) {\r\n\r\n        var req = {\r\n            method: 'GET',\r\n            url: '/resource/4?bewit=abc',\r\n            host: 'example.com',\r\n            port: 8080\r\n        };\r\n\r\n        Hawk.uri.authenticate(req, credentialsFunc, {}, function (err, credentials, attributes) {\r\n\r\n            expect(err).to.exist();\r\n            expect(err.output.payload.message).to.equal('Invalid bewit structure');\r\n            done();\r\n        });\r\n    });\r\n\r\n    it('should fail on empty bewit attribute', function (done) {\r\n\r\n        var req = {\r\n            method: 'GET',\r\n            url: '/resource/4?bewit=YVxcY1xk',\r\n            host: 'example.com',\r\n            port: 8080\r\n        };\r\n\r\n        Hawk.uri.authenticate(req, credentialsFunc, {}, function (err, credentials, attributes) {\r\n\r\n            expect(err).to.exist();\r\n            expect(err.output.payload.message).to.equal('Missing bewit attributes');\r\n            done();\r\n        });\r\n    });\r\n\r\n    it('should fail on missing bewit id attribute', function (done) {\r\n\r\n        var req = {\r\n            method: 'GET',\r\n            url: '/resource/4?bewit=XDQ1NTIxNDc2MjJcK0JFbFhQMXhuWjcvd1Nrbm1ldGhlZm5vUTNHVjZNSlFVRHk4NWpTZVJ4VT1cc29tZS1hcHAtZGF0YQ',\r\n            host: 'example.com',\r\n            port: 8080\r\n        };\r\n\r\n        Hawk.uri.authenticate(req, credentialsFunc, {}, function (err, credentials, attributes) {\r\n\r\n            expect(err).to.exist();\r\n            expect(err.output.payload.message).to.equal('Missing bewit attributes');\r\n            done();\r\n        });\r\n    });\r\n\r\n    it('should fail on expired access', function (done) {\r\n\r\n        var req = {\r\n            method: 'GET',\r\n            url: '/resource/4?a=1&b=2&bewit=MTIzNDU2XDEzNTY0MTg1ODNcWk1wZlMwWU5KNHV0WHpOMmRucTRydEk3NXNXTjFjeWVITTcrL0tNZFdVQT1cc29tZS1hcHAtZGF0YQ',\r\n            host: 'example.com',\r\n            port: 8080\r\n        };\r\n\r\n        Hawk.uri.authenticate(req, credentialsFunc, {}, function (err, credentials, attributes) {\r\n\r\n            expect(err).to.exist();\r\n            expect(err.output.payload.message).to.equal('Access expired');\r\n            done();\r\n        });\r\n    });\r\n\r\n    it('should fail on credentials function error', function (done) {\r\n\r\n        var req = {\r\n            method: 'GET',\r\n            url: '/resource/4?bewit=MTIzNDU2XDQ1MDk5OTE3MTlcTUE2eWkwRWRwR0pEcWRwb0JkYVdvVDJrL0hDSzA1T0Y3MkhuZlVmVy96Zz1cc29tZS1hcHAtZGF0YQ',\r\n            host: 'example.com',\r\n            port: 8080\r\n        };\r\n\r\n        Hawk.uri.authenticate(req, function (id, callback) {\r\n\r\n            callback(Hawk.error.badRequest('Boom'));\r\n        }, {}, function (err, credentials, attributes) {\r\n\r\n            expect(err).to.exist();\r\n            expect(err.output.payload.message).to.equal('Boom');\r\n            done();\r\n        });\r\n    });\r\n\r\n    it('should fail on credentials function error with credentials', function (done) {\r\n\r\n        var req = {\r\n            method: 'GET',\r\n            url: '/resource/4?bewit=MTIzNDU2XDQ1MDk5OTE3MTlcTUE2eWkwRWRwR0pEcWRwb0JkYVdvVDJrL0hDSzA1T0Y3MkhuZlVmVy96Zz1cc29tZS1hcHAtZGF0YQ',\r\n            host: 'example.com',\r\n            port: 8080\r\n        };\r\n\r\n        Hawk.uri.authenticate(req, function (id, callback) {\r\n\r\n            callback(Hawk.error.badRequest('Boom'), { some: 'value' });\r\n        }, {}, function (err, credentials, attributes) {\r\n\r\n            expect(err).to.exist();\r\n            expect(err.output.payload.message).to.equal('Boom');\r\n            expect(credentials.some).to.equal('value');\r\n            done();\r\n        });\r\n    });\r\n\r\n    it('should fail on null credentials function response', function (done) {\r\n\r\n        var req = {\r\n            method: 'GET',\r\n            url: '/resource/4?bewit=MTIzNDU2XDQ1MDk5OTE3MTlcTUE2eWkwRWRwR0pEcWRwb0JkYVdvVDJrL0hDSzA1T0Y3MkhuZlVmVy96Zz1cc29tZS1hcHAtZGF0YQ',\r\n            host: 'example.com',\r\n            port: 8080\r\n        };\r\n\r\n        Hawk.uri.authenticate(req, function (id, callback) {\r\n\r\n            callback(null, null);\r\n        }, {}, function (err, credentials, attributes) {\r\n\r\n            expect(err).to.exist();\r\n            expect(err.output.payload.message).to.equal('Unknown credentials');\r\n            done();\r\n        });\r\n    });\r\n\r\n    it('should fail on invalid credentials function response', function (done) {\r\n\r\n        var req = {\r\n            method: 'GET',\r\n            url: '/resource/4?bewit=MTIzNDU2XDQ1MDk5OTE3MTlcTUE2eWkwRWRwR0pEcWRwb0JkYVdvVDJrL0hDSzA1T0Y3MkhuZlVmVy96Zz1cc29tZS1hcHAtZGF0YQ',\r\n            host: 'example.com',\r\n            port: 8080\r\n        };\r\n\r\n        Hawk.uri.authenticate(req, function (id, callback) {\r\n\r\n            callback(null, {});\r\n        }, {}, function (err, credentials, attributes) {\r\n\r\n            expect(err).to.exist();\r\n            expect(err.message).to.equal('Invalid credentials');\r\n            done();\r\n        });\r\n    });\r\n\r\n    it('should fail on invalid credentials function response (unknown algorithm)', function (done) {\r\n\r\n        var req = {\r\n            method: 'GET',\r\n            url: '/resource/4?bewit=MTIzNDU2XDQ1MDk5OTE3MTlcTUE2eWkwRWRwR0pEcWRwb0JkYVdvVDJrL0hDSzA1T0Y3MkhuZlVmVy96Zz1cc29tZS1hcHAtZGF0YQ',\r\n            host: 'example.com',\r\n            port: 8080\r\n        };\r\n\r\n        Hawk.uri.authenticate(req, function (id, callback) {\r\n\r\n            callback(null, { key: 'xxx', algorithm: 'xxx' });\r\n        }, {}, function (err, credentials, attributes) {\r\n\r\n            expect(err).to.exist();\r\n            expect(err.message).to.equal('Unknown algorithm');\r\n            done();\r\n        });\r\n    });\r\n\r\n    it('should fail on expired access', function (done) {\r\n\r\n        var req = {\r\n            method: 'GET',\r\n            url: '/resource/4?bewit=MTIzNDU2XDQ1MDk5OTE3MTlcTUE2eWkwRWRwR0pEcWRwb0JkYVdvVDJrL0hDSzA1T0Y3MkhuZlVmVy96Zz1cc29tZS1hcHAtZGF0YQ',\r\n            host: 'example.com',\r\n            port: 8080\r\n        };\r\n\r\n        Hawk.uri.authenticate(req, function (id, callback) {\r\n\r\n            callback(null, { key: 'xxx', algorithm: 'sha256' });\r\n        }, {}, function (err, credentials, attributes) {\r\n\r\n            expect(err).to.exist();\r\n            expect(err.output.payload.message).to.equal('Bad mac');\r\n            done();\r\n        });\r\n    });\r\n\r\n    describe('getBewit()', function () {\r\n\r\n        it('returns a valid bewit value', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: '2983d45yun89q',\r\n                algorithm: 'sha256'\r\n            };\r\n\r\n            var bewit = Hawk.uri.getBewit('https://example.com/somewhere/over/the/rainbow', { credentials: credentials, ttlSec: 300, localtimeOffsetMsec: 1356420407232 - Hawk.utils.now(), ext: 'xandyandz' });\r\n            expect(bewit).to.equal('MTIzNDU2XDEzNTY0MjA3MDdca3NjeHdOUjJ0SnBQMVQxekRMTlBiQjVVaUtJVTl0T1NKWFRVZEc3WDloOD1ceGFuZHlhbmR6');\r\n            done();\r\n        });\r\n\r\n        it('returns a valid bewit value (explicit port)', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: '2983d45yun89q',\r\n                algorithm: 'sha256'\r\n            };\r\n\r\n            var bewit = Hawk.uri.getBewit('https://example.com:8080/somewhere/over/the/rainbow', { credentials: credentials, ttlSec: 300, localtimeOffsetMsec: 1356420407232 - Hawk.utils.now(), ext: 'xandyandz' });\r\n            expect(bewit).to.equal('MTIzNDU2XDEzNTY0MjA3MDdcaFpiSjNQMmNLRW80a3kwQzhqa1pBa1J5Q1p1ZWc0V1NOYnhWN3ZxM3hIVT1ceGFuZHlhbmR6');\r\n            done();\r\n        });\r\n\r\n        it('returns a valid bewit value (null ext)', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: '2983d45yun89q',\r\n                algorithm: 'sha256'\r\n            };\r\n\r\n            var bewit = Hawk.uri.getBewit('https://example.com/somewhere/over/the/rainbow', { credentials: credentials, ttlSec: 300, localtimeOffsetMsec: 1356420407232 - Hawk.utils.now(), ext: null });\r\n            expect(bewit).to.equal('MTIzNDU2XDEzNTY0MjA3MDdcSUdZbUxnSXFMckNlOEN4dktQczRKbFdJQStValdKSm91d2dBUmlWaENBZz1c');\r\n            done();\r\n        });\r\n\r\n        it('returns a valid bewit value (parsed uri)', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: '2983d45yun89q',\r\n                algorithm: 'sha256'\r\n            };\r\n\r\n            var bewit = Hawk.uri.getBewit(Url.parse('https://example.com/somewhere/over/the/rainbow'), { credentials: credentials, ttlSec: 300, localtimeOffsetMsec: 1356420407232 - Hawk.utils.now(), ext: 'xandyandz' });\r\n            expect(bewit).to.equal('MTIzNDU2XDEzNTY0MjA3MDdca3NjeHdOUjJ0SnBQMVQxekRMTlBiQjVVaUtJVTl0T1NKWFRVZEc3WDloOD1ceGFuZHlhbmR6');\r\n            done();\r\n        });\r\n\r\n        it('errors on invalid options', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: '2983d45yun89q',\r\n                algorithm: 'sha256'\r\n            };\r\n\r\n            var bewit = Hawk.uri.getBewit('https://example.com/somewhere/over/the/rainbow', 4);\r\n            expect(bewit).to.equal('');\r\n            done();\r\n        });\r\n\r\n        it('errors on missing uri', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: '2983d45yun89q',\r\n                algorithm: 'sha256'\r\n            };\r\n\r\n            var bewit = Hawk.uri.getBewit('', { credentials: credentials, ttlSec: 300, localtimeOffsetMsec: 1356420407232 - Hawk.utils.now(), ext: 'xandyandz' });\r\n            expect(bewit).to.equal('');\r\n            done();\r\n        });\r\n\r\n        it('errors on invalid uri', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: '2983d45yun89q',\r\n                algorithm: 'sha256'\r\n            };\r\n\r\n            var bewit = Hawk.uri.getBewit(5, { credentials: credentials, ttlSec: 300, localtimeOffsetMsec: 1356420407232 - Hawk.utils.now(), ext: 'xandyandz' });\r\n            expect(bewit).to.equal('');\r\n            done();\r\n        });\r\n\r\n        it('errors on invalid credentials (id)', function (done) {\r\n\r\n            var credentials = {\r\n                key: '2983d45yun89q',\r\n                algorithm: 'sha256'\r\n            };\r\n\r\n            var bewit = Hawk.uri.getBewit('https://example.com/somewhere/over/the/rainbow', { credentials: credentials, ttlSec: 3000, ext: 'xandyandz' });\r\n            expect(bewit).to.equal('');\r\n            done();\r\n        });\r\n\r\n        it('errors on missing credentials', function (done) {\r\n\r\n            var bewit = Hawk.uri.getBewit('https://example.com/somewhere/over/the/rainbow', { ttlSec: 3000, ext: 'xandyandz' });\r\n            expect(bewit).to.equal('');\r\n            done();\r\n        });\r\n\r\n        it('errors on invalid credentials (key)', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                algorithm: 'sha256'\r\n            };\r\n\r\n            var bewit = Hawk.uri.getBewit('https://example.com/somewhere/over/the/rainbow', { credentials: credentials, ttlSec: 3000, ext: 'xandyandz' });\r\n            expect(bewit).to.equal('');\r\n            done();\r\n        });\r\n\r\n        it('errors on invalid algorithm', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: '2983d45yun89q',\r\n                algorithm: 'hmac-sha-0'\r\n            };\r\n\r\n            var bewit = Hawk.uri.getBewit('https://example.com/somewhere/over/the/rainbow', { credentials: credentials, ttlSec: 300, ext: 'xandyandz' });\r\n            expect(bewit).to.equal('');\r\n            done();\r\n        });\r\n\r\n        it('errors on missing options', function (done) {\r\n\r\n            var credentials = {\r\n                id: '123456',\r\n                key: '2983d45yun89q',\r\n                algorithm: 'hmac-sha-0'\r\n            };\r\n\r\n            var bewit = Hawk.uri.getBewit('https://example.com/somewhere/over/the/rainbow');\r\n            expect(bewit).to.equal('');\r\n            done();\r\n        });\r\n    });\r\n\r\n    describe('authenticateMessage()', function () {\r\n\r\n        it('should generate an authorization then successfully parse it', function (done) {\r\n\r\n            credentialsFunc('123456', function (err, credentials1) {\r\n\r\n                var auth = Hawk.client.message('example.com', 8080, 'some message', { credentials: credentials1 });\r\n                expect(auth).to.exist();\r\n\r\n                Hawk.server.authenticateMessage('example.com', 8080, 'some message', auth, credentialsFunc, {}, function (err, credentials2) {\r\n\r\n                    expect(err).to.not.exist();\r\n                    expect(credentials2.user).to.equal('steve');\r\n                    done();\r\n                });\r\n            });\r\n        });\r\n\r\n        it('should fail authorization on mismatching host', function (done) {\r\n\r\n            credentialsFunc('123456', function (err, credentials1) {\r\n\r\n                var auth = Hawk.client.message('example.com', 8080, 'some message', { credentials: credentials1 });\r\n                expect(auth).to.exist();\r\n\r\n                Hawk.server.authenticateMessage('example1.com', 8080, 'some message', auth, credentialsFunc, {}, function (err, credentials2) {\r\n\r\n                    expect(err).to.exist();\r\n                    expect(err.message).to.equal('Bad mac');\r\n                    done();\r\n                });\r\n            });\r\n        });\r\n\r\n        it('should fail authorization on stale timestamp', function (done) {\r\n\r\n            credentialsFunc('123456', function (err, credentials1) {\r\n\r\n                var auth = Hawk.client.message('example.com', 8080, 'some message', { credentials: credentials1 });\r\n                expect(auth).to.exist();\r\n\r\n                Hawk.server.authenticateMessage('example.com', 8080, 'some message', auth, credentialsFunc, { localtimeOffsetMsec: 100000 }, function (err, credentials2) {\r\n\r\n                    expect(err).to.exist();\r\n                    expect(err.message).to.equal('Stale timestamp');\r\n                    done();\r\n                });\r\n            });\r\n        });\r\n\r\n        it('overrides timestampSkewSec', function (done) {\r\n\r\n            credentialsFunc('123456', function (err, credentials1) {\r\n\r\n                var auth = Hawk.client.message('example.com', 8080, 'some message', { credentials: credentials1, localtimeOffsetMsec: 100000 });\r\n                expect(auth).to.exist();\r\n\r\n                Hawk.server.authenticateMessage('example.com', 8080, 'some message', auth, credentialsFunc, { timestampSkewSec: 500 }, function (err, credentials2) {\r\n\r\n                    expect(err).to.not.exist();\r\n                    done();\r\n                });\r\n            });\r\n        });\r\n\r\n        it('should fail authorization on invalid authorization', function (done) {\r\n\r\n            credentialsFunc('123456', function (err, credentials1) {\r\n\r\n                var auth = Hawk.client.message('example.com', 8080, 'some message', { credentials: credentials1 });\r\n                expect(auth).to.exist();\r\n                delete auth.id;\r\n\r\n                Hawk.server.authenticateMessage('example.com', 8080, 'some message', auth, credentialsFunc, {}, function (err, credentials2) {\r\n\r\n                    expect(err).to.exist();\r\n                    expect(err.message).to.equal('Invalid authorization');\r\n                    done();\r\n                });\r\n            });\r\n        });\r\n\r\n        it('should fail authorization on bad hash', function (done) {\r\n\r\n            credentialsFunc('123456', function (err, credentials1) {\r\n\r\n                var auth = Hawk.client.message('example.com', 8080, 'some message', { credentials: credentials1 });\r\n                expect(auth).to.exist();\r\n\r\n                Hawk.server.authenticateMessage('example.com', 8080, 'some message1', auth, credentialsFunc, {}, function (err, credentials2) {\r\n\r\n                    expect(err).to.exist();\r\n                    expect(err.message).to.equal('Bad message hash');\r\n                    done();\r\n                });\r\n            });\r\n        });\r\n\r\n        it('should fail authorization on nonce error', function (done) {\r\n\r\n            credentialsFunc('123456', function (err, credentials1) {\r\n\r\n                var auth = Hawk.client.message('example.com', 8080, 'some message', { credentials: credentials1 });\r\n                expect(auth).to.exist();\r\n\r\n                Hawk.server.authenticateMessage('example.com', 8080, 'some message', auth, credentialsFunc, {\r\n                    nonceFunc: function (key, nonce, ts, callback) {\r\n\r\n                        callback(new Error('kaboom'));\r\n                    }\r\n                }, function (err, credentials2) {\r\n\r\n                    expect(err).to.exist();\r\n                    expect(err.message).to.equal('Invalid nonce');\r\n                    done();\r\n                });\r\n            });\r\n        });\r\n\r\n        it('should fail authorization on credentials error', function (done) {\r\n\r\n            credentialsFunc('123456', function (err, credentials1) {\r\n\r\n                var auth = Hawk.client.message('example.com', 8080, 'some message', { credentials: credentials1 });\r\n                expect(auth).to.exist();\r\n\r\n                var errFunc = function (id, callback) {\r\n\r\n                    callback(new Error('kablooey'));\r\n                };\r\n\r\n                Hawk.server.authenticateMessage('example.com', 8080, 'some message', auth, errFunc, {}, function (err, credentials2) {\r\n\r\n                    expect(err).to.exist();\r\n                    expect(err.message).to.equal('kablooey');\r\n                    done();\r\n                });\r\n            });\r\n        });\r\n\r\n        it('should fail authorization on missing credentials', function (done) {\r\n\r\n            credentialsFunc('123456', function (err, credentials1) {\r\n\r\n                var auth = Hawk.client.message('example.com', 8080, 'some message', { credentials: credentials1 });\r\n                expect(auth).to.exist();\r\n\r\n                var errFunc = function (id, callback) {\r\n\r\n                    callback();\r\n                };\r\n\r\n                Hawk.server.authenticateMessage('example.com', 8080, 'some message', auth, errFunc, {}, function (err, credentials2) {\r\n\r\n                    expect(err).to.exist();\r\n                    expect(err.message).to.equal('Unknown credentials');\r\n                    done();\r\n                });\r\n            });\r\n        });\r\n\r\n        it('should fail authorization on invalid credentials', function (done) {\r\n\r\n            credentialsFunc('123456', function (err, credentials1) {\r\n\r\n                var auth = Hawk.client.message('example.com', 8080, 'some message', { credentials: credentials1 });\r\n                expect(auth).to.exist();\r\n\r\n                var errFunc = function (id, callback) {\r\n\r\n                    callback(null, {});\r\n                };\r\n\r\n                Hawk.server.authenticateMessage('example.com', 8080, 'some message', auth, errFunc, {}, function (err, credentials2) {\r\n\r\n                    expect(err).to.exist();\r\n                    expect(err.message).to.equal('Invalid credentials');\r\n                    done();\r\n                });\r\n            });\r\n        });\r\n\r\n        it('should fail authorization on invalid credentials algorithm', function (done) {\r\n\r\n            credentialsFunc('123456', function (err, credentials1) {\r\n\r\n                var auth = Hawk.client.message('example.com', 8080, 'some message', { credentials: credentials1 });\r\n                expect(auth).to.exist();\r\n\r\n                var errFunc = function (id, callback) {\r\n\r\n                    callback(null, { key: '123', algorithm: '456' });\r\n                };\r\n\r\n                Hawk.server.authenticateMessage('example.com', 8080, 'some message', auth, errFunc, {}, function (err, credentials2) {\r\n\r\n                    expect(err).to.exist();\r\n                    expect(err.message).to.equal('Unknown algorithm');\r\n                    done();\r\n                });\r\n            });\r\n        });\r\n\r\n        it('should fail on missing host', function (done) {\r\n\r\n            credentialsFunc('123456', function (err, credentials1) {\r\n\r\n                var auth = Hawk.client.message(null, 8080, 'some message', { credentials: credentials1 });\r\n                expect(auth).to.not.exist();\r\n                done();\r\n            });\r\n        });\r\n\r\n        it('should fail on missing credentials', function (done) {\r\n\r\n            var auth = Hawk.client.message('example.com', 8080, 'some message', {});\r\n            expect(auth).to.not.exist();\r\n            done();\r\n        });\r\n\r\n        it('should fail on invalid algorithm', function (done) {\r\n\r\n            credentialsFunc('123456', function (err, credentials1) {\r\n\r\n                var creds = Hoek.clone(credentials1);\r\n                creds.algorithm = 'blah';\r\n                var auth = Hawk.client.message('example.com', 8080, 'some message', { credentials: creds });\r\n                expect(auth).to.not.exist();\r\n                done();\r\n            });\r\n        });\r\n    });\r\n});\r\n\r\n"]}