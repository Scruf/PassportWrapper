{"version":3,"sources":["usage.js"],"names":[],"mappings":";;AAEA,IAAI,OAAO,QAAQ,MAAR,CAAP;AACJ,IAAI,UAAU,QAAQ,SAAR,CAAV;AACJ,IAAI,OAAO,QAAQ,QAAR,CAAP;;;;AAKJ,IAAI,YAAY;AACZ,iBAAa;AACT,sBAAc;AACV,gBAAI,cAAJ;AACA,iBAAK,6CAAL;AACA,uBAAW,QAAX;AACA,kBAAM,OAAN;SAJJ;KADJ;CADA;;;;AAcJ,IAAI,kBAAkB,UAAU,EAAV,EAAc,QAAd,EAAwB;;AAE1C,WAAO,SAAS,IAAT,EAAe,UAAU,WAAV,CAAsB,EAAtB,CAAf,CAAP,CAF0C;CAAxB;;;;AAQtB,IAAI,UAAU,UAAU,GAAV,EAAe,GAAf,EAAoB;;AAE9B,SAAK,MAAL,CAAY,YAAZ,CAAyB,GAAzB,EAA8B,eAA9B,EAA+C,EAA/C,EAAmD,UAAU,GAAV,EAAe,WAAf,EAA4B,SAA5B,EAAuC;;AAEtF,YAAI,UAAW,CAAC,GAAD,GAAO,WAAW,YAAY,IAAZ,GAAmB,GAA9B,GAAoC,UAAU,GAAV,GAAgB,SAA3D,CAFuE;AAGtF,YAAI,UAAU;AACV,4BAAgB,YAAhB;AACA,oCAAwB,KAAK,MAAL,CAAY,MAAZ,CAAmB,WAAnB,EAAgC,SAAhC,EAA2C,EAAE,SAAS,OAAT,EAAkB,aAAa,YAAb,EAA/D,CAAxB;SAFA,CAHkF;;AAQtF,YAAI,SAAJ,CAAc,CAAC,GAAD,GAAO,GAAP,GAAa,GAAb,EAAkB,OAAhC,EARsF;AAStF,YAAI,GAAJ,CAAQ,OAAR,EATsF;KAAvC,CAAnD,CAF8B;CAApB;;AAed,KAAK,YAAL,CAAkB,OAAlB,EAA2B,MAA3B,CAAkC,IAAlC,EAAwC,WAAxC;;;;AAKA,QAAQ,0CAAR,EAAoD,UAAU,KAAV,EAAiB,QAAjB,EAA2B,IAA3B,EAAiC;;AAEjF,YAAQ,GAAR,CAAY,SAAS,UAAT,GAAsB,IAAtB,GAA6B,IAA7B,CAAZ,CAFiF;CAAjC,CAApD;;;;AAQA,gBAAgB,cAAhB,EAAgC,UAAU,GAAV,EAAe,WAAf,EAA4B;;AAExD,QAAI,SAAS,KAAK,MAAL,CAAY,MAAZ,CAAmB,0CAAnB,EAA+D,KAA/D,EAAsE,EAAE,aAAa,WAAb,EAA0B,KAAK,cAAL,EAAlG,CAAT,CAFoD;AAGxD,QAAI,UAAU;AACV,aAAK,0CAAL;AACA,gBAAQ,KAAR;AACA,iBAAS;AACL,2BAAe,OAAO,KAAP;SADnB;KAHA,CAHoD;;AAWxD,YAAQ,OAAR,EAAiB,UAAU,KAAV,EAAiB,QAAjB,EAA2B,IAA3B,EAAiC;;AAE9C,YAAI,UAAU,KAAK,MAAL,CAAY,YAAZ,CAAyB,QAAzB,EAAmC,WAAnC,EAAgD,OAAO,SAAP,EAAkB,EAAE,SAAS,IAAT,EAApE,CAAV,CAF0C;AAG9C,gBAAQ,GAAR,CAAY,SAAS,UAAT,GAAsB,IAAtB,GAA6B,IAA7B,IAAqC,UAAU,UAAV,GAAuB,YAAvB,CAArC,CAAZ,CAH8C;AAI9C,gBAAQ,IAAR,CAAa,CAAb,EAJ8C;KAAjC,CAAjB,CAXwD;CAA5B,CAAhC","file":"usage-compiled.js","sourcesContent":["// Load modules\r\n\r\nvar Http = require('http');\r\nvar Request = require('request');\r\nvar Hawk = require('../lib');\r\n\r\n\r\n// Declare internals\r\n\r\nvar internals = {\r\n    credentials: {\r\n        dh37fgj492je: {\r\n            id: 'dh37fgj492je',                                             // Required by Hawk.client.header\r\n            key: 'werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn',\r\n            algorithm: 'sha256',\r\n            user: 'Steve'\r\n        }\r\n    }\r\n};\r\n\r\n\r\n// Credentials lookup function\r\n\r\nvar credentialsFunc = function (id, callback) {\r\n\r\n    return callback(null, internals.credentials[id]);\r\n};\r\n\r\n\r\n// Create HTTP server\r\n\r\nvar handler = function (req, res) {\r\n\r\n    Hawk.server.authenticate(req, credentialsFunc, {}, function (err, credentials, artifacts) {\r\n\r\n        var payload = (!err ? 'Hello ' + credentials.user + ' ' + artifacts.ext : 'Shoosh!');\r\n        var headers = {\r\n            'Content-Type': 'text/plain',\r\n            'Server-Authorization': Hawk.server.header(credentials, artifacts, { payload: payload, contentType: 'text/plain' })\r\n        };\r\n\r\n        res.writeHead(!err ? 200 : 401, headers);\r\n        res.end(payload);\r\n    });\r\n};\r\n\r\nHttp.createServer(handler).listen(8000, '127.0.0.1');\r\n\r\n\r\n// Send unauthenticated request\r\n\r\nRequest('http://127.0.0.1:8000/resource/1?b=1&a=2', function (error, response, body) {\r\n\r\n    console.log(response.statusCode + ': ' + body);\r\n});\r\n\r\n\r\n// Send authenticated request\r\n\r\ncredentialsFunc('dh37fgj492je', function (err, credentials) {\r\n\r\n    var header = Hawk.client.header('http://127.0.0.1:8000/resource/1?b=1&a=2', 'GET', { credentials: credentials, ext: 'and welcome!' });\r\n    var options = {\r\n        uri: 'http://127.0.0.1:8000/resource/1?b=1&a=2',\r\n        method: 'GET',\r\n        headers: {\r\n            authorization: header.field\r\n        }\r\n    };\r\n\r\n    Request(options, function (error, response, body) {\r\n\r\n        var isValid = Hawk.client.authenticate(response, credentials, header.artifacts, { payload: body });\r\n        console.log(response.statusCode + ': ' + body + (isValid ? ' (valid)' : ' (invalid)'));\r\n        process.exit(0);\r\n    });\r\n});\r\n\r\n"]}