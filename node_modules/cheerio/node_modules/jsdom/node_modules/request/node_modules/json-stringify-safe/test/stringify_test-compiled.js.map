{"version":3,"sources":["stringify_test.js"],"names":[],"mappings":"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","file":"stringify_test-compiled.js","sourcesContent":["var Sinon = require(\"sinon\")\nvar stringify = require(\"..\")\nfunction jsonify(obj) { return JSON.stringify(obj, null, 2) }\n\ndescribe(\"Stringify\", function() {\n  it(\"must stringify circular objects\", function() {\n    var obj = {name: \"Alice\"}\n    obj.self = obj\n    var json = stringify(obj, null, 2)\n    json.must.eql(jsonify({name: \"Alice\", self: \"[Circular ~]\"}))\n  })\n\n  it(\"must stringify circular objects with intermediaries\", function() {\n    var obj = {name: \"Alice\"}\n    obj.identity = {self: obj}\n    var json = stringify(obj, null, 2)\n    json.must.eql(jsonify({name: \"Alice\", identity: {self: \"[Circular ~]\"}}))\n  })\n\n  it(\"must stringify circular objects deeper\", function() {\n    var obj = {name: \"Alice\", child: {name: \"Bob\"}}\n    obj.child.self = obj.child\n\n    stringify(obj, null, 2).must.eql(jsonify({\n      name: \"Alice\",\n      child: {name: \"Bob\", self: \"[Circular ~.child]\"}\n    }))\n  })\n\n  it(\"must stringify circular objects deeper with intermediaries\", function() {\n    var obj = {name: \"Alice\", child: {name: \"Bob\"}}\n    obj.child.identity = {self: obj.child}\n\n    stringify(obj, null, 2).must.eql(jsonify({\n      name: \"Alice\",\n      child: {name: \"Bob\", identity: {self: \"[Circular ~.child]\"}}\n    }))\n  })\n\n  it(\"must stringify circular objects in an array\", function() {\n    var obj = {name: \"Alice\"}\n    obj.self = [obj, obj]\n\n    stringify(obj, null, 2).must.eql(jsonify({\n      name: \"Alice\", self: [\"[Circular ~]\", \"[Circular ~]\"]\n    }))\n  })\n\n  it(\"must stringify circular objects deeper in an array\", function() {\n    var obj = {name: \"Alice\", children: [{name: \"Bob\"}, {name: \"Eve\"}]}\n    obj.children[0].self = obj.children[0]\n    obj.children[1].self = obj.children[1]\n\n    stringify(obj, null, 2).must.eql(jsonify({\n      name: \"Alice\",\n      children: [\n        {name: \"Bob\", self: \"[Circular ~.children.0]\"},\n        {name: \"Eve\", self: \"[Circular ~.children.1]\"}\n      ]\n    }))\n  })\n\n  it(\"must stringify circular arrays\", function() {\n    var obj = []\n    obj.push(obj)\n    obj.push(obj)\n    var json = stringify(obj, null, 2)\n    json.must.eql(jsonify([\"[Circular ~]\", \"[Circular ~]\"]))\n  })\n\n  it(\"must stringify circular arrays with intermediaries\", function() {\n    var obj = []\n    obj.push({name: \"Alice\", self: obj})\n    obj.push({name: \"Bob\", self: obj})\n\n    stringify(obj, null, 2).must.eql(jsonify([\n      {name: \"Alice\", self: \"[Circular ~]\"},\n      {name: \"Bob\", self: \"[Circular ~]\"}\n    ]))\n  })\n\n  it(\"must stringify repeated objects in objects\", function() {\n    var obj = {}\n    var alice = {name: \"Alice\"}\n    obj.alice1 = alice\n    obj.alice2 = alice\n\n    stringify(obj, null, 2).must.eql(jsonify({\n      alice1: {name: \"Alice\"},\n      alice2: {name: \"Alice\"}\n    }))\n  })\n\n  it(\"must stringify repeated objects in arrays\", function() {\n    var alice = {name: \"Alice\"}\n    var obj = [alice, alice]\n    var json = stringify(obj, null, 2)\n    json.must.eql(jsonify([{name: \"Alice\"}, {name: \"Alice\"}]))\n  })\n\n  it(\"must call given decycler and use its output\", function() {\n    var obj = {}\n    obj.a = obj\n    obj.b = obj\n\n    var decycle = Sinon.spy(function() { return decycle.callCount })\n    var json = stringify(obj, null, 2, decycle)\n    json.must.eql(jsonify({a: 1, b: 2}, null, 2))\n\n    decycle.callCount.must.equal(2)\n    decycle.thisValues[0].must.equal(obj)\n    decycle.args[0][0].must.equal(\"a\")\n    decycle.args[0][1].must.equal(obj)\n    decycle.thisValues[1].must.equal(obj)\n    decycle.args[1][0].must.equal(\"b\")\n    decycle.args[1][1].must.equal(obj)\n  })\n\n  it(\"must call replacer and use its output\", function() {\n    var obj = {name: \"Alice\", child: {name: \"Bob\"}}\n\n    var replacer = Sinon.spy(bangString)\n    var json = stringify(obj, replacer, 2)\n    json.must.eql(jsonify({name: \"Alice!\", child: {name: \"Bob!\"}}))\n\n    replacer.callCount.must.equal(4)\n    replacer.args[0][0].must.equal(\"\")\n    replacer.args[0][1].must.equal(obj)\n    replacer.thisValues[1].must.equal(obj)\n    replacer.args[1][0].must.equal(\"name\")\n    replacer.args[1][1].must.equal(\"Alice\")\n    replacer.thisValues[2].must.equal(obj)\n    replacer.args[2][0].must.equal(\"child\")\n    replacer.args[2][1].must.equal(obj.child)\n    replacer.thisValues[3].must.equal(obj.child)\n    replacer.args[3][0].must.equal(\"name\")\n    replacer.args[3][1].must.equal(\"Bob\")\n  })\n\n  it(\"must call replacer after describing circular references\", function() {\n    var obj = {name: \"Alice\"}\n    obj.self = obj\n\n    var replacer = Sinon.spy(bangString)\n    var json = stringify(obj, replacer, 2)\n    json.must.eql(jsonify({name: \"Alice!\", self: \"[Circular ~]!\"}))\n\n    replacer.callCount.must.equal(3)\n    replacer.args[0][0].must.equal(\"\")\n    replacer.args[0][1].must.equal(obj)\n    replacer.thisValues[1].must.equal(obj)\n    replacer.args[1][0].must.equal(\"name\")\n    replacer.args[1][1].must.equal(\"Alice\")\n    replacer.thisValues[2].must.equal(obj)\n    replacer.args[2][0].must.equal(\"self\")\n    replacer.args[2][1].must.equal(\"[Circular ~]\")\n  })\n\n  it(\"must call given decycler and use its output for nested objects\",\n    function() {\n    var obj = {}\n    obj.a = obj\n    obj.b = {self: obj}\n\n    var decycle = Sinon.spy(function() { return decycle.callCount })\n    var json = stringify(obj, null, 2, decycle)\n    json.must.eql(jsonify({a: 1, b: {self: 2}}))\n\n    decycle.callCount.must.equal(2)\n    decycle.args[0][0].must.equal(\"a\")\n    decycle.args[0][1].must.equal(obj)\n    decycle.args[1][0].must.equal(\"self\")\n    decycle.args[1][1].must.equal(obj)\n  })\n\n  it(\"must use decycler's output when it returned null\", function() {\n    var obj = {a: \"b\"}\n    obj.self = obj\n    obj.selves = [obj, obj]\n\n    function decycle() { return null }\n    stringify(obj, null, 2, decycle).must.eql(jsonify({\n      a: \"b\",\n      self: null,\n      selves: [null, null]\n    }))\n  })\n\n  it(\"must use decycler's output when it returned undefined\", function() {\n    var obj = {a: \"b\"}\n    obj.self = obj\n    obj.selves = [obj, obj]\n\n    function decycle() {}\n    stringify(obj, null, 2, decycle).must.eql(jsonify({\n      a: \"b\",\n      selves: [null, null]\n    }))\n  })\n\n  it(\"must throw given a decycler that returns a cycle\", function() {\n    var obj = {}\n    obj.self = obj\n    var err\n    function identity(key, value) { return value }\n    try { stringify(obj, null, 2, identity) } catch (ex) { err = ex }\n    err.must.be.an.instanceof(TypeError)\n  })\n\n  describe(\".getSerialize\", function() {\n    it(\"must stringify circular objects\", function() {\n      var obj = {a: \"b\"}\n      obj.circularRef = obj\n      obj.list = [obj, obj]\n\n      var json = JSON.stringify(obj, stringify.getSerialize(), 2)\n      json.must.eql(jsonify({\n        \"a\": \"b\",\n        \"circularRef\": \"[Circular ~]\",\n        \"list\": [\"[Circular ~]\", \"[Circular ~]\"]\n      }))\n    })\n\n    // This is the behavior as of Mar 3, 2015.\n    // The serializer function keeps state inside the returned function and\n    // so far I'm not sure how to not do that. JSON.stringify's replacer is not\n    // called _after_ serialization.\n    xit(\"must return a function that could be called twice\", function() {\n      var obj = {name: \"Alice\"}\n      obj.self = obj\n\n      var json\n      var serializer = stringify.getSerialize()\n\n      json = JSON.stringify(obj, serializer, 2)\n      json.must.eql(jsonify({name: \"Alice\", self: \"[Circular ~]\"}))\n\n      json = JSON.stringify(obj, serializer, 2)\n      json.must.eql(jsonify({name: \"Alice\", self: \"[Circular ~]\"}))\n    })\n  })\n})\n\nfunction bangString(key, value) {\n  return typeof value == \"string\" ? value + \"!\" : value\n}\n"]}