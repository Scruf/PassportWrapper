{"version":3,"sources":["request.js"],"names":[],"mappings":"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","file":"request-compiled.js","sourcesContent":["'use strict'\n\nvar http = require('http')\n  , https = require('https')\n  , url = require('url')\n  , util = require('util')\n  , stream = require('stream')\n  , zlib = require('zlib')\n  , bl = require('bl')\n  , hawk = require('hawk')\n  , aws2 = require('aws-sign2')\n  , httpSignature = require('http-signature')\n  , mime = require('mime-types')\n  , stringstream = require('stringstream')\n  , caseless = require('caseless')\n  , ForeverAgent = require('forever-agent')\n  , FormData = require('form-data')\n  , extend = require('extend')\n  , isstream = require('isstream')\n  , isTypedArray = require('is-typedarray').strict\n  , helpers = require('./lib/helpers')\n  , cookies = require('./lib/cookies')\n  , getProxyFromURI = require('./lib/getProxyFromURI')\n  , Querystring = require('./lib/querystring').Querystring\n  , Har = require('./lib/har').Har\n  , Auth = require('./lib/auth').Auth\n  , OAuth = require('./lib/oauth').OAuth\n  , Multipart = require('./lib/multipart').Multipart\n  , Redirect = require('./lib/redirect').Redirect\n  , Tunnel = require('./lib/tunnel').Tunnel\n\nvar safeStringify = helpers.safeStringify\n  , isReadStream = helpers.isReadStream\n  , toBase64 = helpers.toBase64\n  , defer = helpers.defer\n  , copy = helpers.copy\n  , version = helpers.version\n  , globalCookieJar = cookies.jar()\n\n\nvar globalPool = {}\n\nfunction filterForNonReserved(reserved, options) {\n  // Filter out properties that are not reserved.\n  // Reserved values are passed in at call site.\n\n  var object = {}\n  for (var i in options) {\n    var notReserved = (reserved.indexOf(i) === -1)\n    if (notReserved) {\n      object[i] = options[i]\n    }\n  }\n  return object\n}\n\nfunction filterOutReservedFunctions(reserved, options) {\n  // Filter out properties that are functions and are reserved.\n  // Reserved values are passed in at call site.\n\n  var object = {}\n  for (var i in options) {\n    var isReserved = !(reserved.indexOf(i) === -1)\n    var isFunction = (typeof options[i] === 'function')\n    if (!(isReserved && isFunction)) {\n      object[i] = options[i]\n    }\n  }\n  return object\n\n}\n\n// Function for properly handling a connection error\nfunction connectionErrorHandler(error) {\n  var socket = this\n  if (socket.res) {\n    if (socket.res.request) {\n      socket.res.request.emit('error', error)\n    } else {\n      socket.res.emit('error', error)\n    }\n  } else {\n    socket._httpMessage.emit('error', error)\n  }\n}\n\n// Return a simpler request object to allow serialization\nfunction requestToJSON() {\n  var self = this\n  return {\n    uri: self.uri,\n    method: self.method,\n    headers: self.headers\n  }\n}\n\n// Return a simpler response object to allow serialization\nfunction responseToJSON() {\n  var self = this\n  return {\n    statusCode: self.statusCode,\n    body: self.body,\n    headers: self.headers,\n    request: requestToJSON.call(self.request)\n  }\n}\n\nfunction Request (options) {\n  // if given the method property in options, set property explicitMethod to true\n\n  // extend the Request instance with any non-reserved properties\n  // remove any reserved functions from the options object\n  // set Request instance to be readable and writable\n  // call init\n\n  var self = this\n\n  // start with HAR, then override with additional options\n  if (options.har) {\n    self._har = new Har(self)\n    options = self._har.options(options)\n  }\n\n  stream.Stream.call(self)\n  var reserved = Object.keys(Request.prototype)\n  var nonReserved = filterForNonReserved(reserved, options)\n\n  extend(self, nonReserved)\n  options = filterOutReservedFunctions(reserved, options)\n\n  self.readable = true\n  self.writable = true\n  if (options.method) {\n    self.explicitMethod = true\n  }\n  self._qs = new Querystring(self)\n  self._auth = new Auth(self)\n  self._oauth = new OAuth(self)\n  self._multipart = new Multipart(self)\n  self._redirect = new Redirect(self)\n  self._tunnel = new Tunnel(self)\n  self.init(options)\n}\n\nutil.inherits(Request, stream.Stream)\n\n// Debugging\nRequest.debug = process.env.NODE_DEBUG && /\\brequest\\b/.test(process.env.NODE_DEBUG)\nfunction debug() {\n  if (Request.debug) {\n    console.error('REQUEST %s', util.format.apply(util, arguments))\n  }\n}\nRequest.prototype.debug = debug\n\nRequest.prototype.init = function (options) {\n  // init() contains all the code to setup the request object.\n  // the actual outgoing request is not started until start() is called\n  // this function is called from both the constructor and on redirect.\n  var self = this\n  if (!options) {\n    options = {}\n  }\n  self.headers = self.headers ? copy(self.headers) : {}\n\n  // Delete headers with value undefined since they break\n  // ClientRequest.OutgoingMessage.setHeader in node 0.12\n  for (var headerName in self.headers) {\n    if (typeof self.headers[headerName] === 'undefined') {\n      delete self.headers[headerName]\n    }\n  }\n\n  caseless.httpify(self, self.headers)\n\n  if (!self.method) {\n    self.method = options.method || 'GET'\n  }\n  if (!self.localAddress) {\n    self.localAddress = options.localAddress\n  }\n\n  self._qs.init(options)\n\n  debug(options)\n  if (!self.pool && self.pool !== false) {\n    self.pool = globalPool\n  }\n  self.dests = self.dests || []\n  self.__isRequestRequest = true\n\n  // Protect against double callback\n  if (!self._callback && self.callback) {\n    self._callback = self.callback\n    self.callback = function () {\n      if (self._callbackCalled) {\n        return // Print a warning maybe?\n      }\n      self._callbackCalled = true\n      self._callback.apply(self, arguments)\n    }\n    self.on('error', self.callback.bind())\n    self.on('complete', self.callback.bind(self, null))\n  }\n\n  // People use this property instead all the time, so support it\n  if (!self.uri && self.url) {\n    self.uri = self.url\n    delete self.url\n  }\n\n  // If there's a baseUrl, then use it as the base URL (i.e. uri must be\n  // specified as a relative path and is appended to baseUrl).\n  if (self.baseUrl) {\n    if (typeof self.baseUrl !== 'string') {\n      return self.emit('error', new Error('options.baseUrl must be a string'))\n    }\n\n    if (typeof self.uri !== 'string') {\n      return self.emit('error', new Error('options.uri must be a string when using options.baseUrl'))\n    }\n\n    if (self.uri.indexOf('//') === 0 || self.uri.indexOf('://') !== -1) {\n      return self.emit('error', new Error('options.uri must be a path when using options.baseUrl'))\n    }\n\n    // Handle all cases to make sure that there's only one slash between\n    // baseUrl and uri.\n    var baseUrlEndsWithSlash = self.baseUrl.lastIndexOf('/') === self.baseUrl.length - 1\n    var uriStartsWithSlash = self.uri.indexOf('/') === 0\n\n    if (baseUrlEndsWithSlash && uriStartsWithSlash) {\n      self.uri = self.baseUrl + self.uri.slice(1)\n    } else if (baseUrlEndsWithSlash || uriStartsWithSlash) {\n      self.uri = self.baseUrl + self.uri\n    } else if (self.uri === '') {\n      self.uri = self.baseUrl\n    } else {\n      self.uri = self.baseUrl + '/' + self.uri\n    }\n    delete self.baseUrl\n  }\n\n  // A URI is needed by this point, emit error if we haven't been able to get one\n  if (!self.uri) {\n    return self.emit('error', new Error('options.uri is a required argument'))\n  }\n\n  // If a string URI/URL was given, parse it into a URL object\n  if (typeof self.uri === 'string') {\n    self.uri = url.parse(self.uri)\n  }\n\n  // Some URL objects are not from a URL parsed string and need href added\n  if (!self.uri.href) {\n    self.uri.href = url.format(self.uri)\n  }\n\n  // DEPRECATED: Warning for users of the old Unix Sockets URL Scheme\n  if (self.uri.protocol === 'unix:') {\n    return self.emit('error', new Error('`unix://` URL scheme is no longer supported. Please use the format `http://unix:SOCKET:PATH`'))\n  }\n\n  // Support Unix Sockets\n  if (self.uri.host === 'unix') {\n    self.enableUnixSocket()\n  }\n\n  if (self.strictSSL === false) {\n    self.rejectUnauthorized = false\n  }\n\n  if (!self.uri.pathname) {self.uri.pathname = '/'}\n\n  if (!(self.uri.host || (self.uri.hostname && self.uri.port)) && !self.uri.isUnix) {\n    // Invalid URI: it may generate lot of bad errors, like 'TypeError: Cannot call method `indexOf` of undefined' in CookieJar\n    // Detect and reject it as soon as possible\n    var faultyUri = url.format(self.uri)\n    var message = 'Invalid URI \"' + faultyUri + '\"'\n    if (Object.keys(options).length === 0) {\n      // No option ? This can be the sign of a redirect\n      // As this is a case where the user cannot do anything (they didn't call request directly with this URL)\n      // they should be warned that it can be caused by a redirection (can save some hair)\n      message += '. This can be caused by a crappy redirection.'\n    }\n    // This error was fatal\n    self.abort()\n    return self.emit('error', new Error(message))\n  }\n\n  if (!self.hasOwnProperty('proxy')) {\n    self.proxy = getProxyFromURI(self.uri)\n  }\n\n  self.tunnel = self._tunnel.isEnabled()\n  if (self.proxy) {\n    self._tunnel.setup(options)\n  }\n\n  self._redirect.onRequest(options)\n\n  self.setHost = false\n  if (!self.hasHeader('host')) {\n    var hostHeaderName = self.originalHostHeaderName || 'host'\n    self.setHeader(hostHeaderName, self.uri.hostname)\n    if (self.uri.port) {\n      if ( !(self.uri.port === 80 && self.uri.protocol === 'http:') &&\n           !(self.uri.port === 443 && self.uri.protocol === 'https:') ) {\n        self.setHeader(hostHeaderName, self.getHeader('host') + (':' + self.uri.port) )\n      }\n    }\n    self.setHost = true\n  }\n\n  self.jar(self._jar || options.jar)\n\n  if (!self.uri.port) {\n    if (self.uri.protocol === 'http:') {self.uri.port = 80}\n    else if (self.uri.protocol === 'https:') {self.uri.port = 443}\n  }\n\n  if (self.proxy && !self.tunnel) {\n    self.port = self.proxy.port\n    self.host = self.proxy.hostname\n  } else {\n    self.port = self.uri.port\n    self.host = self.uri.hostname\n  }\n\n  if (options.form) {\n    self.form(options.form)\n  }\n\n  if (options.formData) {\n    var formData = options.formData\n    var requestForm = self.form()\n    var appendFormValue = function (key, value) {\n      if (value.hasOwnProperty('value') && value.hasOwnProperty('options')) {\n        requestForm.append(key, value.value, value.options)\n      } else {\n        requestForm.append(key, value)\n      }\n    }\n    for (var formKey in formData) {\n      if (formData.hasOwnProperty(formKey)) {\n        var formValue = formData[formKey]\n        if (formValue instanceof Array) {\n          for (var j = 0; j < formValue.length; j++) {\n            appendFormValue(formKey, formValue[j])\n          }\n        } else {\n          appendFormValue(formKey, formValue)\n        }\n      }\n    }\n  }\n\n  if (options.qs) {\n    self.qs(options.qs)\n  }\n\n  if (self.uri.path) {\n    self.path = self.uri.path\n  } else {\n    self.path = self.uri.pathname + (self.uri.search || '')\n  }\n\n  if (self.path.length === 0) {\n    self.path = '/'\n  }\n\n  // Auth must happen last in case signing is dependent on other headers\n  if (options.aws) {\n    self.aws(options.aws)\n  }\n\n  if (options.hawk) {\n    self.hawk(options.hawk)\n  }\n\n  if (options.httpSignature) {\n    self.httpSignature(options.httpSignature)\n  }\n\n  if (options.auth) {\n    if (Object.prototype.hasOwnProperty.call(options.auth, 'username')) {\n      options.auth.user = options.auth.username\n    }\n    if (Object.prototype.hasOwnProperty.call(options.auth, 'password')) {\n      options.auth.pass = options.auth.password\n    }\n\n    self.auth(\n      options.auth.user,\n      options.auth.pass,\n      options.auth.sendImmediately,\n      options.auth.bearer\n    )\n  }\n\n  if (self.gzip && !self.hasHeader('accept-encoding')) {\n    self.setHeader('accept-encoding', 'gzip')\n  }\n\n  if (self.uri.auth && !self.hasHeader('authorization')) {\n    var uriAuthPieces = self.uri.auth.split(':').map(function(item) {return self._qs.unescape(item)})\n    self.auth(uriAuthPieces[0], uriAuthPieces.slice(1).join(':'), true)\n  }\n\n  if (!self.tunnel && self.proxy && self.proxy.auth && !self.hasHeader('proxy-authorization')) {\n    var proxyAuthPieces = self.proxy.auth.split(':').map(function(item) {return self._qs.unescape(item)})\n    var authHeader = 'Basic ' + toBase64(proxyAuthPieces.join(':'))\n    self.setHeader('proxy-authorization', authHeader)\n  }\n\n  if (self.proxy && !self.tunnel) {\n    self.path = (self.uri.protocol + '//' + self.uri.host + self.path)\n  }\n\n  if (options.json) {\n    self.json(options.json)\n  }\n  if (options.multipart) {\n    self.multipart(options.multipart)\n  }\n\n  if (options.time) {\n    self.timing = true\n    self.elapsedTime = self.elapsedTime || 0\n  }\n\n  function setContentLength () {\n    if (isTypedArray(self.body)) {\n      self.body = new Buffer(self.body)\n    }\n\n    if (!self.hasHeader('content-length')) {\n      var length\n      if (typeof self.body === 'string') {\n        length = Buffer.byteLength(self.body)\n      }\n      else if (Array.isArray(self.body)) {\n        length = self.body.reduce(function (a, b) {return a + b.length}, 0)\n      }\n      else {\n        length = self.body.length\n      }\n\n      if (length) {\n        self.setHeader('content-length', length)\n      } else {\n        self.emit('error', new Error('Argument error, options.body.'))\n      }\n    }\n  }\n  if (self.body && !isstream(self.body)) {\n    setContentLength()\n  }\n\n  if (options.oauth) {\n    self.oauth(options.oauth)\n  } else if (self._oauth.params && self.hasHeader('authorization')) {\n    self.oauth(self._oauth.params)\n  }\n\n  var protocol = self.proxy && !self.tunnel ? self.proxy.protocol : self.uri.protocol\n    , defaultModules = {'http:':http, 'https:':https}\n    , httpModules = self.httpModules || {}\n\n  self.httpModule = httpModules[protocol] || defaultModules[protocol]\n\n  if (!self.httpModule) {\n    return self.emit('error', new Error('Invalid protocol: ' + protocol))\n  }\n\n  if (options.ca) {\n    self.ca = options.ca\n  }\n\n  if (!self.agent) {\n    if (options.agentOptions) {\n      self.agentOptions = options.agentOptions\n    }\n\n    if (options.agentClass) {\n      self.agentClass = options.agentClass\n    } else if (options.forever) {\n      var v = version()\n      // use ForeverAgent in node 0.10- only\n      if (v.major === 0 && v.minor <= 10) {\n        self.agentClass = protocol === 'http:' ? ForeverAgent : ForeverAgent.SSL\n      } else {\n        self.agentClass = self.httpModule.Agent\n        self.agentOptions = self.agentOptions || {}\n        self.agentOptions.keepAlive = true\n      }\n    } else {\n      self.agentClass = self.httpModule.Agent\n    }\n  }\n\n  if (self.pool === false) {\n    self.agent = false\n  } else {\n    self.agent = self.agent || self.getNewAgent()\n  }\n\n  self.on('pipe', function (src) {\n    if (self.ntick && self._started) {\n      self.emit('error', new Error('You cannot pipe to this stream after the outbound request has started.'))\n    }\n    self.src = src\n    if (isReadStream(src)) {\n      if (!self.hasHeader('content-type')) {\n        self.setHeader('content-type', mime.lookup(src.path))\n      }\n    } else {\n      if (src.headers) {\n        for (var i in src.headers) {\n          if (!self.hasHeader(i)) {\n            self.setHeader(i, src.headers[i])\n          }\n        }\n      }\n      if (self._json && !self.hasHeader('content-type')) {\n        self.setHeader('content-type', 'application/json')\n      }\n      if (src.method && !self.explicitMethod) {\n        self.method = src.method\n      }\n    }\n\n    // self.on('pipe', function () {\n    //   console.error('You have already piped to this stream. Pipeing twice is likely to break the request.')\n    // })\n  })\n\n  defer(function () {\n    if (self._aborted) {\n      return\n    }\n\n    var end = function () {\n      if (self._form) {\n        if (!self._auth.hasAuth) {\n          self._form.pipe(self)\n        }\n        else if (self._auth.hasAuth && self._auth.sentAuth) {\n          self._form.pipe(self)\n        }\n      }\n      if (self._multipart && self._multipart.chunked) {\n        self._multipart.body.pipe(self)\n      }\n      if (self.body) {\n        if (isstream(self.body)) {\n          self.body.pipe(self)\n        } else {\n          setContentLength()\n          if (Array.isArray(self.body)) {\n            self.body.forEach(function (part) {\n              self.write(part)\n            })\n          } else {\n            self.write(self.body)\n          }\n          self.end()\n        }\n      } else if (self.requestBodyStream) {\n        console.warn('options.requestBodyStream is deprecated, please pass the request object to stream.pipe.')\n        self.requestBodyStream.pipe(self)\n      } else if (!self.src) {\n        if (self._auth.hasAuth && !self._auth.sentAuth) {\n          self.end()\n          return\n        }\n        if (self.method !== 'GET' && typeof self.method !== 'undefined') {\n          self.setHeader('content-length', 0)\n        }\n        self.end()\n      }\n    }\n\n    if (self._form && !self.hasHeader('content-length')) {\n      // Before ending the request, we had to compute the length of the whole form, asyncly\n      self.setHeader(self._form.getHeaders(), true)\n      self._form.getLength(function (err, length) {\n        if (!err && !isNaN(length)) {\n          self.setHeader('content-length', length)\n        }\n        end()\n      })\n    } else {\n      end()\n    }\n\n    self.ntick = true\n  })\n\n}\n\nRequest.prototype.getNewAgent = function () {\n  var self = this\n  var Agent = self.agentClass\n  var options = {}\n  if (self.agentOptions) {\n    for (var i in self.agentOptions) {\n      options[i] = self.agentOptions[i]\n    }\n  }\n  if (self.ca) {\n    options.ca = self.ca\n  }\n  if (self.ciphers) {\n    options.ciphers = self.ciphers\n  }\n  if (self.secureProtocol) {\n    options.secureProtocol = self.secureProtocol\n  }\n  if (self.secureOptions) {\n    options.secureOptions = self.secureOptions\n  }\n  if (typeof self.rejectUnauthorized !== 'undefined') {\n    options.rejectUnauthorized = self.rejectUnauthorized\n  }\n\n  if (self.cert && self.key) {\n    options.key = self.key\n    options.cert = self.cert\n  }\n\n  if (self.pfx) {\n    options.pfx = self.pfx\n  }\n\n  if (self.passphrase) {\n    options.passphrase = self.passphrase\n  }\n\n  var poolKey = ''\n\n  // different types of agents are in different pools\n  if (Agent !== self.httpModule.Agent) {\n    poolKey += Agent.name\n  }\n\n  // ca option is only relevant if proxy or destination are https\n  var proxy = self.proxy\n  if (typeof proxy === 'string') {\n    proxy = url.parse(proxy)\n  }\n  var isHttps = (proxy && proxy.protocol === 'https:') || this.uri.protocol === 'https:'\n\n  if (isHttps) {\n    if (options.ca) {\n      if (poolKey) {\n        poolKey += ':'\n      }\n      poolKey += options.ca\n    }\n\n    if (typeof options.rejectUnauthorized !== 'undefined') {\n      if (poolKey) {\n        poolKey += ':'\n      }\n      poolKey += options.rejectUnauthorized\n    }\n\n    if (options.cert) {\n      if (poolKey) {\n        poolKey += ':'\n      }\n      poolKey += options.cert.toString('ascii') + options.key.toString('ascii')\n    }\n\n    if (options.pfx) {\n      if (poolKey) {\n        poolKey += ':'\n      }\n      poolKey += options.pfx.toString('ascii')\n    }\n\n    if (options.ciphers) {\n      if (poolKey) {\n        poolKey += ':'\n      }\n      poolKey += options.ciphers\n    }\n\n    if (options.secureProtocol) {\n      if (poolKey) {\n        poolKey += ':'\n      }\n      poolKey += options.secureProtocol\n    }\n\n    if (options.secureOptions) {\n      if (poolKey) {\n        poolKey += ':'\n      }\n      poolKey += options.secureOptions\n    }\n  }\n\n  if (self.pool === globalPool && !poolKey && Object.keys(options).length === 0 && self.httpModule.globalAgent) {\n    // not doing anything special.  Use the globalAgent\n    return self.httpModule.globalAgent\n  }\n\n  // we're using a stored agent.  Make sure it's protocol-specific\n  poolKey = self.uri.protocol + poolKey\n\n  // generate a new agent for this setting if none yet exists\n  if (!self.pool[poolKey]) {\n    self.pool[poolKey] = new Agent(options)\n    // properly set maxSockets on new agents\n    if (self.pool.maxSockets) {\n      self.pool[poolKey].maxSockets = self.pool.maxSockets\n    }\n  }\n\n  return self.pool[poolKey]\n}\n\nRequest.prototype.start = function () {\n  // start() is called once we are ready to send the outgoing HTTP request.\n  // this is usually called on the first write(), end() or on nextTick()\n  var self = this\n\n  if (self._aborted) {\n    return\n  }\n\n  self._started = true\n  self.method = self.method || 'GET'\n  self.href = self.uri.href\n\n  if (self.src && self.src.stat && self.src.stat.size && !self.hasHeader('content-length')) {\n    self.setHeader('content-length', self.src.stat.size)\n  }\n  if (self._aws) {\n    self.aws(self._aws, true)\n  }\n\n  // We have a method named auth, which is completely different from the http.request\n  // auth option.  If we don't remove it, we're gonna have a bad time.\n  var reqOptions = copy(self)\n  delete reqOptions.auth\n\n  debug('make request', self.uri.href)\n\n  try {\n    self.req = self.httpModule.request(reqOptions)\n  } catch (err) {\n    self.emit('error', err)\n    return\n  }\n\n  if (self.timing) {\n    self.startTime = new Date().getTime()\n  }\n\n  if (self.timeout && !self.timeoutTimer) {\n    var timeout = self.timeout < 0 ? 0 : self.timeout\n    // Set a timeout in memory - this block will throw if the server takes more\n    // than `timeout` to write the HTTP status and headers (corresponding to\n    // the on('response') event on the client). NB: this measures wall-clock\n    // time, not the time between bytes sent by the server.\n    self.timeoutTimer = setTimeout(function () {\n      var connectTimeout = self.req.socket && self.req.socket.readable === false\n      self.abort()\n      var e = new Error('ETIMEDOUT')\n      e.code = 'ETIMEDOUT'\n      e.connect = connectTimeout\n      self.emit('error', e)\n    }, timeout)\n\n    if (self.req.setTimeout) { // only works on node 0.6+\n      // Set an additional timeout on the socket, via the `setsockopt` syscall.\n      // This timeout sets the amount of time to wait *between* bytes sent\n      // from the server, and may or may not correspond to the wall-clock time\n      // elapsed from the start of the request.\n      //\n      // In particular, it's useful for erroring if the server fails to send\n      // data halfway through streaming a response.\n      self.req.setTimeout(timeout, function () {\n        if (self.req) {\n          self.req.abort()\n          var e = new Error('ESOCKETTIMEDOUT')\n          e.code = 'ESOCKETTIMEDOUT'\n          e.connect = false\n          self.emit('error', e)\n        }\n      })\n    }\n  }\n\n  self.req.on('response', self.onRequestResponse.bind(self))\n  self.req.on('error', self.onRequestError.bind(self))\n  self.req.on('drain', function() {\n    self.emit('drain')\n  })\n  self.req.on('socket', function(socket) {\n    self.emit('socket', socket)\n  })\n\n  self.on('end', function() {\n    if ( self.req.connection ) {\n      self.req.connection.removeListener('error', connectionErrorHandler)\n    }\n  })\n  self.emit('request', self.req)\n}\n\nRequest.prototype.onRequestError = function (error) {\n  var self = this\n  if (self._aborted) {\n    return\n  }\n  if (self.req && self.req._reusedSocket && error.code === 'ECONNRESET'\n      && self.agent.addRequestNoreuse) {\n    self.agent = { addRequest: self.agent.addRequestNoreuse.bind(self.agent) }\n    self.start()\n    self.req.end()\n    return\n  }\n  if (self.timeout && self.timeoutTimer) {\n    clearTimeout(self.timeoutTimer)\n    self.timeoutTimer = null\n  }\n  self.emit('error', error)\n}\n\nRequest.prototype.onRequestResponse = function (response) {\n  var self = this\n  debug('onRequestResponse', self.uri.href, response.statusCode, response.headers)\n  response.on('end', function() {\n    if (self.timing) {\n      self.elapsedTime += (new Date().getTime() - self.startTime)\n      debug('elapsed time', self.elapsedTime)\n      response.elapsedTime = self.elapsedTime\n    }\n    debug('response end', self.uri.href, response.statusCode, response.headers)\n  })\n\n  // The check on response.connection is a workaround for browserify.\n  if (response.connection && response.connection.listeners('error').indexOf(connectionErrorHandler) === -1) {\n    response.connection.setMaxListeners(0)\n    response.connection.once('error', connectionErrorHandler)\n  }\n  if (self._aborted) {\n    debug('aborted', self.uri.href)\n    response.resume()\n    return\n  }\n\n  self.response = response\n  response.request = self\n  response.toJSON = responseToJSON\n\n  // XXX This is different on 0.10, because SSL is strict by default\n  if (self.httpModule === https &&\n      self.strictSSL && (!response.hasOwnProperty('socket') ||\n      !response.socket.authorized)) {\n    debug('strict ssl error', self.uri.href)\n    var sslErr = response.hasOwnProperty('socket') ? response.socket.authorizationError : self.uri.href + ' does not support SSL'\n    self.emit('error', new Error('SSL Error: ' + sslErr))\n    return\n  }\n\n  // Save the original host before any redirect (if it changes, we need to\n  // remove any authorization headers).  Also remember the case of the header\n  // name because lots of broken servers expect Host instead of host and we\n  // want the caller to be able to specify this.\n  self.originalHost = self.getHeader('host')\n  if (!self.originalHostHeaderName) {\n    self.originalHostHeaderName = self.hasHeader('host')\n  }\n  if (self.setHost) {\n    self.removeHeader('host')\n  }\n  if (self.timeout && self.timeoutTimer) {\n    clearTimeout(self.timeoutTimer)\n    self.timeoutTimer = null\n  }\n\n  var targetCookieJar = (self._jar && self._jar.setCookie) ? self._jar : globalCookieJar\n  var addCookie = function (cookie) {\n    //set the cookie if it's domain in the href's domain.\n    try {\n      targetCookieJar.setCookie(cookie, self.uri.href, {ignoreError: true})\n    } catch (e) {\n      self.emit('error', e)\n    }\n  }\n\n  response.caseless = caseless(response.headers)\n\n  if (response.caseless.has('set-cookie') && (!self._disableCookies)) {\n    var headerName = response.caseless.has('set-cookie')\n    if (Array.isArray(response.headers[headerName])) {\n      response.headers[headerName].forEach(addCookie)\n    } else {\n      addCookie(response.headers[headerName])\n    }\n  }\n\n  if (self._redirect.onResponse(response)) {\n    return // Ignore the rest of the response\n  } else {\n    // Be a good stream and emit end when the response is finished.\n    // Hack to emit end on close because of a core bug that never fires end\n    response.on('close', function () {\n      if (!self._ended) {\n        self.response.emit('end')\n      }\n    })\n\n    response.on('end', function () {\n      self._ended = true\n    })\n\n    var responseContent\n    if (self.gzip) {\n      var contentEncoding = response.headers['content-encoding'] || 'identity'\n      contentEncoding = contentEncoding.trim().toLowerCase()\n\n      if (contentEncoding === 'gzip') {\n        responseContent = zlib.createGunzip()\n        response.pipe(responseContent)\n      } else {\n        // Since previous versions didn't check for Content-Encoding header,\n        // ignore any invalid values to preserve backwards-compatibility\n        if (contentEncoding !== 'identity') {\n          debug('ignoring unrecognized Content-Encoding ' + contentEncoding)\n        }\n        responseContent = response\n      }\n    } else {\n      responseContent = response\n    }\n\n    if (self.encoding) {\n      if (self.dests.length !== 0) {\n        console.error('Ignoring encoding parameter as this stream is being piped to another stream which makes the encoding option invalid.')\n      } else if (responseContent.setEncoding) {\n        responseContent.setEncoding(self.encoding)\n      } else {\n        // Should only occur on node pre-v0.9.4 (joyent/node@9b5abe5) with\n        // zlib streams.\n        // If/When support for 0.9.4 is dropped, this should be unnecessary.\n        responseContent = responseContent.pipe(stringstream(self.encoding))\n      }\n    }\n\n    if (self._paused) {\n      responseContent.pause()\n    }\n\n    self.responseContent = responseContent\n\n    self.emit('response', response)\n\n    self.dests.forEach(function (dest) {\n      self.pipeDest(dest)\n    })\n\n    responseContent.on('data', function (chunk) {\n      self._destdata = true\n      self.emit('data', chunk)\n    })\n    responseContent.on('end', function (chunk) {\n      self.emit('end', chunk)\n    })\n    responseContent.on('error', function (error) {\n      self.emit('error', error)\n    })\n    responseContent.on('close', function () {self.emit('close')})\n\n    if (self.callback) {\n      self.readResponseBody(response)\n    }\n    //if no callback\n    else {\n      self.on('end', function () {\n        if (self._aborted) {\n          debug('aborted', self.uri.href)\n          return\n        }\n        self.emit('complete', response)\n      })\n    }\n  }\n  debug('finish init function', self.uri.href)\n}\n\nRequest.prototype.readResponseBody = function (response) {\n  var self = this\n  debug('reading response\\'s body')\n  var buffer = bl()\n    , strings = []\n\n  self.on('data', function (chunk) {\n    if (Buffer.isBuffer(chunk)) {\n      buffer.append(chunk)\n    } else {\n      strings.push(chunk)\n    }\n  })\n  self.on('end', function () {\n    debug('end event', self.uri.href)\n    if (self._aborted) {\n      debug('aborted', self.uri.href)\n      return\n    }\n\n    if (buffer.length) {\n      debug('has body', self.uri.href, buffer.length)\n      if (self.encoding === null) {\n        // response.body = buffer\n        // can't move to this until https://github.com/rvagg/bl/issues/13\n        response.body = buffer.slice()\n      } else {\n        response.body = buffer.toString(self.encoding)\n      }\n    } else if (strings.length) {\n      // The UTF8 BOM [0xEF,0xBB,0xBF] is converted to [0xFE,0xFF] in the JS UTC16/UCS2 representation.\n      // Strip this value out when the encoding is set to 'utf8', as upstream consumers won't expect it and it breaks JSON.parse().\n      if (self.encoding === 'utf8' && strings[0].length > 0 && strings[0][0] === '\\uFEFF') {\n        strings[0] = strings[0].substring(1)\n      }\n      response.body = strings.join('')\n    }\n\n    if (self._json) {\n      try {\n        response.body = JSON.parse(response.body, self._jsonReviver)\n      } catch (e) {\n        debug('invalid JSON received', self.uri.href)\n      }\n    }\n    debug('emitting complete', self.uri.href)\n    if (typeof response.body === 'undefined' && !self._json) {\n      response.body = self.encoding === null ? new Buffer(0) : ''\n    }\n    self.emit('complete', response, response.body)\n  })\n}\n\nRequest.prototype.abort = function () {\n  var self = this\n  self._aborted = true\n\n  if (self.req) {\n    self.req.abort()\n  }\n  else if (self.response) {\n    self.response.destroy()\n  }\n\n  self.emit('abort')\n}\n\nRequest.prototype.pipeDest = function (dest) {\n  var self = this\n  var response = self.response\n  // Called after the response is received\n  if (dest.headers && !dest.headersSent) {\n    if (response.caseless.has('content-type')) {\n      var ctname = response.caseless.has('content-type')\n      if (dest.setHeader) {\n        dest.setHeader(ctname, response.headers[ctname])\n      }\n      else {\n        dest.headers[ctname] = response.headers[ctname]\n      }\n    }\n\n    if (response.caseless.has('content-length')) {\n      var clname = response.caseless.has('content-length')\n      if (dest.setHeader) {\n        dest.setHeader(clname, response.headers[clname])\n      } else {\n        dest.headers[clname] = response.headers[clname]\n      }\n    }\n  }\n  if (dest.setHeader && !dest.headersSent) {\n    for (var i in response.headers) {\n      // If the response content is being decoded, the Content-Encoding header\n      // of the response doesn't represent the piped content, so don't pass it.\n      if (!self.gzip || i !== 'content-encoding') {\n        dest.setHeader(i, response.headers[i])\n      }\n    }\n    dest.statusCode = response.statusCode\n  }\n  if (self.pipefilter) {\n    self.pipefilter(response, dest)\n  }\n}\n\nRequest.prototype.qs = function (q, clobber) {\n  var self = this\n  var base\n  if (!clobber && self.uri.query) {\n    base = self._qs.parse(self.uri.query)\n  } else {\n    base = {}\n  }\n\n  for (var i in q) {\n    base[i] = q[i]\n  }\n\n  var qs = self._qs.stringify(base)\n\n  if (qs === '') {\n    return self\n  }\n\n  self.uri = url.parse(self.uri.href.split('?')[0] + '?' + qs)\n  self.url = self.uri\n  self.path = self.uri.path\n\n  if (self.uri.host === 'unix') {\n    self.enableUnixSocket()\n  }\n\n  return self\n}\nRequest.prototype.form = function (form) {\n  var self = this\n  if (form) {\n    if (!/^application\\/x-www-form-urlencoded\\b/.test(self.getHeader('content-type'))) {\n      self.setHeader('content-type', 'application/x-www-form-urlencoded')\n    }\n    self.body = (typeof form === 'string')\n      ? self._qs.rfc3986(form.toString('utf8'))\n      : self._qs.stringify(form).toString('utf8')\n    return self\n  }\n  // create form-data object\n  self._form = new FormData()\n  self._form.on('error', function(err) {\n    err.message = 'form-data: ' + err.message\n    self.emit('error', err)\n    self.abort()\n  })\n  return self._form\n}\nRequest.prototype.multipart = function (multipart) {\n  var self = this\n\n  self._multipart.onRequest(multipart)\n\n  if (!self._multipart.chunked) {\n    self.body = self._multipart.body\n  }\n\n  return self\n}\nRequest.prototype.json = function (val) {\n  var self = this\n\n  if (!self.hasHeader('accept')) {\n    self.setHeader('accept', 'application/json')\n  }\n\n  if (typeof self.jsonReplacer === 'function') {\n    self._jsonReplacer = self.jsonReplacer\n  }\n\n  self._json = true\n  if (typeof val === 'boolean') {\n    if (self.body !== undefined) {\n      if (!/^application\\/x-www-form-urlencoded\\b/.test(self.getHeader('content-type'))) {\n        self.body = safeStringify(self.body, self._jsonReplacer)\n      } else {\n        self.body = self._qs.rfc3986(self.body)\n      }\n      if (!self.hasHeader('content-type')) {\n        self.setHeader('content-type', 'application/json')\n      }\n    }\n  } else {\n    self.body = safeStringify(val, self._jsonReplacer)\n    if (!self.hasHeader('content-type')) {\n      self.setHeader('content-type', 'application/json')\n    }\n  }\n\n  if (typeof self.jsonReviver === 'function') {\n    self._jsonReviver = self.jsonReviver\n  }\n\n  return self\n}\nRequest.prototype.getHeader = function (name, headers) {\n  var self = this\n  var result, re, match\n  if (!headers) {\n    headers = self.headers\n  }\n  Object.keys(headers).forEach(function (key) {\n    if (key.length !== name.length) {\n      return\n    }\n    re = new RegExp(name, 'i')\n    match = key.match(re)\n    if (match) {\n      result = headers[key]\n    }\n  })\n  return result\n}\nRequest.prototype.enableUnixSocket = function () {\n  // Get the socket & request paths from the URL\n  var unixParts = this.uri.path.split(':')\n    , host = unixParts[0]\n    , path = unixParts[1]\n  // Apply unix properties to request\n  this.socketPath = host\n  this.uri.pathname = path\n  this.uri.path = path\n  this.uri.host = host\n  this.uri.hostname = host\n  this.uri.isUnix = true\n}\n\n\nRequest.prototype.auth = function (user, pass, sendImmediately, bearer) {\n  var self = this\n\n  self._auth.onRequest(user, pass, sendImmediately, bearer)\n\n  return self\n}\nRequest.prototype.aws = function (opts, now) {\n  var self = this\n\n  if (!now) {\n    self._aws = opts\n    return self\n  }\n  \n  if (opts.sign_version == 4 || opts.sign_version == '4') {\n    var aws4 = require('aws4')\n    // use aws4  \n    var options = {\n      host: self.uri.host,\n      path: self.uri.path,\n      method: self.method,\n      headers: {\n        'content-type': self.getHeader('content-type') || ''\n      },\n      body: self.body\n    }\n    var signRes = aws4.sign(options, {\n      accessKeyId: opts.key,\n      secretAccessKey: opts.secret\n    })\n    self.setHeader('authorization', signRes.headers.Authorization)\n    self.setHeader('x-amz-date', signRes.headers['X-Amz-Date'])\n  }\n  else {\n    // default: use aws-sign2\n    var date = new Date()\n    self.setHeader('date', date.toUTCString())\n    var auth =\n      { key: opts.key\n      , secret: opts.secret\n      , verb: self.method.toUpperCase()\n      , date: date\n      , contentType: self.getHeader('content-type') || ''\n      , md5: self.getHeader('content-md5') || ''\n      , amazonHeaders: aws2.canonicalizeHeaders(self.headers)\n      }\n    var path = self.uri.path\n    if (opts.bucket && path) {\n      auth.resource = '/' + opts.bucket + path\n    } else if (opts.bucket && !path) {\n      auth.resource = '/' + opts.bucket\n    } else if (!opts.bucket && path) {\n      auth.resource = path\n    } else if (!opts.bucket && !path) {\n      auth.resource = '/'\n    }\n    auth.resource = aws2.canonicalizeResource(auth.resource)\n    self.setHeader('authorization', aws2.authorization(auth))\n  }\n\n  return self\n}\nRequest.prototype.httpSignature = function (opts) {\n  var self = this\n  httpSignature.signRequest({\n    getHeader: function(header) {\n      return self.getHeader(header, self.headers)\n    },\n    setHeader: function(header, value) {\n      self.setHeader(header, value)\n    },\n    method: self.method,\n    path: self.path\n  }, opts)\n  debug('httpSignature authorization', self.getHeader('authorization'))\n\n  return self\n}\nRequest.prototype.hawk = function (opts) {\n  var self = this\n  self.setHeader('Authorization', hawk.client.header(self.uri, self.method, opts).field)\n}\nRequest.prototype.oauth = function (_oauth) {\n  var self = this\n\n  self._oauth.onRequest(_oauth)\n\n  return self\n}\n\nRequest.prototype.jar = function (jar) {\n  var self = this\n  var cookies\n\n  if (self._redirect.redirectsFollowed === 0) {\n    self.originalCookieHeader = self.getHeader('cookie')\n  }\n\n  if (!jar) {\n    // disable cookies\n    cookies = false\n    self._disableCookies = true\n  } else {\n    var targetCookieJar = (jar && jar.getCookieString) ? jar : globalCookieJar\n    var urihref = self.uri.href\n    //fetch cookie in the Specified host\n    if (targetCookieJar) {\n      cookies = targetCookieJar.getCookieString(urihref)\n    }\n  }\n\n  //if need cookie and cookie is not empty\n  if (cookies && cookies.length) {\n    if (self.originalCookieHeader) {\n      // Don't overwrite existing Cookie header\n      self.setHeader('cookie', self.originalCookieHeader + '; ' + cookies)\n    } else {\n      self.setHeader('cookie', cookies)\n    }\n  }\n  self._jar = jar\n  return self\n}\n\n\n// Stream API\nRequest.prototype.pipe = function (dest, opts) {\n  var self = this\n\n  if (self.response) {\n    if (self._destdata) {\n      self.emit('error', new Error('You cannot pipe after data has been emitted from the response.'))\n    } else if (self._ended) {\n      self.emit('error', new Error('You cannot pipe after the response has been ended.'))\n    } else {\n      stream.Stream.prototype.pipe.call(self, dest, opts)\n      self.pipeDest(dest)\n      return dest\n    }\n  } else {\n    self.dests.push(dest)\n    stream.Stream.prototype.pipe.call(self, dest, opts)\n    return dest\n  }\n}\nRequest.prototype.write = function () {\n  var self = this\n  if (self._aborted) {return}\n\n  if (!self._started) {\n    self.start()\n  }\n  return self.req.write.apply(self.req, arguments)\n}\nRequest.prototype.end = function (chunk) {\n  var self = this\n  if (self._aborted) {return}\n\n  if (chunk) {\n    self.write(chunk)\n  }\n  if (!self._started) {\n    self.start()\n  }\n  if (self.req) {\n    self.req.end()\n  }\n}\nRequest.prototype.pause = function () {\n  var self = this\n  if (!self.responseContent) {\n    self._paused = true\n  } else {\n    self.responseContent.pause.apply(self.responseContent, arguments)\n  }\n}\nRequest.prototype.resume = function () {\n  var self = this\n  if (!self.responseContent) {\n    self._paused = false\n  } else {\n    self.responseContent.resume.apply(self.responseContent, arguments)\n  }\n}\nRequest.prototype.destroy = function () {\n  var self = this\n  if (!self._ended) {\n    self.end()\n  } else if (self.response) {\n    self.response.destroy()\n  }\n}\n\nRequest.defaultProxyHeaderWhiteList =\n  Tunnel.defaultProxyHeaderWhiteList.slice()\n\nRequest.defaultProxyHeaderExclusiveList =\n  Tunnel.defaultProxyHeaderExclusiveList.slice()\n\n// Exports\n\nRequest.prototype.toJSON = requestToJSON\nmodule.exports = Request\n"]}