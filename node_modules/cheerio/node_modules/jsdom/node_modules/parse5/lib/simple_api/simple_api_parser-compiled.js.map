{"version":3,"sources":["simple_api_parser.js"],"names":[],"mappings":"AAAA;;AAEA,IAAI,YAAY,QAAQ,2BAAR,CAAZ;IACA,iBAAiB,QAAQ,mBAAR,CAAjB;IACA,QAAQ,QAAQ,iBAAR,CAAR;;;AAGJ,IAAI,kBAAkB;AAClB,wBAAoB,IAApB;AACA,kBAAc,KAAd;CAFA;;;AAMJ,SAAS,IAAT,GAAgB;;;;;AAAhB,IAKI,kBAAkB,OAAO,OAAP,GAAiB,UAAU,QAAV,EAAoB,OAApB,EAA6B;AAChE,SAAK,OAAL,GAAe,MAAM,YAAN,CAAmB,eAAnB,EAAoC,OAApC,CAAf,CADgE;AAEhE,SAAK,QAAL,GAAgB;AACZ,iBAAS,KAAK,YAAL,CAAkB,SAAS,OAAT,CAA3B;AACA,kBAAU,KAAK,YAAL,CAAkB,SAAS,QAAT,CAA5B;AACA,gBAAQ,KAAK,YAAL,CAAkB,SAAS,MAAT,CAA1B;AACA,cAAM,KAAK,YAAL,CAAkB,SAAS,IAAT,CAAxB;AACA,iBAAS,KAAK,YAAL,CAAkB,SAAS,OAAT,CAA3B;KALJ,CAFgE;CAA7B;;AAWvC,gBAAgB,SAAhB,CAA0B,YAA1B,GAAyC,UAAU,OAAV,EAAmB;AACxD,QAAI,SAAS,IAAT,CADoD;;AAGxD,cAAU,WAAW,IAAX,CAH8C;;AAKxD,QAAI,KAAK,OAAL,CAAa,YAAb,EAA2B;AAC3B,eAAO,YAAY;AACf,gBAAI,OAAO,MAAM,SAAN,CAAgB,KAAhB,CAAsB,IAAtB,CAA2B,SAA3B,CAAP,CADW;AAEf,iBAAK,IAAL,CAAU,OAAO,oBAAP,CAAV,CAFe;AAGf,oBAAQ,KAAR,CAAc,OAAd,EAAuB,IAAvB,EAHe;SAAZ,CADoB;KAA/B;;AAQA,WAAO,OAAP,CAbwD;CAAnB;;;AAiBzC,gBAAgB,SAAhB,CAA0B,KAA1B,GAAkC,UAAU,IAAV,EAAgB;AAC9C,QAAI,QAAQ,IAAR,CAD0C;;AAG9C,SAAK,MAAL,CAAY,IAAZ,EAH8C;;AAK9C,OAAG;AACC,gBAAQ,KAAK,cAAL,CAAoB,YAApB,EAAR,CADD;;AAGC,YAAI,MAAM,IAAN,KAAe,UAAU,eAAV,IACf,MAAM,IAAN,KAAe,UAAU,0BAAV,IACf,MAAM,IAAN,KAAe,UAAU,oBAAV,EAAgC;;AAE/C,gBAAI,KAAK,OAAL,CAAa,YAAb,EAA2B;AAC3B,oBAAI,KAAK,WAAL,KAAqB,IAArB,EACA,KAAK,oBAAL,GAA4B,MAAM,QAAN,CADhC,KAII,KAAK,oBAAL,CAA0B,GAA1B,GAAgC,MAAM,QAAN,CAAe,GAAf,CAJpC;aADJ;;AAQA,iBAAK,WAAL,GAAmB,CAAC,KAAK,WAAL,IAAoB,EAApB,CAAD,GAA2B,MAAM,KAAN,CAVC;SAFnD,MAeK;AACD,iBAAK,gBAAL,GADC;AAED,iBAAK,YAAL,CAAkB,KAAlB,EAFC;SAfL;KAHJ,QAsBS,MAAM,IAAN,KAAe,UAAU,SAAV,EA3BsB;CAAhB;;;AA+BlC,gBAAgB,SAAhB,CAA0B,YAA1B,GAAyC,UAAU,KAAV,EAAiB;AACtD,QAAI,KAAK,OAAL,CAAa,YAAb,EACA,KAAK,oBAAL,GAA4B,MAAM,QAAN,CADhC;;AAGA,QAAI,MAAM,IAAN,KAAe,UAAU,eAAV,EACf,KAAK,QAAL,CAAc,QAAd,CAAuB,MAAM,OAAN,EAAe,MAAM,KAAN,EAAa,MAAM,WAAN,CAAnD,CADJ,KAGK,IAAI,MAAM,IAAN,KAAe,UAAU,aAAV,EACpB,KAAK,QAAL,CAAc,MAAd,CAAqB,MAAM,OAAN,CAArB,CADC,KAGA,IAAI,MAAM,IAAN,KAAe,UAAU,aAAV,EACpB,KAAK,QAAL,CAAc,OAAd,CAAsB,MAAM,IAAN,CAAtB,CADC,KAGA,IAAI,MAAM,IAAN,KAAe,UAAU,aAAV,EACpB,KAAK,QAAL,CAAc,OAAd,CAAsB,MAAM,IAAN,EAAY,MAAM,QAAN,EAAgB,MAAM,QAAN,CAAlD,CADC;CAbgC;;AAkBzC,gBAAgB,SAAhB,CAA0B,MAA1B,GAAmC,UAAU,IAAV,EAAgB;AAC/C,SAAK,cAAL,GAAsB,IAAI,cAAJ,CAAmB,IAAnB,EAAyB,KAAK,OAAL,CAA/C,CAD+C;AAE/C,SAAK,WAAL,GAAmB,IAAnB,CAF+C;AAG/C,SAAK,oBAAL,GAA4B,IAA5B,CAH+C;CAAhB;;AAMnC,gBAAgB,SAAhB,CAA0B,gBAA1B,GAA6C,YAAY;AACrD,QAAI,KAAK,WAAL,KAAqB,IAArB,EAA2B;AAC3B,aAAK,QAAL,CAAc,IAAd,CAAmB,KAAK,WAAL,CAAnB,CAD2B;AAE3B,aAAK,WAAL,GAAmB,IAAnB,CAF2B;KAA/B;CADyC","file":"simple_api_parser-compiled.js","sourcesContent":["'use strict';\r\n\r\nvar Tokenizer = require('../tokenization/tokenizer'),\r\n    TokenizerProxy = require('./tokenizer_proxy'),\r\n    Utils = require('../common/utils');\r\n\r\n//Default options\r\nvar DEFAULT_OPTIONS = {\r\n    decodeHtmlEntities: true,\r\n    locationInfo: false\r\n};\r\n\r\n//Skipping handler\r\nfunction skip() {\r\n    //NOTE: do nothing =)\r\n}\r\n\r\n//SimpleApiParser\r\nvar SimpleApiParser = module.exports = function (handlers, options) {\r\n    this.options = Utils.mergeOptions(DEFAULT_OPTIONS, options);\r\n    this.handlers = {\r\n        doctype: this._wrapHandler(handlers.doctype),\r\n        startTag: this._wrapHandler(handlers.startTag),\r\n        endTag: this._wrapHandler(handlers.endTag),\r\n        text: this._wrapHandler(handlers.text),\r\n        comment: this._wrapHandler(handlers.comment)\r\n    };\r\n};\r\n\r\nSimpleApiParser.prototype._wrapHandler = function (handler) {\r\n    var parser = this;\r\n\r\n    handler = handler || skip;\r\n\r\n    if (this.options.locationInfo) {\r\n        return function () {\r\n            var args = Array.prototype.slice.call(arguments);\r\n            args.push(parser.currentTokenLocation);\r\n            handler.apply(handler, args);\r\n        };\r\n    }\r\n\r\n    return handler;\r\n};\r\n\r\n//API\r\nSimpleApiParser.prototype.parse = function (html) {\r\n    var token = null;\r\n\r\n    this._reset(html);\r\n\r\n    do {\r\n        token = this.tokenizerProxy.getNextToken();\r\n\r\n        if (token.type === Tokenizer.CHARACTER_TOKEN ||\r\n            token.type === Tokenizer.WHITESPACE_CHARACTER_TOKEN ||\r\n            token.type === Tokenizer.NULL_CHARACTER_TOKEN) {\r\n\r\n            if (this.options.locationInfo) {\r\n                if (this.pendingText === null)\r\n                    this.currentTokenLocation = token.location;\r\n\r\n                else\r\n                    this.currentTokenLocation.end = token.location.end;\r\n            }\r\n\r\n            this.pendingText = (this.pendingText || '') + token.chars;\r\n        }\r\n\r\n        else {\r\n            this._emitPendingText();\r\n            this._handleToken(token);\r\n        }\r\n    } while (token.type !== Tokenizer.EOF_TOKEN);\r\n};\r\n\r\n//Internals\r\nSimpleApiParser.prototype._handleToken = function (token) {\r\n    if (this.options.locationInfo)\r\n        this.currentTokenLocation = token.location;\r\n\r\n    if (token.type === Tokenizer.START_TAG_TOKEN)\r\n        this.handlers.startTag(token.tagName, token.attrs, token.selfClosing);\r\n\r\n    else if (token.type === Tokenizer.END_TAG_TOKEN)\r\n        this.handlers.endTag(token.tagName);\r\n\r\n    else if (token.type === Tokenizer.COMMENT_TOKEN)\r\n        this.handlers.comment(token.data);\r\n\r\n    else if (token.type === Tokenizer.DOCTYPE_TOKEN)\r\n        this.handlers.doctype(token.name, token.publicId, token.systemId);\r\n\r\n};\r\n\r\nSimpleApiParser.prototype._reset = function (html) {\r\n    this.tokenizerProxy = new TokenizerProxy(html, this.options);\r\n    this.pendingText = null;\r\n    this.currentTokenLocation = null;\r\n};\r\n\r\nSimpleApiParser.prototype._emitPendingText = function () {\r\n    if (this.pendingText !== null) {\r\n        this.handlers.text(this.pendingText);\r\n        this.pendingText = null;\r\n    }\r\n};\r\n"]}